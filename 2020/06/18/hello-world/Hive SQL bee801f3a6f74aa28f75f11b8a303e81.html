<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>æŠ€èƒ½-Hive-SQLå­¦ä¹ </title><style>
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, YuMincho, "Yu Mincho", "Hiragino Mincho ProN", "Hiragino Mincho Pro", "Songti TC", "Songti SC", "SimSun", "Nanum Myeongjo", NanumMyeongjo, Batang, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC', 'Noto Sans CJK KR'; }

.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC', 'Noto Sans Mono CJK KR'; }

.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, YuMincho, "Yu Mincho", "Hiragino Mincho ProN", "Hiragino Mincho Pro", "Songti TC", "Songti SC", "SimSun", "Nanum Myeongjo", NanumMyeongjo, Batang, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC', 'Noto Sans CJK KR'; }

.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC', 'Noto Sans Mono CJK KR'; }

.highlight-default {
}
.highlight-gray {
	color: rgb(155,154,151);
}
.highlight-brown {
	color: rgb(100,71,58);
}
.highlight-orange {
	color: rgb(217,115,13);
}
.highlight-yellow {
	color: rgb(223,171,1);
}
.highlight-teal {
	color: rgb(15,123,108);
}
.highlight-blue {
	color: rgb(11,110,153);
}
.highlight-purple {
	color: rgb(105,64,165);
}
.highlight-pink {
	color: rgb(173,26,114);
}
.highlight-red {
	color: rgb(224,62,62);
}
.highlight-gray_background {
	background: rgb(235,236,237);
}
.highlight-brown_background {
	background: rgb(233,229,227);
}
.highlight-orange_background {
	background: rgb(250,235,221);
}
.highlight-yellow_background {
	background: rgb(251,243,219);
}
.highlight-teal_background {
	background: rgb(221,237,234);
}
.highlight-blue_background {
	background: rgb(221,235,241);
}
.highlight-purple_background {
	background: rgb(234,228,242);
}
.highlight-pink_background {
	background: rgb(244,223,235);
}
.highlight-red_background {
	background: rgb(251,228,228);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(55, 53, 47, 0.6);
	fill: rgba(55, 53, 47, 0.6);
}
.block-color-brown {
	color: rgb(100,71,58);
	fill: rgb(100,71,58);
}
.block-color-orange {
	color: rgb(217,115,13);
	fill: rgb(217,115,13);
}
.block-color-yellow {
	color: rgb(223,171,1);
	fill: rgb(223,171,1);
}
.block-color-teal {
	color: rgb(15,123,108);
	fill: rgb(15,123,108);
}
.block-color-blue {
	color: rgb(11,110,153);
	fill: rgb(11,110,153);
}
.block-color-purple {
	color: rgb(105,64,165);
	fill: rgb(105,64,165);
}
.block-color-pink {
	color: rgb(173,26,114);
	fill: rgb(173,26,114);
}
.block-color-red {
	color: rgb(224,62,62);
	fill: rgb(224,62,62);
}
.block-color-gray_background {
	background: rgb(235,236,237);
}
.block-color-brown_background {
	background: rgb(233,229,227);
}
.block-color-orange_background {
	background: rgb(250,235,221);
}
.block-color-yellow_background {
	background: rgb(251,243,219);
}
.block-color-teal_background {
	background: rgb(221,237,234);
}
.block-color-blue_background {
	background: rgb(221,235,241);
}
.block-color-purple_background {
	background: rgb(234,228,242);
}
.block-color-pink_background {
	background: rgb(244,223,235);
}
.block-color-red_background {
	background: rgb(251,228,228);
}
.select-value-color-default { background-color: rgba(206,205,202,0.5); }
.select-value-color-gray { background-color: rgba(155,154,151, 0.4); }
.select-value-color-brown { background-color: rgba(140,46,0,0.2); }
.select-value-color-orange { background-color: rgba(245,93,0,0.2); }
.select-value-color-yellow { background-color: rgba(233,168,0,0.2); }
.select-value-color-green { background-color: rgba(0,135,107,0.2); }
.select-value-color-blue { background-color: rgba(0,120,223,0.2); }
.select-value-color-purple { background-color: rgba(103,36,222,0.2); }
.select-value-color-pink { background-color: rgba(221,0,129,0.2); }
.select-value-color-red { background-color: rgba(255,0,26,0.2); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="bee801f3-a6f7-4aa2-8f75-f11b8a303e81" class="page sans"><header><img class="page-cover-image" src="https://www.notion.so/images/page-cover/nasa_robert_stewart_spacewalk.jpg" style="object-position:center 40%"/><div class="page-header-icon page-header-icon-with-cover"><span class="icon">ğŸš”</span></div><h1 class="page-title">æŠ€èƒ½-Hive-SQLå­¦ä¹ </h1></header><div class="page-body"><hr id="6890206c-3f4c-43c1-bcd2-24ace1a263a3"/><nav id="121eaaea-1544-49c4-b83a-2f150e6f5ccf" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#92f6eaeb-3f63-4d44-b07c-5c4c842c7076">æ•°æ®åº“ä¸è¡¨çš„å¢åˆ æ”¹æŸ¥</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#a464cd1c-622b-447e-af8c-446828bdc9f1">æ•°æ®åº“</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#e98cb203-1003-4cb0-9afe-5d58f74a4d70">æ•°æ®è¡¨</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#1536a52c-95b9-4511-826d-c762dec6991f">å†…éƒ¨è¡¨ä¸å¤–éƒ¨è¡¨</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#a2052d88-609a-4d4c-8159-9cbd1525692c">æŸ¥è¯¢</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#e1e6641e-e2ce-4df2-9d01-fbbba46944ce">selectâ€¦fromâ€¦</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#37fae364-5e1e-4432-b02a-62e12f4dd9bb">where</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#ef232d11-7476-4d3e-b9a2-112fa2afa49a">group by</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#4c297223-504e-4ca6-95ab-e7ca8cdf7339">order by</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#e9386510-cb0a-49b0-805a-14274ee0b74e">having</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#7508cc22-3f69-46dc-bd08-d24c5c1e8ef9">limit</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#d6adb8da-1975-4408-8674-c83ddac0b606">è¡¨è¿æ¥</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#fdb238a9-84eb-47dc-99af-d2df364e59d3">join</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#07195066-4d63-4705-b6a5-260c0bceedd0">å¹¶é›†ï¼šunion ä¸ union all</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#54c1d2d7-b674-4764-b5e2-80efa866a85a">äº¤é›†ï¼šintersect</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#12d87990-b103-4a49-b8c2-c8f636209383">å·®é›†ï¼šexcept</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#d97d432d-b624-4438-bf4d-07af78a232c6">å‡½æ•°</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#a0966b51-e48c-4f4f-b4cf-6efb4d8cc433">èšåˆå‡½æ•°</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#56e5520e-c1d9-4d32-a21a-784d9f1ec5be">æ—¶é—´å‡½æ•°</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#104d687d-2f9b-46a8-ae0c-ec71d176b804">æ±‚ç•™å­˜ç‡</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#7d22de64-7e41-4d4a-ac4a-26c7cba12e1c">æ¡ä»¶åˆ¤æ–­ï¼šcase when ä¸ if</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#1e49c007-b722-4f18-8298-bb9a733424b4">è¡Œè½¬åˆ—</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#e52758ec-8c02-407b-8800-43837eb05950">åˆ—è½¬è¡Œ</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#57c4be99-d24a-4a0e-907b-b8968b2130a6">çª—å£å‡½æ•°</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#375a2cb2-2343-43f0-ade3-529e35b5dd98">æ’åºå‡½æ•°</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#c046dcfb-82c8-40f5-b593-d68f0e64bead">å­—ç¬¦ä¸²å‡½æ•°</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b39356e-249a-44f4-86b0-b7e1f859a9f9">group by ä¸­rollupã€cubeã€groupingã€grouping setsç”¨æ³•</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#553e769d-1dc4-45fa-bc27-ff3523ea45b1">ç©ºå­—æ®µèµ‹å€¼</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#8e9ed89b-da9e-4e2e-be9d-2b5d699eac1f">æŸ¥çœ‹ç³»ç»Ÿå†…ç½®å‡½æ•°</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#e276543e-1062-41da-8791-4f4bc72086e1">Hiveé¿å…æ•°æ®å€¾æ–œ</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#621b9f37-312f-4ac2-b5c6-779278515d32">å°è¡¨Joinå¤§è¡¨</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#68a1a493-050e-4f39-bfaf-8d98795cb18c">å¤§è¡¨JOINå¤§è¡¨</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#f7ae9a9d-27b8-4119-9249-f3cbcf9ea95d">count(distinct) å»é‡ç»Ÿè®¡</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#428d1e0d-0931-4b52-831f-19807a46ce84">é¿å…ç¬›å¡å°”ç§¯</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#c6e0d374-cd18-4028-a565-83011b85cc0f">è¡Œåˆ—è¿‡æ»¤</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#8c565b4b-37c1-41a3-af8b-1f09b6aa384a">union all å­æŸ¥è¯¢é¿å…ä¸­ä½¿ç”¨ group byç­‰</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#fb8fc68d-530f-404b-a2d8-7bb477037945">é¿å…ä¸åŒæ•°æ®ç±»å‹è¿›è¡Œå…³è”</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#c22a35cb-e324-4d9a-92c8-ba249472d666">ç”¨pythonè„šæœ¬è¿æ¥æ•°æ®åº“</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#0a7454f4-0cec-40fc-bcf1-52b863276095">å‚è€ƒèµ„æ–™ï¼š</a></div></nav><h1 id="92f6eaeb-3f63-4d44-b07c-5c4c842c7076" class="">æ•°æ®åº“ä¸è¡¨çš„å¢åˆ æ”¹æŸ¥</h1><h2 id="a464cd1c-622b-447e-af8c-446828bdc9f1" class="">æ•°æ®åº“</h2><ul id="51ae7916-fb4d-4a88-8267-ce21214b9b47" class="bulleted-list"><li>create database-åˆ›å»ºæ–°æ•°æ®åº“</li></ul><pre id="51adfdfe-df0e-4dff-8373-32664bf6f979" class="code"><code>--åˆ›å»ºzhangæ•°æ®åº“
create database zhang

 --åˆ¶å®šæ•°æ®åº“çš„ä½ç½®
create database  if not exists zhang location &#x27;/zhang.db&#x27;</code></pre><ul id="ba6948ad-836a-4a38-8fb2-1430a4bd0999" class="bulleted-list"><li>alter database-ä¿®æ”¹æ•°æ®åº“</li></ul><pre id="346cc396-d4d8-403f-8923-62fd07775df8" class="code"><code>---å¢åŠ æ•°æ®åº“å±æ€§
alter database zhang set dbproperties(&quot;CTtime&quot;= &quot;2020-05-01&quot;)</code></pre><ul id="0af01480-4efa-4d59-b550-2cfba9a1c06e" class="bulleted-list"><li>drop database -åˆ é™¤æ•°æ®åº“</li></ul><pre id="9748f6de-5c18-478d-b43e-1cee1852eec1" class="code"><code>---æ•°æ®åº“ä¸‹æ— è¡¨
drop database zhang;

---æ•°æ®åº“ä¸‹æœ‰è¡¨ï¼Œ-å¼ºåˆ¶åˆ é™¤
drop database zhang cascade;</code></pre><ul id="38c77ecb-fea0-4210-8a0c-5f9fb5a767c7" class="bulleted-list"><li>é€‰æ‹©æ•°æ®åº“</li></ul><pre id="1595571b-c7fe-4cd5-8fbb-87dc8f89c91f" class="code"><code>use android;</code></pre><ul id="1857d989-7285-4fed-ae63-49f79c208248" class="bulleted-list"><li>é‡ç½®é»˜è®¤æ•°æ®åº“</li></ul><pre id="67962b51-4dcc-43ee-a003-eecfd3c6c91c" class="code"><code>use default android;</code></pre><ul id="a5755689-881d-46db-a65e-28def3ed6631" class="bulleted-list"><li>æŸ¥çœ‹æ‰€åœ¨çš„æ•°æ®åº“</li></ul><pre id="c6879880-fcfe-4cae-8ccb-aac8af8b8253" class="code"><code>show databases;

--æ¨¡ç³ŠæŸ¥è¯¢
show databases like &quot;s%&quot;

--- æŸ¥è¯¢æ•°æ®åº“ä¿¡æ¯
desc database  zhang;
7
---æŸ¥è¯¢æ•°æ®åº“æ‰©å±•å±æ€§
desc database extended zhang;</code></pre><h2 id="e98cb203-1003-4cb0-9afe-5d58f74a4d70" class="">æ•°æ®è¡¨</h2><ul id="c1d50e2e-fca6-412a-b1cd-8adc728c72ac" class="bulleted-list"><li>create table-åˆ›å»ºæ–°è¡¨</li></ul><pre id="fa4f86a4-2a3d-4155-9258-fbeb0786ac4b" class="code"><code>create [external] table [if not exists] table_name [(col_name data_type [comment col_comment],....)][partitioned by (col_name data_type [comment col_comment],..)][clustered by (col_name, col_name, ...)][row format row_format][stored as file_format][location hdfs_path]

--- create table åˆ›å»ºæŒ‡å®šåç§°çš„è¡¨ï¼Œå¦‚æœç›¸åŒåç§°çš„è¡¨å·²å­˜åœ¨ï¼Œåˆ™ç”¨if not exists é€‰é¡¹æ¥å¿½ç•¥è¿™ä¸ªå¼‚å¸¸ã€‚--extername å…³é”®å­—è®©ç”¨æˆ·åˆ›å»ºä¸€ä¸ªå¤–éƒ¨è¡¨---partitioned by  åˆ†åŒºï¼šåˆ†ç›®å½•ï¼ŒæŠŠä¸€ä¸ªå¤§çš„æ•°æ®é›†æ ¹æ®ä¸šåŠ¡éœ€è¦åˆ†å‰²æˆå°çš„æ•°æ®é›†ã€‚åœ¨æŸ¥è¯¢æ—¶é€šè¿‡whereå­å¥çš„è¡¨è¾¾å¼æ¥é€‰æ‹©æŸ¥è¯¢æ‰€éœ€çš„æŒ‡å®šåˆ†åŒºï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚
--clustered by åˆ†æ¡¶--row format  å­—æ®µä¹‹é—´çš„åˆ†éš”ç¬¦---stored as æ–‡ä»¶å­˜å‚¨æ ¼å¼--locationï¼Œ æŒ‡å®šè¡¨åœ¨HDFSä¸Šçš„å­˜å‚¨ä½ç½®---åœ¨zhangåº“ä¸­åˆ›å»ºtestè¡¨create external table dept(    deptid int,     dname string,     loc int) row format delimited fields terminated by &#x27;\t&#x27;</code></pre><ul id="e12976e3-01cc-4252-a5c9-e934c6b8a4c4" class="bulleted-list"><li>update-æ›´æ–°æ•°æ®åº“ä¸­çš„æ•°æ®</li></ul><pre id="e1de8209-1794-470d-b61a-8ba83d8e75e8" class="code"><code>update è¡¨åset  éœ€æ›´æ–°çš„åˆ—å1= æ–°å€¼1, éœ€æ›´æ–°çš„åˆ—å2=æ–°å€¼2,...where  åˆ—å = æŸä¸ªåŸæœ‰çš„å€¼

UPDATE Websites SET alexa=&#x27;5000&#x27;, country=&#x27;USA&#x27;

 --æ›´æ–°çš„æ•°æ®WHERE name=&#x27;èœé¸Ÿæ•™ç¨‹&#x27;;</code></pre><ul id="16d07072-b9f7-41e3-9fec-c6059c5cf151" class="bulleted-list"><li>insert into() -å‘æ•°æ®åº“ä¸­æ’å…¥æ–°æ•°æ®</li></ul><pre id="2f506fbe-d683-4bec-b8a2-3c2a36003bde" class="code"><code>insert into è¡¨åï¼ˆåˆ—å1,åˆ—å2,åˆ—å3...)values(å€¼1, å€¼2, å€¼3...)</code></pre><ul id="bf472ada-0c6d-4275-8b34-d7974f608dbe" class="bulleted-list"><li>delete-ä»æ•°æ®åº“ä¸­åˆ é™¤æ•°æ®</li></ul><pre id="6e8a6457-a916-4656-863a-fc5fde0d148d" class="code"><code>delete from è¡¨åwhere column = value...DELETE FROM WebsitesWHERE name=&#x27;Facebook&#x27; AND country=&#x27;USA&#x27;;--åˆ é™¤è¡¨ä¸­æ‰€æœ‰çš„è¡Œï¼Œè¡¨ç»“æœä¸å˜delete from table_name;</code></pre><ul id="4dbb68b4-6f83-48b6-b36d-becd8bcf2ab5" class="bulleted-list"><li>alter table- ä¿®æ”¹æ•°æ®åº“è¡¨</li></ul><pre id="594091d1-d9f7-420f-ac31-e3e18fdb7617" class="code"><code>--æ¸…æ¥šè¡¨ä¸­æ•°æ®,åˆ é™¤æ‰æŒ‡å®šåˆ†åŒº

ALTER TABLE shphonefeature DROP IF EXISTS PARTITION(year = 2015, month = 10, day = 1);

---lter table test.mon_mau_list drop partition (hit_mon = &#x27;{0}&#x27;)</code></pre><ul id="44d40d9a-bbc4-4c6b-ad58-a8db0aecca0d" class="bulleted-list"><li>drop table - åˆ é™¤è¡¨</li></ul><ul id="c1ffa4a9-2287-4c7a-a920-b815c16f281b" class="bulleted-list"><li>create index -åˆ›å»ºç´¢å¼•</li></ul><ul id="541ccbf9-c0f7-46f3-a8fa-2651c0858016" class="bulleted-list"><li>drop index -åˆ é™¤ç´¢å¼•</li></ul><ul id="a6829fab-3cb6-4a51-8516-4c92a2d4a892" class="bulleted-list"><li>refresh table è¡¨å - åˆ·æ–°æ•°æ®è¡¨</li></ul><pre id="d81928bc-2bd9-447c-932c-5506cfafd14a" class="code"><code>refresh table computer_log.client_ios_log</code></pre><ul id="8c987933-5f6d-4a0b-b05a-cd40aa8d5106" class="bulleted-list"><li>æŸ¥çœ‹å½“å‰ä½¿ç”¨çš„æ•°æ®åº“ä¸­æœ‰å“ªäº›è¡¨</li></ul><pre id="2a4161ab-17a0-4102-9d9e-8cfc7f78afec" class="code"><code>show tables;</code></pre><ul id="4a1fb4c1-a308-4882-b89d-ababcf440135" class="bulleted-list"><li>æŸ¥çœ‹éå½“å‰ä½¿ç”¨çš„æ•°æ®åº“ä¸­æœ‰å“ªäº›è¡¨</li></ul><pre id="1b13c2cb-d50e-43c5-a77a-cf1ec572c33e" class="code"><code>show tables in myhive;</code></pre><ul id="4802f2b6-e455-4844-b6b6-bcd706a50e3e" class="bulleted-list"><li>æŸ¥çœ‹æ•°æ®åº“ä¸­ä»¥ android å¼€å¤´çš„è¡¨</li></ul><pre id="e61e7f23-9753-481a-896c-30879f6afd43" class="code"><code>use android;show tables like &#x27;android*&#x27;</code></pre><ul id="0b19df3d-b989-4617-9ab4-51a2885ef2f3" class="bulleted-list"><li>æŸ¥çœ‹è¡¨çš„è¯¦ç»†ä¿¡æ¯</li></ul><pre id="c77fed4d-f979-4270-8d0e-43c9764fbc49" class="code"><code>desc formatted android</code></pre><ul id="929809be-8709-4e29-b455-9a82ce95961d" class="bulleted-list"><li>æŸ¥è¯¢åˆ†åŒºè¡¨æœ‰å¤šå°‘åˆ†åŒº</li></ul><pre id="839a344c-935c-476c-9195-af2b4001a680" class="code"><code>show partitions dept_partition;</code></pre><ul id="1bc34073-8352-4872-a7a2-b22e7570f9c1" class="bulleted-list"><li>æŸ¥çœ‹åˆ†åŒºè¡¨ç»“æœ</li></ul><pre id="f4f4e36d-49b6-438f-9c37-66be624cca39" class="code"><code>desc formatted dept_partition</code></pre><ul id="29b36ff2-fffc-4504-b0d6-c93f1cdf3137" class="bulleted-list"><li>å¢åŠ åˆ†åŒº</li></ul><pre id="ed8a95db-6fec-49ed-b473-9e296307a0fe" class="code"><code>alter table dept_partition add partition(month=&#x27;201705&#x27;) partition(month=&#x27;201704&#x27;)</code></pre><ul id="0e5dbff3-80d1-4207-9824-142ae0f28b85" class="bulleted-list"><li>åˆ é™¤åˆ†åŒº</li></ul><pre id="801aaedb-16c4-4409-8e35-5534466fcf32" class="code"><code>alter table dept_partition drop partition (month=&#x27;201705&#x27;)</code></pre><h2 id="1536a52c-95b9-4511-826d-c762dec6991f" class="">å†…éƒ¨è¡¨ä¸å¤–éƒ¨è¡¨</h2><ul id="d959aa18-a1e4-4018-81eb-0bef2edfb1ce" class="bulleted-list"><li>å†…éƒ¨è¡¨(ç®¡ç†è¡¨)ï¼šé»˜è®¤åˆ›å»ºå†…éƒ¨è¡¨ï¼Œ åˆ é™¤è¡¨ä¼šåˆ é™¤æ‰€æœ‰æ•°æ®</li></ul><ul id="f1d9169a-2caf-453c-86d3-d397d4f17630" class="bulleted-list"><li>å¤–éƒ¨è¡¨ï¼š åˆ é™¤è¡¨ä¸ä¼šåˆ é™¤è¿™ä»½æ•°æ®ï¼Œä¸è¿‡æè¿°è¡¨çš„å…ƒæ•°æ®ä¿¡æ¯ä¼šè¢«åˆ é™¤æ‰ã€‚</li></ul><ul id="6f7ef1e1-ff65-4313-8ee7-46ccd396dc20" class="bulleted-list"><li>åŸå§‹æ—¥å¿—æ•°æ®åº”è¯¥å»ºç«‹å¤–éƒ¨è¡¨ï¼ˆé¿å…è¯¯åˆ ï¼‰ï¼Œ ç”¨åˆ°çš„ä¸­é—´è¡¨ã€ç»“æœè¡¨ä½¿ç”¨å†…éƒ¨è¡¨å­˜å‚¨ã€‚</li></ul><ul id="eda4bdd0-3452-4431-afcd-9ce100de733c" class="bulleted-list"><li>æŸ¥çœ‹è¡¨æ˜¯å†…éƒ¨è¡¨è¿˜æ˜¯å¤–éƒ¨è¡¨</li></ul><pre id="c088e0da-f1bd-4b21-8c35-ad4823d66fdb" class="code"><code>--æŸ¥çœ‹è¡¨ä¿¡æ¯
desc  formatted  table_name</code></pre><ul id="29db2ee6-8dc7-4fd4-ab93-b5dfb0feec99" class="bulleted-list"><li>å†…éƒ¨è¡¨ä¸å¤–éƒ¨è¡¨çš„ç›¸äº’è½¬æ¢</li></ul><pre id="627223d2-0d99-4d28-b550-635fb373126a" class="code"><code>---å†…éƒ¨è¡¨è½¬æ¢ä¸ºå¤–éƒ¨è¡¨
alter table student set tblproperties(&#x27;EXTERNAL&#x27; = &#x27;true&#x27;) ---å•å¼•å·ã€å¤§å°å†™ä¸èƒ½å˜

---å¤–éƒ¨è¡¨è½¬åŒ–ä¸ºå†…éƒ¨è¡¨
alter table student set tbproperties(&#x27;EXTERNAL&#x27; = &#x27;false&#x27;)</code></pre><h1 id="a2052d88-609a-4d4c-8159-9cbd1525692c" class="">æŸ¥è¯¢</h1><h2 id="e1e6641e-e2ce-4df2-9d01-fbbba46944ce" class="">selectâ€¦fromâ€¦</h2><ul id="e5c90a1f-48d8-4788-852c-2e355ef2921d" class="bulleted-list"><li>åŠ å…¥è¡¨ä¸­ä¸€åˆ—å«æœ‰å¤šä¸ªå…ƒç´ ï¼Œ æˆ‘ä»¬å¯ä»¥åªæŸ¥æ‰¾æ­¤åˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ </li></ul><pre id="eb7d7824-4747-4f33-8c30-9b5b60758975" class="code"><code>select name, subord[0] from employees;</code></pre><ul id="2864bbe0-a817-48e0-b929-331ec9676b6a" class="bulleted-list"><li>å¯ä»¥ä½¿ç”¨ â€œç‚¹â€ ç¬¦å·ï¼Œ ç±»ä¼¼ï¼šè¡¨çš„åˆ«å . åˆ—å è¿™æ ·çš„ç”¨æ³•</li></ul><pre id="6c81d330-3f8c-44a5-a258-07f409f317a5" class="code"><code>select  name, address.city  from  employees;</code></pre><ul id="e036246c-fc36-4aaf-a18f-7eb605681cd4" class="bulleted-list"><li>ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¯ä»¥é€‰å‡ºæ‰€æœ‰åˆ—åä»¥ price ä½œä¸ºå‰ç¼€çš„åˆ—</li></ul><pre id="2a543461-353f-4c40-9929-661e572d6cfa" class="code"><code>select  &#x27;price.*&#x27;  from  stocks;</code></pre><ul id="8be4f8c0-83ed-4527-a4c5-994b11d29aab" class="bulleted-list"><li>ä½¿ç”¨åˆ—å€¼è¿›è¡Œè®¡ç®—</li></ul><pre id="89d51e6b-7c60-45b8-b7b7-31222221a647" class="code"><code>select count(distinct account), avg(salary) from employees;</code></pre><ul id="016f27eb-a949-4912-a78a-0d9501fba039" class="bulleted-list"><li>ä½¿ç”¨åˆ«å</li></ul><pre id="17b405b2-bb88-4821-97aa-94ef2f648e46" class="code"><code>select  count(distinct acount) as uv   from   employees;</code></pre><ul id="21e3722a-93c4-46a4-a07f-ce33c114c28d" class="bulleted-list"><li>å¦‚æœç”¨ distinct, select åé¢å¿…é¡»ç›´æ¥è·Ÿ distinct</li></ul><pre id="7316ce08-5b75-475c-b2d7-133ee850f515" class="code"><code>select  distinct user_account, province from    computer_viedata
</code></pre><h2 id="37fae364-5e1e-4432-b02a-62e12f4dd9bb" class="">where</h2><ul id="81cbe426-e447-4506-8626-6f15995233d6" class="bulleted-list"><li>å…³ç³»å‹è¿ç®—ç¬¦ä¼˜å…ˆçº§é«˜åˆ°ä½ä¸ºï¼šnot - and - or</li></ul><pre id="d341f057-83c5-4811-8c2f-ba90253a71ea" class="code"><code>select * from employees where country = &#x27;us&#x27; and state = &#x27;ca&#x27;;select * from employees where country  not in (&#x27;us&#x27;, &#x27;china&#x27;)</code></pre><ul id="e55a6235-2a38-48f7-871f-4f6a09426f6f" class="bulleted-list"><li>æ•°å­¦è¿ç®—ç¬¦ä¸å…³ç³»è¿ç®—ç¬¦</li></ul><div id="055703aa-b447-4fd1-8a54-d7bb0f0bd42d" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>è¿ç®—ç¬¦</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>æè¿°</th></tr></thead><tbody><tr id="f8847bfc-4236-4440-9c00-5b1959c8355e"><td class="cell-title"><a href="https://www.notion.so/f8847bfc423644409c005b1959c8355e">+</a></td><td class="cell-wb2&amp;">åŠ æ³•</td></tr><tr id="98804d05-90a2-4a51-a653-b7b661f8b841"><td class="cell-title"><a href="https://www.notion.so/98804d0590a24a51a653b7b661f8b841">-</a></td><td class="cell-wb2&amp;">å‡æ³•</td></tr><tr id="ce36cde9-ea69-45af-a2ab-735335c24536"><td class="cell-title"><a href="https://www.notion.so/ce36cde9ea6945afa2ab735335c24536">*</a></td><td class="cell-wb2&amp;">ä¹˜æ³•</td></tr><tr id="30a926db-a766-4ebe-87af-5ec04c5a57b4"><td class="cell-title"><a href="https://www.notion.so/30a926dba7664ebe87af5ec04c5a57b4">/</a></td><td class="cell-wb2&amp;">é™¤æ³•</td></tr><tr id="ecdb81b5-2fe4-40d6-b0d1-20901938ad85"><td class="cell-title"><a href="https://www.notion.so/ecdb81b52fe440d6b0d120901938ad85">%</a></td><td class="cell-wb2&amp;">å–ä½™</td></tr><tr id="02fe94dc-f6d2-4533-88c4-b38f494e16ba"><td class="cell-title"><a href="https://www.notion.so/02fe94dcf6d2453388c4b38f494e16ba">&amp;</a></td><td class="cell-wb2&amp;">ä¸</td></tr><tr id="f7d4d7b4-a3ed-4e31-a600-397ec6374cc2"><td class="cell-title"><a href="https://www.notion.so/f7d4d7b4a3ed4e31a600397ec6374cc2">| </a></td><td class="cell-wb2&amp;">æˆ–</td></tr><tr id="72b9ab77-cf96-4485-bdfd-aba0a68c832f"><td class="cell-title"><a href="https://www.notion.so/72b9ab77cf964485bdfdaba0a68c832f">^</a></td><td class="cell-wb2&amp;"><mark class="highlight-red">å¼‚æˆ–ï¼Ÿ</mark></td></tr><tr id="e596dfe2-2b35-4b56-8a75-f92ea48ede52"><td class="cell-title"><a href="https://www.notion.so/e596dfe22b354b568a75f92ea48ede52">~</a></td><td class="cell-wb2&amp;">å–å</td></tr><tr id="093d9813-faeb-4e20-8566-20e75be36ddf"><td class="cell-title"><a href="https://www.notion.so/093d9813faeb4e20856620e75be36ddf">æ“ä½œç¬¦</a></td><td class="cell-wb2&amp;">æè¿°</td></tr><tr id="27fb0845-7161-497d-a7c6-55633bb2e351"><td class="cell-title"><a href="https://www.notion.so/A-B-27fb08457161497da7c655633bb2e351">A=B</a></td><td class="cell-wb2&amp;">å¦‚æœA=Bï¼Œåˆ™è¿”å›True,å¦åˆ™è¿”å›False</td></tr><tr id="482d0a9a-69d7-49c2-8964-bf1cfbfd5a18"><td class="cell-title"><a href="https://www.notion.so/A-B-482d0a9a69d749c28964bf1cfbfd5a18">A&lt;=&gt;B</a></td><td class="cell-wb2&amp;">å¦‚æœAå’ŒBéƒ½ä¸ºNULLï¼Œåˆ™è¿”å›True,å…¶ä»–çš„å’Œç­‰å·æ“ä½œç»“æœä¸€è‡´ï¼Œå¦‚æœä»»æ„ä¸ºNull,åˆ™ç»“æœä¸ºnull</td></tr><tr id="395cca45-29d0-423c-9258-b60ca512f2a7"><td class="cell-title"><a href="https://www.notion.so/A-B-A-B-395cca4529d0423c9258b60ca512f2a7">A&lt;&gt;B,A!=B</a></td><td class="cell-wb2&amp;">Aæˆ–Bä¸ºNull, åˆ™è¿”å›Null,å¦‚æœAä¸ç­‰äºBï¼Œåˆ™è¿”å›True,å¦åˆ™è¿”å›False</td></tr><tr id="c73dc8b0-c345-4a3c-a7c2-fc7e57db29b9"><td class="cell-title"><a href="https://www.notion.so/A-B-c73dc8b0c3454a3ca7c2fc7e57db29b9">A&lt;B</a></td><td class="cell-wb2&amp;"></td></tr><tr id="6d78b901-3fe7-44e6-8395-46e47700d96f"><td class="cell-title"><a href="https://www.notion.so/A-B-6d78b9013fe744e6839546e47700d96f">A&lt;=B</a></td><td class="cell-wb2&amp;"></td></tr><tr id="c4bb16d0-5b56-41e3-8d5c-331fa5aaebd2"><td class="cell-title"><a href="https://www.notion.so/A-B-c4bb16d05b5641e38d5c331fa5aaebd2">A&gt;B</a></td><td class="cell-wb2&amp;"></td></tr><tr id="97bc0d3c-14ed-4c32-a631-bfe3db493fe2"><td class="cell-title"><a href="https://www.notion.so/A-b-97bc0d3c14ed4c32a631bfe3db493fe2">A&gt;=b</a></td><td class="cell-wb2&amp;"></td></tr><tr id="68c409ea-06ab-4b9a-868a-136627808846"><td class="cell-title"><a href="https://www.notion.so/A-not-between-B-and-C-68c409ea06ab4b9a868a136627808846">A[not] between B and C</a></td><td class="cell-wb2&amp;"></td></tr><tr id="ef58f9b1-e2c5-48b3-bd76-5062b2917f43"><td class="cell-title"><a href="https://www.notion.so/A-is-null-ef58f9b1e2c548b3bd765062b2917f43">A is null</a></td><td class="cell-wb2&amp;"></td></tr><tr id="7714f410-72bd-4ec2-be40-ab4cab99a505"><td class="cell-title"><a href="https://www.notion.so/A-is-not-null-7714f41072bd4ec2be40ab4cab99a505">A is not null</a></td><td class="cell-wb2&amp;"></td></tr><tr id="3c9227ae-26a0-48d7-b608-419b5271db1e"><td class="cell-title"><a href="https://www.notion.so/in-3c9227ae26a048d7b608419b5271db1e">in</a></td><td class="cell-wb2&amp;"></td></tr><tr id="b317625e-cbc5-42f6-bc9b-24048d44de78"><td class="cell-title"><a href="https://www.notion.so/A-NOT-like-B-b317625ecbc542f6bc9b24048d44de78">A [NOT] like B</a></td><td class="cell-wb2&amp;"></td></tr><tr id="f6afd35f-6f44-433c-80b6-8d85c2053886"><td class="cell-title"><a href="https://www.notion.so/A-rlike-B-A-REGEXP-B-f6afd35f6f44433c80b68d85c2053886">A rlike B, A REGEXP B</a></td><td class="cell-wb2&amp;"></td></tr><tr id="4e4176d3-1811-4573-a0ad-b9ebfbbb18e6"><td class="cell-title"><a href="https://www.notion.so/4e4176d318114573a0adb9ebfbbb18e6">é€»è¾‘è¿ç®—</a></td><td class="cell-wb2&amp;">æè¿°</td></tr><tr id="e5d9d9f8-2cd0-46b3-a205-169ddb8e17e5"><td class="cell-title"><a href="https://www.notion.so/and-e5d9d9f82cd046b3a205169ddb8e17e5">and</a></td><td class="cell-wb2&amp;"></td></tr><tr id="b522ec7f-d88d-4b1e-bf1a-3ce4248e9f6b"><td class="cell-title"><a href="https://www.notion.so/or-b522ec7fd88d4b1ebf1a3ce4248e9f6b">or</a></td><td class="cell-wb2&amp;"></td></tr><tr id="64fcc647-8e8e-436f-a681-fbe985a10549"><td class="cell-title"><a href="https://www.notion.so/not-64fcc6478e8e436fa681fbe985a10549">not</a></td><td class="cell-wb2&amp;"></td></tr></tbody></table></div><ul id="e78b4b13-c827-4a61-be70-b5fd7109e84a" class="bulleted-list"><li>likeã€rlike</li></ul><pre id="83a15b93-21b5-401b-b302-0434fc868e04" class="code"><code>---likeã€ rlike 
select name, address.street from employees where address.street rlike &#x27;.*(beijing|shanghai).*&#x27;;

select name, address.street from employeeswhere address.street like &#x27;%beijing%&#x27; or address.street like &#x27;%shanghai%&#x27;;</code></pre><div id="18d9ebe5-a2be-4260-a857-afd2a13a041f" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>é€šé…ç¬¦</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>å«ä¹‰</th></tr></thead><tbody><tr id="a301577d-acb7-4d67-a468-721aac8b4fe2"><td class="cell-title"><a href="https://www.notion.so/a301577dacb74d67a468721aac8b4fe2">%</a></td><td class="cell-$-&quot;-">åŒ¹é…0ä¸ªæˆ–ä»»æ„å¤šä¸ªå­—ç¬¦</td></tr><tr id="6dadbb8b-c924-4f70-a3f4-5394aa75288d"><td class="cell-title"><a href="https://www.notion.so/_-6dadbb8bc9244f70a3f45394aa75288d">_</a></td><td class="cell-$-&quot;-">åŒ¹é…ä»»æ„ä¸€ä¸ªå­—ç¬¦</td></tr><tr id="928b78d3-9abb-4724-9269-73bbe0b47229"><td class="cell-title"><a href="https://www.notion.so/escape-928b78d39abb4724926973bbe0b47229">escape</a></td><td class="cell-$-&quot;-">è½¬ä¹‰å­—ç¬¦ï¼Œå¯åŒ¹é…%å’Œ_ã€‚å¦‚SELECT * FROM table_name WHERE column_name LIKE â€˜/%/%â€™ ESCAPEâ€™/â€™</td></tr><tr id="f9c017c9-9301-45c6-acc0-8d96565dfab9"><td class="cell-title"><a href="https://www.notion.so/f9c017c9930145c6acc08d96565dfab9">â€”</a></td><td class="cell-$-&quot;-">â€”</td></tr><tr id="723a7163-7f96-438d-bbae-eb5c12f12bb4"><td class="cell-title"><a href="https://www.notion.so/723a71637f96438dbbaeeb5c12f12bb4">.</a></td><td class="cell-$-&quot;-">åŒ¹é…ä»»æ„å•ä¸ªå­— ç¬¦</td></tr><tr id="3b36b7fd-021f-4ac5-b0c2-ce8414a74917"><td class="cell-title"><a href="https://www.notion.so/3b36b7fd021f4ac5b0c2ce8414a74917">*</a></td><td class="cell-$-&quot;-">åŒ¹é…0ä¸ªæˆ–å¤šä¸ªå‰ä¸€ä¸ªå¾—åˆ°çš„å­—ç¬¦</td></tr><tr id="dc2eed1c-07af-4ad0-b4d0-f70be5264e36"><td class="cell-title"><a href="https://www.notion.so/dc2eed1c07af4ad0b4d0f70be5264e36">[]</a></td><td class="cell-$-&quot;-">å«æœ‰ä»»æ„ä¸€ä¸ª[]å†…çš„å­—ç¬¦ï¼Œ[ab]*å¯åŒ¹é…ç©ºä¸²ã€aã€bã€æˆ–è€…ç”±ä»»æ„ä¸ªaå’Œbç»„æˆçš„å­—ç¬¦ä¸²ã€‚</td></tr><tr id="1316e470-00ae-4ba4-8b34-6c23ea5e2868"><td class="cell-title"><a href="https://www.notion.so/1316e47000ae4ba48b346c23ea5e2868">^</a></td><td class="cell-$-&quot;-">åŒ¹é…å¼€å¤´ï¼Œå¦‚^såŒ¹é…ä»¥sæˆ–è€…Så¼€å¤´çš„å­—ç¬¦ä¸²</td></tr><tr id="d054e659-f1a2-49a9-91eb-45f64b026723"><td class="cell-title"><a href="https://www.notion.so/d054e659f1a249a991eb45f64b026723">$</a></td><td class="cell-$-&quot;-">åŒ¹é…ç»“å°¾ï¼Œå¦‚s$åŒ¹é…ä»¥sç»“å°¾çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr id="2d29656a-fb30-455d-bb4b-bde49f3922f8"><td class="cell-title"><a href="https://www.notion.so/n-2d29656afb30455dbb4bbde49f3922f8">{n}</a></td><td class="cell-$-&quot;-">åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦åå¤næ¬¡ã€‚</td></tr></tbody></table></div><h2 id="ef232d11-7476-4d3e-b9a2-112fa2afa49a" class="">group by</h2><pre id="794b9ab0-f5b2-45f5-8061-0bb13661c84a" class="code"><code>--- å¯¹ç»“æœè¿›è¡Œåˆ†ç±»

select     year(ymd), avg(price_close) 

from     stockswhere     exchange = &#x27;nasdaq&#x27; and symbol = &#x27;aapl&#x27;

group by     year(ymd)

order by     year(ymd) desc;  --desc ä»é«˜åˆ°ä½æ’åˆ—</code></pre><h2 id="4c297223-504e-4ca6-95ab-e7ca8cdf7339" class="">order by</h2><pre id="02396310-690f-4611-9ac6-712f0831e124" class="code"><code>--å¯¹æŸ¥è¯¢çš„æ‰€æœ‰ç»“æœè¿›è¡Œæ’åº, å¯åœ¨å­—æ®µåŠ  DESC å…³é”®å­—ï¼Œ è¿›è¡Œé™åºæ’åºã€‚ ï¼ˆé»˜è®¤ ASCï¼Œ å‡åºï¼‰

select     year(ymd), avg(price_close) 

from     stockswhere     exchange = &#x27;nasdaq&#x27; and symbol = &#x27;aapl&#x27;

group by     year(ymd)

order by     year(ymd) desc;</code></pre><pre id="da476c14-03e7-4a20-bb01-1a450a917a9a" class="code"><code>--å…ˆå¯¹codeè¿›è¡Œæ’åºï¼Œç„¶åå¯¹codeé‡Œçš„å§“åè¿›è¡Œæ’åº

select * from a 

order by code, name desc;</code></pre><h2 id="e9386510-cb0a-49b0-805a-14274ee0b74e" class="">having</h2><pre id="ccc76145-39c5-4a82-b1b7-445b74c2a700" class="code"><code>--- having å­å¥æ¥é™åˆ¶è¾“å‡ºç»“æœ--- æŸ¥æ‰¾å¹³å‡å·¥èµ„å¤§äº3000çš„éƒ¨é—¨

select     deparment, avg(salary) as average from      salary_info group by     deparment having     average &gt; 3000</code></pre><ul id="b5c4bdab-91f6-4e28-8972-229ee413859c" class="block-color-gray_background bulleted-list"><li>having ä¸ where çš„åŒºåˆ«ï¼š</li></ul><ul id="9c8b55c9-01cd-4db3-96af-b179c301f402" class="bulleted-list"><li>Where æ˜¯ä¸€ä¸ªçº¦æŸå£°æ˜ï¼Œä½¿ç”¨Whereçº¦æŸæ¥è‡ªæ•°æ®åº“çš„æ•°æ®ï¼ŒWhereæ˜¯åœ¨ç»“æœè¿”å›ä¹‹å‰èµ·ä½œç”¨çš„ï¼ŒWhereä¸­ä¸èƒ½ä½¿ç”¨èšåˆå‡½æ•°ã€‚</li></ul><ul id="fc52e713-a547-4f61-b277-c3eface1734e" class="bulleted-list"><li>Havingæ˜¯ä¸€ä¸ªè¿‡æ»¤å£°æ˜ï¼Œæ˜¯åœ¨æŸ¥è¯¢è¿”å›ç»“æœé›†ä»¥åå¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œçš„è¿‡æ»¤æ“ä½œï¼Œåœ¨Havingä¸­å¯ä»¥ä½¿ç”¨èšåˆå‡½æ•°ã€‚</li></ul><h2 id="7508cc22-3f69-46dc-bd08-d24c5c1e8ef9" class="">limit</h2><pre id="ed861e2e-cf8b-4fac-8fb6-3af829e7c326" class="code"><code>---ä½¿ç”¨limitè¯­å¥é™åˆ¶è¿”å›çš„è¡Œæ•°ï¼Œåªæ˜¾ç¤º 10 è¡Œ

select count(distinct account) as uv  from  employees  

limit 10;</code></pre><h2 id="d6adb8da-1975-4408-8674-c83ddac0b606" class="">è¡¨è¿æ¥</h2><h3 id="fdb238a9-84eb-47dc-99af-d2df364e59d3" class="">join</h3><p id="959e2752-bb27-4070-b776-41ccadb30f92" class="">Hiveä¸­Joinçš„å…³è”é”®å¿…é¡»åœ¨ON ()ä¸­æŒ‡å®šï¼Œä¸èƒ½åœ¨Whereä¸­æŒ‡å®š,ON å­å¥æŒ‡å®šäº†ä¸¤ä¸ªè¡¨é—´æ•°æ®è¿›è¡Œè¿æ¥çš„æ¡ä»¶ã€‚</p><figure id="90de64ad-f278-4902-8018-f60e88c3d56e" class="image"><a href="https://i.loli.net/2019/06/11/5cffb911ad8e183153.png"><img src="https://i.loli.net/2019/06/11/5cffb911ad8e183153.png"/></a></figure><ul id="ba6c4de2-262a-4075-bda3-deff1311794d" class="bulleted-list"><li>å¯¹äºå¤šå¼ è¡¨è¿›è¡Œè¿æ¥æŸ¥è¯¢</li></ul><pre id="020d3631-4e46-4ae9-8ea1-cdb6f1516cdf" class="code"><code>---ä¸ºä»€ä¹ˆæ¡ä»¶å†…ä¸å°†è¡¨ b å’Œè¡¨ c è¿›è¡Œè¿æ¥æ“ä½œï¼Œ å› ä¸º Hiveæ€»æ˜¯æŒ‰ç…§ä»å·¦åˆ°å³çš„é¡ºåºæ¥æ‰§è¡Œ

SELECT
    *
FROM
    (((a JOIN b ON a.ymd = b.ymd)
      JOIN c ON a.ymd = c.ymd)
      join d on a.ymd = d.ymd)
WHERE 
    a. symbol = &#x27;Apple&#x27;  AND b.symbol = &#x27;Ibm&#x27; AND c.symbol = &#x27;Google&#x27;</code></pre><h3 id="07195066-4d63-4705-b6a5-260c0bceedd0" class="">å¹¶é›†ï¼šunion ä¸ union all</h3><pre id="ec7286fe-d86b-4e93-b625-e1bea07c4809" class="code"><code>with a1 as (
        select
            user_account
        from
            data
        where
            hit_date between &#x27;2018-12-01&#x27; and &#x27;2018-12-02&#x27;
            and
            nbtn_name like &quot;%æ”¯ä»˜å®%&quot;
        union 
        select
            user_account
        from
            data
        where
            hit_date between &#x27;2018-12-01&#x27; and &#x27;2018-12-02&#x27;
        and
        nbtn_name like &quot;%æ‰‹æ·˜%&quot;)
select
    count(user_account) as pv
from
    a1</code></pre><ul id="61561ae9-1b2d-4900-a733-6abcbe228528" class="block-color-gray_background bulleted-list"><li>union ä¸ union all çš„ä¸åŒï¼š</li></ul><ul id="3d348435-7102-42e3-b279-0bd8c06b5d62" class="bulleted-list"><li>union, ç»“æœåŒ…å«æ‰€æœ‰è¡Œï¼Œ å¹¶åˆ é™¤é‡å¤è¡Œ</li></ul><ul id="35cda33c-8d8e-4338-9a5d-6a2cc6d580c9" class="bulleted-list"><li>unoin all, ç»“æœåŒ…å«æ‰€æœ‰è¡Œï¼Œ ä½†ä¸åˆ é™¤é‡å¤è¡Œ</li></ul><h3 id="54c1d2d7-b674-4764-b5e2-80efa866a85a" class="">äº¤é›†ï¼šintersect</h3><pre id="8cbf2e42-1c99-45d6-9f89-2a2b0baf99f0" class="code"><code>with a1 as (
        select
            user_account
        from
            data
        where
            hit_date between &#x27;2018-12-01&#x27; and &#x27;2018-12-02&#x27;
            and
            nbtn_name like &quot;%æ”¯ä»˜å®%&quot;
        intersect
        select
            user_account
        from
            data
        where
            hit_date between &#x27;2018-12-01&#x27; and &#x27;2018-12-02&#x27;
        and
        nbtn_name like &quot;%æ‰‹æ·˜%&quot;)
select
    count(user_account) as pv
from
    a1</code></pre><h3 id="12d87990-b103-4a49-b8c2-c8f636209383" class="">å·®é›†ï¼šexcept</h3><pre id="e0d9a263-aec2-4bdb-b441-dc588518e53e" class="code"><code>with a1 as (
        select
            user_account
        from
            data
        where
            hit_date between &#x27;2018-12-01&#x27; and &#x27;2018-12-25&#x27;
            and
            nbtn_name like &quot;%æ”¯ä»˜å®%&quot;
        except
        select
            user_account
        from
            data
        where
            hit_date between &#x27;2018-12-01&#x27; and &#x27;2018-12-25&#x27;
        and
        nbtn_name like &quot;%æ‰‹æ·˜%&quot;)
select
    count(user_account) as pv
from
    a1</code></pre><h1 id="d97d432d-b624-4438-bf4d-07af78a232c6" class="">å‡½æ•°</h1><h2 id="a0966b51-e48c-4f4f-b4cf-6efb4d8cc433" class="">èšåˆå‡½æ•°</h2><div id="95e5f3e7-03a7-4864-afad-9be85a77035a" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>å‡½æ•°å</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>å®šä¹‰</th></tr></thead><tbody><tr id="6d4a165f-1ed2-4c48-a9be-9ab53eaebbd5"><td class="cell-title"><a href="https://www.notion.so/count-6d4a165f1ed24c48a9be9ab53eaebbd5">count()</a></td><td class="cell-C&#x27;u@">ä¸ªæ•°ç»Ÿè®¡å‡½æ•°</td></tr><tr id="50b4f94b-8614-422f-9462-fa0ecdd4e1f2"><td class="cell-title"><a href="https://www.notion.so/count-distinct-50b4f94b8614422f9462fa0ecdd4e1f2">count(distinct )</a></td><td class="cell-C&#x27;u@">ç»Ÿè®¡å»é‡ä¹‹åçš„ä¸ªæ•°</td></tr><tr id="5c4dec3f-1e4a-4961-b437-2a95cb6fd7e2"><td class="cell-title"><a href="https://www.notion.so/sum-5c4dec3f1e4a4961b4372a95cb6fd7e2">sum()</a></td><td class="cell-C&#x27;u@">æ±‚å’Œ</td></tr><tr id="7461810a-3e48-45ee-943e-ab58a4666757"><td class="cell-title"><a href="https://www.notion.so/sum-distinct-7461810a3e4845ee943eab58a4666757">sum(distinct )</a></td><td class="cell-C&#x27;u@">å»é‡ä¹‹åçš„å’Œ</td></tr><tr id="4251eb3c-1fff-4a37-805e-b4c1b61e2870"><td class="cell-title"><a href="https://www.notion.so/avg-4251eb3c1fff4a37805eb4c1b61e2870">avg()</a></td><td class="cell-C&#x27;u@">å¹³å‡å€¼</td></tr><tr id="d6a2bbd1-47e1-452e-95dd-1aa28ed34f38"><td class="cell-title"><a href="https://www.notion.so/avg-distinct-d6a2bbd147e1452e95dd1aa28ed34f38">avg(distinct)</a></td><td class="cell-C&#x27;u@">å»é‡ä¹‹åçš„å¹³å‡å€¼</td></tr><tr id="21ba50bf-645b-416f-b21a-47ef4cf5d9bf"><td class="cell-title"><a href="https://www.notion.so/min-21ba50bf645b416fb21a47ef4cf5d9bf">min()</a></td><td class="cell-C&#x27;u@">æœ€å°å€¼</td></tr><tr id="26712e6d-ef08-4ae7-a388-b1f9b27e54ea"><td class="cell-title"><a href="https://www.notion.so/max-26712e6def084ae7a388b1f9b27e54ea">max()</a></td><td class="cell-C&#x27;u@">æœ€å¤§å€¼</td></tr><tr id="7b1148c8-605e-47af-a42b-3a115bf9cd59"><td class="cell-title"><a href="https://www.notion.so/corr-A-B-7b1148c8605e47afa42b3a115bf9cd59">corr(A, B)</a></td><td class="cell-C&#x27;u@">ç›¸å…³ç³»æ•°</td></tr><tr id="61872c01-1ed5-486c-aeed-ae2987736090"><td class="cell-title"><a href="https://www.notion.so/var_pop-61872c011ed5486caeedae2987736090">var_pop()</a></td><td class="cell-C&#x27;u@">æ–¹å·®</td></tr><tr id="595c6efe-64f1-414b-a608-5131306c7910"><td class="cell-title"><a href="https://www.notion.so/var_samp-595c6efe64f1414ba6085131306c7910">var_samp()</a></td><td class="cell-C&#x27;u@">æ ·æœ¬æ–¹å·®</td></tr><tr id="a6658fb6-52c2-45bc-b818-66f4c2fbe5fd"><td class="cell-title"><a href="https://www.notion.so/stddev_pop-a6658fb652c245bcb81866f4c2fbe5fd">stddev_pop()</a></td><td class="cell-C&#x27;u@">æ ‡å‡†åå·®</td></tr><tr id="d566cd56-f304-4728-bdf3-fed98c55be39"><td class="cell-title"><a href="https://www.notion.so/stddev_samp-d566cd56f3044728bdf3fed98c55be39">stddev_samp()</a></td><td class="cell-C&#x27;u@">æ ‡å‡†æ ·æœ¬åå·®</td></tr><tr id="9011311c-3b2b-4cee-b867-6fe89d8dfcdd"><td class="cell-title"><a href="https://www.notion.so/covar_pop-A-B-9011311c3b2b4ceeb8676fe89d8dfcdd">covar_pop(A, B)</a></td><td class="cell-C&#x27;u@">åæ–¹å·®</td></tr><tr id="d0c9e0ad-e7fe-43a3-ac74-f8d8069f4e01"><td class="cell-title"><a href="https://www.notion.so/covar_samp-A-B-d0c9e0ade7fe43a3ac74f8d8069f4e01">covar_samp(A, B)</a></td><td class="cell-C&#x27;u@">æ ·æœ¬åæ–¹å·®</td></tr><tr id="65f1707d-e996-4c48-bdb3-92ec2685bf33"><td class="cell-title"><a href="https://www.notion.so/RAND-65f1707de9964c48bdb392ec2685bf33">RAND()</a></td><td class="cell-C&#x27;u@">éšæœºæ•°</td></tr><tr id="71933631-00ac-48be-930d-9e0eff375abe"><td class="cell-title"><a href="https://www.notion.so/size-7193363100ac48be930d9e0eff375abe">size()</a></td><td class="cell-C&#x27;u@">è®¡ç®—æ•°ç»„é•¿åº¦</td></tr></tbody></table></div><ul id="1026dac4-e30a-4d08-a704-5d69781392e0" class="block-color-gray_background bulleted-list"><li>count(1)ã€count(*)ã€count(column) ä¹‹é—´çš„åŒºåˆ«</li></ul><ul id="66051745-38f0-4d13-b9e9-64166f7bef35" class="bulleted-list"><li>æ‰§è¡ŒèŒƒå›´ä¸Šï¼š count(*) å’Œ count (1)  éƒ½åŒ…å«äº† å¯¹NULLçš„ç»Ÿè®¡ã€‚ count(åˆ—å)ç»Ÿè®¡æ—¶ä¸åŒ…å«NULLå€¼ã€‚</li></ul><ul id="22fb0acc-630b-4ff9-8fde-edeb6bcabb65" class="bulleted-list"><li>æ‰§è¡Œé€Ÿåº¦ä¸Šï¼š åˆ—åä¸ºä¸»é”®æ—¶ï¼Œ count(åˆ—å) æœ€å¿«<em>ã€‚  å½“æ— ä¸»é”®æ—¶ï¼Œ count(1) æœ€å¿«ã€‚  å½“è¡¨åªæœ‰ä¸€ä¸ªå­—æ®µï¼Œcount(*) æœ€å¿«ã€‚</em></li></ul><hr id="3bd0e101-c81a-45fb-bdd5-e65eef93c32d"/><h2 id="56e5520e-c1d9-4d32-a21a-784d9f1ec5be" class="">æ—¶é—´å‡½æ•°</h2><div id="14a47101-4a4b-4f69-9585-2df51f317e2b" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>å‡½æ•°å</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>å®šä¹‰</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>è¯­å¥</th></tr></thead><tbody><tr id="fa9c2954-5f76-489b-b6f0-85b9904d9f58"><td class="cell-title"><a href="https://www.notion.so/NOW-fa9c29545f76489bb6f085b9904d9f58">NOW ( )</a></td><td class="cell-&quot;(vU">å½“å‰æ—¶é—´</td><td class="cell--L)a">select now()</td></tr><tr id="8811cd8a-e608-4b67-9978-283555454f7f"><td class="cell-title"><a href="https://www.notion.so/extract-8811cd8ae6084b679978283555454f7f">extract()</a></td><td class="cell-&quot;(vU">æŠ½å–å…·ä½“çš„å¹´ã€æœˆã€æ—¥</td><td class="cell--L)a"></td></tr><tr id="646bc772-2e34-4dec-bbde-6f1d02de7c01"><td class="cell-title"><a href="https://www.notion.so/date-646bc7722e344decbbde6f1d02de7c01">date()</a></td><td class="cell-&quot;(vU">è¿”å›æ—¶é—´çš„æ—¥æœŸéƒ¨åˆ†</td><td class="cell--L)a"></td></tr><tr id="c867dd49-64f1-4010-86d0-c3a84a63f40e"><td class="cell-title"><a href="https://www.notion.so/year-c867dd4964f1401086d0c3a84a63f40e">year()</a></td><td class="cell-&quot;(vU">è¿”å›æ—¶é—´çš„å¹´ä»½</td><td class="cell--L)a"></td></tr><tr id="7541b2b3-ac59-4098-ad64-8c23a96a2f1b"><td class="cell-title"><a href="https://www.notion.so/month-7541b2b3ac594098ad648c23a96a2f1b">month()</a></td><td class="cell-&quot;(vU">è¿”å›æ—¶é—´çš„æœˆä»½</td><td class="cell--L)a"></td></tr><tr id="f1b7755e-3c53-4943-8f38-6c88abd671f7"><td class="cell-title"><a href="https://www.notion.so/day-f1b7755e3c5349438f386c88abd671f7">day()</a></td><td class="cell-&quot;(vU">è¿”å›æ—¥æœŸçš„å¤©</td><td class="cell--L)a"></td></tr><tr id="b9f65f20-25b7-4642-bc73-63aec6a9c7f2"><td class="cell-title"><a href="https://www.notion.so/hour-b9f65f2025b74642bc7363aec6a9c7f2">hour()</a></td><td class="cell-&quot;(vU">è¿”å›æ—¶é—´çš„å°æ—¶</td><td class="cell--L)a"></td></tr><tr id="1769aa3c-a0d7-436a-a53e-a1b6eaeddb01"><td class="cell-title"><a href="https://www.notion.so/minute-1769aa3ca0d7436aa53ea1b6eaeddb01">minute()</a></td><td class="cell-&quot;(vU">è¿”å›æ—¶é—´çš„åˆ†é’Ÿ</td><td class="cell--L)a"></td></tr><tr id="bfbf0fc8-3587-4662-a85d-eb7aeb9ba434"><td class="cell-title"><a href="https://www.notion.so/second-bfbf0fc835874662a85deb7aeb9ba434">second()</a></td><td class="cell-&quot;(vU">è¿”å›æ—¶é—´çš„ç§’</td><td class="cell--L)a"></td></tr><tr id="a4c9a78b-4435-446b-a278-8cc106c8242f"><td class="cell-title"><a href="https://www.notion.so/week-a4c9a78b4435446ba2788cc106c8242f">week ()</a></td><td class="cell-&quot;(vU">ç¬¬å‡ å‘¨</td><td class="cell--L)a"></td></tr><tr id="dbb15e83-1994-4095-ad67-baf6678fee15"><td class="cell-title"><a href="https://www.notion.so/dayofweek-dbb15e8319944095ad67baf6678fee15">dayofweek()</a></td><td class="cell-&quot;(vU">è¿”å›æ˜ŸæœŸå‡ ï¼Œ1ä¸ºæ˜ŸæœŸå¤©</td><td class="cell--L)a"></td></tr><tr id="2121c53f-401f-4058-ae7c-907777eb0204"><td class="cell-title"><a href="https://www.notion.so/dayofyear-2121c53f401f4058ae7c907777eb0204">dayofyear()</a></td><td class="cell-&quot;(vU">ä¸€å¹´ä¸­çš„ç¬¬å‡ å¤©</td><td class="cell--L)a"></td></tr><tr id="6cb44eb6-2f27-41db-bae3-c1b813b9c32b"><td class="cell-title"><a href="https://www.notion.so/sec_to_time-6cb44eb62f2741dbbae3c1b813b9c32b">sec_to_time ( )</a></td><td class="cell-&quot;(vU">ç§’æ•°è½¬æˆæ—¶é—´</td><td class="cell--L)a"></td></tr><tr id="88310f7a-4b98-446e-bf83-98a590e71e9b"><td class="cell-title"><a href="https://www.notion.so/date_add-88310f7a4b98446ebf8398a590e71e9b">date_add()</a></td><td class="cell-&quot;(vU">æ—¶é—´ç›¸åŠ </td><td class="cell--L)a">date_add(dt,interval 1 day )</td></tr><tr id="1d21af55-238c-45ac-8601-d14b928572ca"><td class="cell-title"><a href="https://www.notion.so/date_sub-date-INTERVAL-expr-type-1d21af55238c45ac8601d14b928572ca">date_sub(date,INTERVAL exprï¼ˆæ—¶é—´é—´éš”ï¼‰ typeï¼ˆæ—¶é—´ç±»å‹ï¼Œå¤©ã€æœˆã€å¹´ï¼‰)</a></td><td class="cell-&quot;(vU">æ—¶é—´ç›¸å‡</td><td class="cell--L)a">date_sub(â€˜2018-05-01â€™,interval -1 year)</td></tr><tr id="9e5e6a35-632f-4f5e-b777-bb9dd5ac295d"><td class="cell-title"><a href="https://www.notion.so/datediff-9e5e6a35632f4f5eb777bb9dd5ac295d">datediff()</a></td><td class="cell-&quot;(vU">æ—¶é—´çš„å·®å€¼</td><td class="cell--L)a"></td></tr><tr id="1fa03eef-3a50-49da-8e11-57dc4264ddb2"><td class="cell-title"><a href="https://www.notion.so/date_format-1fa03eef3a5049da8e1157dc4264ddb2">date_format()</a></td><td class="cell-&quot;(vU">è¾“å‡ºæŒ‡å®šæ—¶é—´æ ¼å¼</td><td class="cell--L)a">date_format(hit_date, &quot;%Y-%m-%d)</td></tr><tr id="716856b2-fe94-48f2-a8ef-f2d031f2f62d"><td class="cell-title"><a href="https://www.notion.so/datename-716856b2fe9448f2a8eff2d031f2f62d">datename()</a></td><td class="cell-&quot;(vU">è¿”å›æ—¥æœŸéƒ¨åˆ†çš„å‚æ•°</td><td class="cell--L)a"></td></tr><tr id="924c8661-0fee-451b-bcb1-a26bf54331af"><td class="cell-title"><a href="https://www.notion.so/datepart-924c86610fee451bbcb1a26bf54331af">datepart()</a></td><td class="cell-&quot;(vU">è¿”å›æ—¥æœŸã€æ—¶é—´çš„å•ç‹¬éƒ¨åˆ†</td><td class="cell--L)a"></td></tr><tr id="7487be3c-17cb-49bc-8142-2c4202eca276"><td class="cell-title"><a href="https://www.notion.so/ceil-X-7487be3c17cb49bc81422c4202eca276">ceil(X)</a></td><td class="cell-&quot;(vU">è¿”å›çš„æœ€å°æ•´æ•°å€¼ä¸å°äºX</td><td class="cell--L)a">ceil(3.6)              è¿”å›4</td></tr><tr id="bdd9fdb5-2bc4-4de1-b291-b58f7619e354"><td class="cell-title"><a href="https://www.notion.so/ceiling-X-bdd9fdb52bc44de1b291b58f7619e354">ceiling(X)</a></td><td class="cell-&quot;(vU">è¿”å›çš„æœ€å°æ•´æ•°å€¼ä¸å°äºX</td><td class="cell--L)a">ceiling(-6.2) è¿”å›å€¼ -6</td></tr><tr id="2f3ad80e-4aa1-4518-96c1-62998491a171"><td class="cell-title"><a href="https://www.notion.so/to_date-string-date-2f3ad80e4aa1451896c162998491a171">to_date(string date)</a></td><td class="cell-&quot;(vU">è¿”å›æ—¶é—´å­—æ®µä¸­çš„æ—¥æœŸéƒ¨åˆ†</td><td class="cell--L)a">to_date(â€˜2016-06-01 00:00:00â€™)  è¿”å›å€¼ï¼š2016-06-01</td></tr></tbody></table></div><h3 id="104d687d-2f9b-46a8-ae0c-ec71d176b804" class="">æ±‚ç•™å­˜ç‡</h3><ul id="dea34777-9e24-4b72-b84d-becc325ded68" class="bulleted-list"><li>datediff-æ±‚ç•™å­˜ç‡</li></ul><pre id="6f220ed7-3787-47f2-bc18-b7b061b6be03" class="code"><code>---ä¸€æ¬¡æ€§æ±‚æ¬¡1æ—¥ï¼Œæ¬¡3æ—¥ï¼Œ æ¬¡7æ—¥ç•™å­˜ï¼Œæ­¤æ–¹æ³•ä¸èƒ½è®¡ç®—pvï¼Œä¼šé€ æˆç¬›å¡å°”ç§¯
with a1 as (select 
    hit_date,
    user_account
from 
    computer_view.data
where 
    hit_date between &#x27;2019-04-25&#x27; and &#x27;2019-05-13&#x27;
    and 
    btn_information is not null),
a2 as (select 
    hit_date,
    user_account
from 
    computer_view.data
where 
    hit_date between &#x27;2019-04-25&#x27; and &#x27;2019-05-13&#x27;
    and 
    btn_information is not null)
select 
a1.hit_date,
count(distinct a1.user_account) uv,
count(distinct case when datediff(a2.hit_date, a1.hit_date) = 1 then a1.user_account else null end ) next_day,
count(distinct case when datediff(a2.hit_date, a1.hit_date) = 3 then a1.user_account else null end ) three_day,
count(distinct case when datediff(a2.hit_date, a1.hit_date) = 7 then a1.user_account else null end ) seven_day
from a1 join a2 on a1.user_account = a2.user_account
group by a1.hit_date
order by a1.hit_date
limit 100</code></pre><p id="03f88d92-2358-4301-973a-78d8601792be" class="">
</p><ul id="b3eca01b-8e22-4e93-b247-ca92208b1ec4" class="bulleted-list"><li>date_add æ±‚ç•™å­˜ç‡</li></ul><pre id="7406667e-bfe4-4104-89d2-1374d1a4312d" class="code"><code>---æ­¥éª¤1ï¼šç»Ÿè®¡æ¯å¤©çš„uv

---æ­¥éª¤2ï¼š - ç»Ÿè®¡10-15å·æ¯å¤©çš„æ¬¡æ—¥ç•™å­˜æ•°ï¼Œ ç»Ÿè®¡æ¬¡3ã€7æ—¥ç•™å­˜åªéœ€å°†1æ¢ä¸º3ã€7
with a1 as (
    select 
        user_account,
        hit_date
    from 
        computer_view.data
    where 
        hit_date between  &#x27;2018-11-10&#x27; and &#x27;2018-11-15&#x27;
),
a2 as (
        select 
        user_account,
        hit_date
    from 
        computer_view.data
    where 
        hit_date between &#x27;2018-11-10&#x27; and &#x27;2018-11-25&#x27;
)
select 
    a1.hit_date,
    count(distinct a1.user_account) as uv
from
    a1 join a2 on a1.user_account = a2.user_account
WHERE   
    a2.hit_date =  date_add(a1.hit_date, 1) 
group by 
    a1.hit_date
order BY
    a1.hit_date

--æ­¥éª¤3ï¼šè®¡ç®—ç•™å­˜ç‡</code></pre><ul id="52944890-827e-468f-b008-bfb68c081184" class="bulleted-list"><li>è®¡ç®—ç•™å­˜ç‡çš„å…¶ä»–å†™æ³•-è¿·ç¥</li></ul><pre id="bb67b470-911d-48bb-98b6-a3e9a1587d8b" class="code"><code>-- ç•™å­˜sqlä¼˜åŒ–
select count(1)
from(
    select userid, count(1)
    from(
        select t1.userid,
                t1.statdate
        from
            table1 t1
        where
            t1.statdate = ${ä¸Š30å¤©æ—¥æœŸ}
            and t1.statdate &lt;= ${ä¸Šä¸€å¤©æ—¥æœŸ}
        group by
            t1.userid,
            t1.statdate
        ) s1
    group by
        userid
    having
        count(1)  2
    ) R1

--æ­¤sqlä¸ºä¸€ä¸ªæ ·ä¾‹ï¼Œè®¡ç®—è¿ç»­è·Ÿä»»æ„éƒ½é€‚ç”¨ï¼Œè‡³äºè®¡ç®—ç¬¬Nå¤©ï¼Œåªéœ€è¦æ›´æ”¹ä¸‹æ—¥æœŸè¿‡æ»¤æ¡ä»¶ï¼Œå˜æˆ=$[ä¸ŠNå¤©æ—¥æœŸ]ï¼Œ=${ä¸Šä¸€å¤©æ—¥æœŸ}ã€‚ 
--å¦å¤–ï¼Œè¿™ç§æ–¹å¼é€‚åˆè·‘å½“å‰å‘¨æœŸæ•°æ®ï¼Œå¦‚æœè·‘å†å²æ•°æ®ï¼Œå¯ä»¥å†™ä¸ªå¾ªç¯ã€‚å½“ç„¶ï¼Œæœ€æš´åŠ›è¿˜æ˜¯ç›´æ¥ç”¨userid å…³è”ã€‚

--è¿™ç§å†™æ³•ï¼Œæ›´å¤šæ˜¯é’ˆå¯¹ç°åœ¨å¤§éƒ¨åˆ†åˆ†å¸ƒå¼å¤„ç†å¹³å°çš„ç‰¹æ€§ï¼Œå°½å¯èƒ½å°†æ•°æ®åˆç†å‡åŒ€åˆ†ç‰‡ï¼Œæ¯å°æœåŠ¡å™¨å„è‡ªè¿ç®—è‡ªå·±çš„ï¼Œæœ€åæ±‡æ€»ã€‚ å°½å¯èƒ½å°‘ç”¨ count distinct è¿™ç§å†™æ³•ï¼Œå› ä¸ºæ— æ³•åˆ©ç”¨åˆ†ç‰‡çš„ç‰¹æ€§ã€‚</code></pre><ul id="dfd60f8d-6492-46a6-a13d-d538063a1532" class="bulleted-list"><li>ç•™å­˜ç‡çš„å¦ä¸€ç§å†™æ³•-å‹‡å“¥</li></ul><pre id="95e5ea12-99ab-4855-8cfd-f0a96de0eb57" class="code"><code>with a1 as (
select
	hit_date,
	user_account,
	count(1) as hit_count
from 
	apache_computer_view.client_android_log
WHERE 
	hit_date between &#x27;2020-04-01&#x27; and  &#x27;2020-04-07&#x27;
	and
	btn_navigation  like &quot;%æŸ¥è¯¢åŠç†%&quot;
group by
    1,2
),
a2 as (
select
	hit_date,
    user_account,
    count(1) as hit_count
from 
	apache_computer_view.client_android_log
WHERE
	hit_date between &#x27;2020-04-01&#x27; and  &#x27;2020-04-07&#x27;
	and
	btn_navigation  like &quot;%æŸ¥è¯¢åŠç†%&quot;
group by
    1,2
)
select 
	a1.hit_date as one,
	a2.hit_date as two,
	datediff(a2.hit_date, a1.hit_date) as cha,
	count(distinct a2.user_account),
	sum(a2.hit_count)
from
    a1 left join a2 on a1.user_account = a2.user_account
group by
    1,2
having
    cha &gt; 0
order by
    1,2</code></pre><ul id="0a32573e-01d6-4f1b-814a-5cf9df5b19e6" class="bulleted-list"><li>è®¡ç®—æœˆç•™å­˜ç‡çš„ç®€å•å†™æ³•ï¼šç­›é€‰å‡ºåœ¨ä¸¤ä¸ªæœˆä»½å‡ºç°çš„ç”¨æˆ·</li></ul><pre id="5ce02f8a-25d5-4b9d-b0eb-b9615eb54847" class="code"><code>with a1 as (select 
    user_account,
    count(distinct month (hit_date)) as c
from 
    apache_computer_view.client_android_log 
where 
     hit_date between &#x27;2019-03-01&#x27; and &#x27;2019-04-31&#x27;
group by 
 user_account
having 
  c = 2
union 
select 
    user_account,
    count(distinct month (hit_date)) as c
from 
    apache_computer_view.client_ios_log 
where 
     hit_date between &#x27;2019-03-01&#x27; and &#x27;2019-04-31&#x27;
group by 
 user_account
having 
  c = 2
    )
select 
count(distinct user_account) as uv 
from 
a1</code></pre><h2 id="7d22de64-7e41-4d4a-ac4a-26c7cba12e1c" class="">æ¡ä»¶åˆ¤æ–­ï¼šcase when ä¸ if</h2><ol id="7354f8c2-e0dd-4641-881b-824f9996c646" class="numbered-list" start="1"><li><strong>IF( expr , v1 , v2 )å‡½æ•°</strong></li></ol><ul id="484e8b92-1fc3-480f-b6f1-46bdf923c327" class="bulleted-list"><li>æŸ¥å‡ºç­çº§æ‰€æœ‰å­¦ç”Ÿï¼Œå¦‚æœå¹´é¾„å°äº20ï¼Œå°±æ ‡å‡†ä¸ºå°‘å¹´ï¼Œå¦åˆ™æ ‡è®°ä¸ºé’å¹´ã€‚</li></ul><pre id="19a9b5c1-731e-440c-a368-dfa2ec056dfc" class="code"><code>select 
    * 
     if(age&lt;20,&#x27;å°‘å¹´&#x27;,&#x27;é’å¹´&#x27;) AS ifage 
from  
    student</code></pre><ol id="267c4693-a7e9-4842-8d51-cf7d8b2c363f" class="numbered-list" start="1"><li><strong>ifnull(V1,V2)å‡½æ•°</strong></li></ol><ul id="033e2372-1e6b-40a7-a9bf-5522a409c7b3" class="bulleted-list"><li>å¦‚æœv1ä¸ä¸ºç©ºï¼Œåˆ™ç›´æ¥è¿”å›v1;å¦‚æœv1ä¸ºç©ºï¼Œåˆ™è¿”å›å‚æ•°v2</li></ul><pre id="16a393c4-5701-4b20-ac55-77d9e1cbddd2" class="code"><code>select
    ifnull(1,2),
    ifnull(null,10);</code></pre><ol id="e3bd8fff-3492-4bbd-be06-1ac86c6e067a" class="numbered-list" start="1"><li><strong>case when å‡½æ•°</strong></li></ol><ul id="cbcd1a19-c19f-4f21-972c-cfa13398a6f5" class="bulleted-list"><li>å¯¹ä¸åŒå­—æ¯è¿›è¡Œçœä»½è½¬æ¢</li></ul><pre id="ac68632c-8e78-4018-a4f6-87e83b478fa3" class="code"><code>select
case 
        when province like &#x27;ah&#x27; then &#x27;å®‰å¾½&#x27;
        when province like &#x27;fj&#x27; then &#x27;ç¦å»º&#x27;
        when province like &#x27;gd&#x27; then &#x27;å¹¿ä¸œ&#x27;
    else &#x27;m&#x27; 
    end as province ,
    count(distinct user_account) uv,
    count(page_name) pv
from android_log
where hit_date between &#x27;{}&#x27; and &#x27;{}&#x27;
and page_name like &#x27;%Kefujh%&#x27;
group by case 
        when province like &#x27;ah&#x27; then &#x27;å®‰å¾½&#x27;
        when province like &#x27;fj&#x27; then &#x27;ç¦å»º&#x27;
        when province like &#x27;gd&#x27; then &#x27;å¹¿ä¸œ&#x27;
    else &#x27;m&#x27; 
    end 
order by case 
        when province like &#x27;ah&#x27; then &#x27;å®‰å¾½&#x27;
        when province like &#x27;fj&#x27; then &#x27;ç¦å»º&#x27;
        when province like &#x27;gd&#x27; then &#x27;å¹¿ä¸œ&#x27;
    else &#x27;m&#x27; 
    end 
limit 1000</code></pre><p id="5fba34c2-870f-4847-a85d-07c7a9290214" class="">
</p><ul id="6ecfd968-73d6-4b46-98f5-0bc4289c87d4" class="bulleted-list"><li>ç»Ÿè®¡å„éƒ¨é—¨ç”·å¥³åˆ†åˆ«æœ‰å¤šå°‘äºº</li></ul><div id="9b866f26-284c-4b7b-a459-2497f75c1c75" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>å§“å</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesSelect"><path d="M7,13 C10.31348,13 13,10.31371 13,7 C13,3.68629 10.31348,1 7,1 C3.68652,1 1,3.68629 1,7 C1,10.31371 3.68652,13 7,13 Z M3.75098,5.32278 C3.64893,5.19142 3.74268,5 3.90869,5 L10.09131,5 C10.25732,5 10.35107,5.19142 10.24902,5.32278 L7.15771,9.29703 C7.07764,9.39998 6.92236,9.39998 6.84229,9.29703 L3.75098,5.32278 Z"></path></svg></span>æ€§åˆ«</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>éƒ¨é—¨</th></tr></thead><tbody><tr id="ab37d4e3-d066-4782-a2ae-7b7cdef37825"><td class="cell-title"><a href="https://www.notion.so/ab37d4e3d0664782a2ae7b7cdef37825">ç”²</a></td><td class="cell-NXwj"><span class="selected-value select-value-color-blue">ç”·</span></td><td class="cell-xr6c">A</td></tr><tr id="416aeb0f-81c2-43c1-8801-79f2167eb832"><td class="cell-title"><a href="https://www.notion.so/416aeb0f81c243c1880179f2167eb832">ä¹™</a></td><td class="cell-NXwj"><span class="selected-value select-value-color-blue">ç”·</span></td><td class="cell-xr6c">A</td></tr><tr id="cfd51cc1-65fa-4be0-aa48-6d11e90a8d48"><td class="cell-title"><a href="https://www.notion.so/cfd51cc165fa4be0aa486d11e90a8d48">ä¸™</a></td><td class="cell-NXwj"><span class="selected-value select-value-color-default">å¥³</span></td><td class="cell-xr6c">B</td></tr><tr id="e3cfdc80-7c7c-4352-9663-2e7d91e0d8d9"><td class="cell-title"><a href="https://www.notion.so/e3cfdc807c7c435296632e7d91e0d8d9">ä¸</a></td><td class="cell-NXwj"><span class="selected-value select-value-color-default">å¥³</span></td><td class="cell-xr6c">A</td></tr><tr id="61c2079f-0128-469f-b49a-074e37c26238"><td class="cell-title"><a href="https://www.notion.so/61c2079f0128469fb49a074e37c26238">å¼ </a></td><td class="cell-NXwj"><span class="selected-value select-value-color-blue">ç”·</span></td><td class="cell-xr6c">B</td></tr><tr id="f42db122-5730-44cd-8733-14aba8044ebe"><td class="cell-title"><a href="https://www.notion.so/f42db122573044cd873314aba8044ebe">èµµ</a></td><td class="cell-NXwj"><span class="selected-value select-value-color-default">å¥³</span></td><td class="cell-xr6c">B</td></tr></tbody></table></div><pre id="21fc5822-126b-49c8-b47d-973e2f296f37" class="code"><code>select 
&#x27;éƒ¨é—¨&#x27;,
sum( case when æ€§åˆ« = &#x27;ç”·&#x27; then 1  else null end ) as &#x27;ç”·&#x27;,
sum( case when æ€§åˆ« = &#x27;å¥³&#x27; then 1 else null end ) as  &#x27;å¥³&#x27;
from 
table 
group by 
&#x27;éƒ¨é—¨&#x27;</code></pre><ul id="9d9c56ce-7ded-4dfd-9ada-1736fdcf198f" class="bulleted-list"><li>èŒƒå›´è½¬æ¢</li></ul><pre id="3cbf8d07-50c7-40b5-b0f2-c12498653737" class="code"><code>select 
case when population &lt; 250 then &#x27;1&#x27; 
			when population  = 250 and  population &lt; 500 then &#x27;2&#x27;
else null end  as pop_class,
count(*) as cntfrom 
from pop </code></pre><pre id="ac4709a7-3e47-480c-854c-b7457ecba103" class="code"><code>select 
 case when dt = 3 then &#x27;ç¬¬ä¸€å­£åº¦&#x27; 
    when  dt = 6 then  &#x27;ç¬¬äºŒå­£åº¦&#x27;  
    when dt in (1,2,4,5)  then &#x27;å…¶ä»–&#x27; 
    else null 
    end as dt ,
sales,
sum(sales) over (order by dt  rows between 2 preceding and current row   )  as a1
from 
(
select 
count(  user_account) as sales,
month(hit_date)  as dt 
from 
apache_computer_view.client_android_log 
where 
hit_date between &#x27;2019-01-01&#x27; and &#x27;2019-06-31&#x27;
group by 
month(hit_date ))
group by 
 case when dt = 3 then &#x27;ç¬¬ä¸€å­£åº¦&#x27; 
    when  dt = 6 then  &#x27;ç¬¬äºŒå­£åº¦&#x27;  
    when dt in (1,2,4,5)  then &#x27;å…¶ä»–&#x27; 
    else null 
    end,sales</code></pre><hr id="725e130b-66b4-4af6-850e-871782620462"/><h2 id="1e49c007-b722-4f18-8298-bb9a733424b4" class="">è¡Œè½¬åˆ—</h2><ol id="15da9c75-1083-4ea9-8e48-80529139062e" class="numbered-list" start="1"><li>å‡½æ•°</li></ol><ul id="509dc8af-3a61-467d-812b-94bf13575259" class="bulleted-list"><li><mark class="highlight-gray_background"><strong>case when</strong></mark></li></ul><ul id="c145258c-c2a0-4f24-8949-6862274bd826" class="bulleted-list"><li><mark class="highlight-gray_background"><strong>concat</strong></mark>(å­—ç¬¦1, å­—ç¬¦2â€¦) ï¼šå‡½æ•°åœ¨è¿æ¥å­—ç¬¦ä¸²æ—¶ï¼Œåªè¦å…¶ä¸­ä¸€ä¸ªæ˜¯NUllï¼Œåˆ™è¿”å›NUll</li></ul><ul id="5f72ca79-f672-40ac-b180-aee10f9994b5" class="bulleted-list"><li><mark class="highlight-gray_background"><strong>concat_ws</strong></mark>(åˆ†éš”ç¬¦, å­—ç¬¦1, å­—ç¬¦2,â€¦): å‡½æ•°éœ€è¦æŒ‡å®šåˆ†éš”ç¬¦ï¼Œåªèƒ½æ¥æ”¶ stringæˆ–stringç±»å‹çš„æ•°ç»„ï¼Œåªè¦æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²ä¸æ˜¯NUllï¼Œ åˆ™ä¸ä¼šè¿”å›NULLã€‚</li></ul><ul id="4bb176fb-f83f-46b4-a459-07f9678ead91" class="bulleted-list"><li><mark class="highlight-gray_background"><strong>collect_set</strong></mark>(col): å‡½æ•°å€¼æ¥å—åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¸»è¦ä½œç”¨æ˜¯å°†æŸå­—æ®µçš„å€¼è¿›è¡Œå»é‡æ±‡æ€»ï¼Œäº§ç”Ÿarrayç±»å‹å­—æ®µã€‚</li></ul><ol id="38e9429e-f35b-4838-bde6-16ad0e81ecf9" class="numbered-list" start="1"><li>æ¡ˆä¾‹</li></ol><ul id="652dc72a-c9f3-45a3-aaf8-54703f144677" class="bulleted-list"><li>å¤šè¡Œè½¬å¤šåˆ—</li></ul><div id="3be2808d-4674-4e2b-917a-69f302de1ebd" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesNumber"><path d="M4.46191,0 C3.8667,0 3.38428,0.482422 3.38428,1.07751 L3.38428,3.38425 L1.07764,3.38425 C0.482422,3.38425 0,3.86667 0,4.46179 C0,5.05688 0.482422,5.53931 1.07764,5.53931 L3.38428,5.53931 L3.38428,8.46063 L1.07764,8.46063 C0.482422,8.46063 0,8.94308 0,9.53818 C0,10.1333 0.482422,10.6157 1.07764,10.6157 L3.38428,10.6157 L3.38428,12.9224 C3.38428,13.5175 3.8667,13.9999 4.46191,13.9999 C5.05664,13.9999 5.53906,13.5175 5.53906,12.9224 L5.53906,10.6157 L8.46045,10.6157 L8.46045,12.9224 C8.46045,13.5175 8.94287,13.9999 9.53809,13.9999 C10.1333,13.9999 10.6157,13.5175 10.6157,12.9224 L10.6157,10.6157 L12.9224,10.6157 C13.5176,10.6157 14,10.1333 14,9.53818 C14,8.94308 13.5176,8.46063 12.9224,8.46063 L10.6157,8.46063 L10.6157,5.53931 L12.9224,5.53931 C13.5176,5.53931 14,5.05688 14,4.46179 C14,3.86667 13.5176,3.38425 12.9224,3.38425 L10.6157,3.38425 L10.6157,1.07751 C10.6157,0.482422 10.1333,0 9.53809,0 C8.94287,0 8.46045,0.482422 8.46045,1.07751 L8.46045,3.38425 L5.53906,3.38425 L5.53906,1.07751 C5.53906,0.482422 5.05664,0 4.46191,0 Z M5.53906,8.46063 L5.53906,5.53931 L8.46045,5.53931 L8.46045,8.46063 L5.53906,8.46063 Z"></path></svg></span>å¹´</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesNumber"><path d="M4.46191,0 C3.8667,0 3.38428,0.482422 3.38428,1.07751 L3.38428,3.38425 L1.07764,3.38425 C0.482422,3.38425 0,3.86667 0,4.46179 C0,5.05688 0.482422,5.53931 1.07764,5.53931 L3.38428,5.53931 L3.38428,8.46063 L1.07764,8.46063 C0.482422,8.46063 0,8.94308 0,9.53818 C0,10.1333 0.482422,10.6157 1.07764,10.6157 L3.38428,10.6157 L3.38428,12.9224 C3.38428,13.5175 3.8667,13.9999 4.46191,13.9999 C5.05664,13.9999 5.53906,13.5175 5.53906,12.9224 L5.53906,10.6157 L8.46045,10.6157 L8.46045,12.9224 C8.46045,13.5175 8.94287,13.9999 9.53809,13.9999 C10.1333,13.9999 10.6157,13.5175 10.6157,12.9224 L10.6157,10.6157 L12.9224,10.6157 C13.5176,10.6157 14,10.1333 14,9.53818 C14,8.94308 13.5176,8.46063 12.9224,8.46063 L10.6157,8.46063 L10.6157,5.53931 L12.9224,5.53931 C13.5176,5.53931 14,5.05688 14,4.46179 C14,3.86667 13.5176,3.38425 12.9224,3.38425 L10.6157,3.38425 L10.6157,1.07751 C10.6157,0.482422 10.1333,0 9.53809,0 C8.94287,0 8.46045,0.482422 8.46045,1.07751 L8.46045,3.38425 L5.53906,3.38425 L5.53906,1.07751 C5.53906,0.482422 5.05664,0 4.46191,0 Z M5.53906,8.46063 L5.53906,5.53931 L8.46045,5.53931 L8.46045,8.46063 L5.53906,8.46063 Z"></path></svg></span>å­£åº¦</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesNumber"><path d="M4.46191,0 C3.8667,0 3.38428,0.482422 3.38428,1.07751 L3.38428,3.38425 L1.07764,3.38425 C0.482422,3.38425 0,3.86667 0,4.46179 C0,5.05688 0.482422,5.53931 1.07764,5.53931 L3.38428,5.53931 L3.38428,8.46063 L1.07764,8.46063 C0.482422,8.46063 0,8.94308 0,9.53818 C0,10.1333 0.482422,10.6157 1.07764,10.6157 L3.38428,10.6157 L3.38428,12.9224 C3.38428,13.5175 3.8667,13.9999 4.46191,13.9999 C5.05664,13.9999 5.53906,13.5175 5.53906,12.9224 L5.53906,10.6157 L8.46045,10.6157 L8.46045,12.9224 C8.46045,13.5175 8.94287,13.9999 9.53809,13.9999 C10.1333,13.9999 10.6157,13.5175 10.6157,12.9224 L10.6157,10.6157 L12.9224,10.6157 C13.5176,10.6157 14,10.1333 14,9.53818 C14,8.94308 13.5176,8.46063 12.9224,8.46063 L10.6157,8.46063 L10.6157,5.53931 L12.9224,5.53931 C13.5176,5.53931 14,5.05688 14,4.46179 C14,3.86667 13.5176,3.38425 12.9224,3.38425 L10.6157,3.38425 L10.6157,1.07751 C10.6157,0.482422 10.1333,0 9.53809,0 C8.94287,0 8.46045,0.482422 8.46045,1.07751 L8.46045,3.38425 L5.53906,3.38425 L5.53906,1.07751 C5.53906,0.482422 5.05664,0 4.46191,0 Z M5.53906,8.46063 L5.53906,5.53931 L8.46045,5.53931 L8.46045,8.46063 L5.53906,8.46063 Z"></path></svg></span>é”€å”®é‡</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>Title</th></tr></thead><tbody><tr id="3316d7f7-d268-485a-9907-41c84d1851f4"><td class="cell-&#x27;&gt;D5">1991</td><td class="cell-jEOs">1</td><td class="cell-QB;F">11</td><td class="cell-title"><a href="https://www.notion.so/3316d7f7d268485a990741c84d1851f4">Untitled</a></td></tr><tr id="439d6bc4-7f5d-45b5-9a97-ae989d072ac6"><td class="cell-&#x27;&gt;D5">1991</td><td class="cell-jEOs">2</td><td class="cell-QB;F">12</td><td class="cell-title"><a href="https://www.notion.so/439d6bc47f5d45b59a97ae989d072ac6">Untitled</a></td></tr><tr id="93a96807-be0c-43d5-8fb1-6deeb218d452"><td class="cell-&#x27;&gt;D5">1991</td><td class="cell-jEOs">3</td><td class="cell-QB;F">13</td><td class="cell-title"><a href="https://www.notion.so/93a96807be0c43d58fb16deeb218d452">Untitled</a></td></tr><tr id="3ba334f9-29c2-4dd3-8b3a-b1b600689489"><td class="cell-&#x27;&gt;D5">1991</td><td class="cell-jEOs">4</td><td class="cell-QB;F">14</td><td class="cell-title"><a href="https://www.notion.so/3ba334f929c24dd38b3ab1b600689489">Untitled</a></td></tr><tr id="bb38f0af-0d7b-4fb6-bf5b-d5f705a2eaba"><td class="cell-&#x27;&gt;D5">1992</td><td class="cell-jEOs">1</td><td class="cell-QB;F">21</td><td class="cell-title"><a href="https://www.notion.so/bb38f0af0d7b4fb6bf5bd5f705a2eaba">Untitled</a></td></tr><tr id="df452bbd-2d4e-4036-b26b-90fc8ba7e132"><td class="cell-&#x27;&gt;D5">1992</td><td class="cell-jEOs">2</td><td class="cell-QB;F">22</td><td class="cell-title"><a href="https://www.notion.so/df452bbd2d4e4036b26b90fc8ba7e132">Untitled</a></td></tr><tr id="5e1bd94c-32b0-4690-8174-5c69a9a1c790"><td class="cell-&#x27;&gt;D5">1992</td><td class="cell-jEOs">3</td><td class="cell-QB;F">23</td><td class="cell-title"><a href="https://www.notion.so/5e1bd94c32b0469081745c69a9a1c790">Untitled</a></td></tr><tr id="a1aa5fa7-e64f-4033-90d7-2b0fd66d8144"><td class="cell-&#x27;&gt;D5">1992</td><td class="cell-jEOs">4</td><td class="cell-QB;F">24</td><td class="cell-title"><a href="https://www.notion.so/a1aa5fa7e64f403390d72b0fd66d8144">Untitled</a></td></tr></tbody></table></div><p id="aaaaaa97-1b9d-48d2-93c5-7635b9419409" class="">æŸ¥è¯¢ç»“æœå¦‚ä¸‹ï¼š</p><div id="ed9dc647-bf53-4c56-aee4-f6eed8c3db34" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesNumber"><path d="M4.46191,0 C3.8667,0 3.38428,0.482422 3.38428,1.07751 L3.38428,3.38425 L1.07764,3.38425 C0.482422,3.38425 0,3.86667 0,4.46179 C0,5.05688 0.482422,5.53931 1.07764,5.53931 L3.38428,5.53931 L3.38428,8.46063 L1.07764,8.46063 C0.482422,8.46063 0,8.94308 0,9.53818 C0,10.1333 0.482422,10.6157 1.07764,10.6157 L3.38428,10.6157 L3.38428,12.9224 C3.38428,13.5175 3.8667,13.9999 4.46191,13.9999 C5.05664,13.9999 5.53906,13.5175 5.53906,12.9224 L5.53906,10.6157 L8.46045,10.6157 L8.46045,12.9224 C8.46045,13.5175 8.94287,13.9999 9.53809,13.9999 C10.1333,13.9999 10.6157,13.5175 10.6157,12.9224 L10.6157,10.6157 L12.9224,10.6157 C13.5176,10.6157 14,10.1333 14,9.53818 C14,8.94308 13.5176,8.46063 12.9224,8.46063 L10.6157,8.46063 L10.6157,5.53931 L12.9224,5.53931 C13.5176,5.53931 14,5.05688 14,4.46179 C14,3.86667 13.5176,3.38425 12.9224,3.38425 L10.6157,3.38425 L10.6157,1.07751 C10.6157,0.482422 10.1333,0 9.53809,0 C8.94287,0 8.46045,0.482422 8.46045,1.07751 L8.46045,3.38425 L5.53906,3.38425 L5.53906,1.07751 C5.53906,0.482422 5.05664,0 4.46191,0 Z M5.53906,8.46063 L5.53906,5.53931 L8.46045,5.53931 L8.46045,8.46063 L5.53906,8.46063 Z"></path></svg></span>å¹´</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesNumber"><path d="M4.46191,0 C3.8667,0 3.38428,0.482422 3.38428,1.07751 L3.38428,3.38425 L1.07764,3.38425 C0.482422,3.38425 0,3.86667 0,4.46179 C0,5.05688 0.482422,5.53931 1.07764,5.53931 L3.38428,5.53931 L3.38428,8.46063 L1.07764,8.46063 C0.482422,8.46063 0,8.94308 0,9.53818 C0,10.1333 0.482422,10.6157 1.07764,10.6157 L3.38428,10.6157 L3.38428,12.9224 C3.38428,13.5175 3.8667,13.9999 4.46191,13.9999 C5.05664,13.9999 5.53906,13.5175 5.53906,12.9224 L5.53906,10.6157 L8.46045,10.6157 L8.46045,12.9224 C8.46045,13.5175 8.94287,13.9999 9.53809,13.9999 C10.1333,13.9999 10.6157,13.5175 10.6157,12.9224 L10.6157,10.6157 L12.9224,10.6157 C13.5176,10.6157 14,10.1333 14,9.53818 C14,8.94308 13.5176,8.46063 12.9224,8.46063 L10.6157,8.46063 L10.6157,5.53931 L12.9224,5.53931 C13.5176,5.53931 14,5.05688 14,4.46179 C14,3.86667 13.5176,3.38425 12.9224,3.38425 L10.6157,3.38425 L10.6157,1.07751 C10.6157,0.482422 10.1333,0 9.53809,0 C8.94287,0 8.46045,0.482422 8.46045,1.07751 L8.46045,3.38425 L5.53906,3.38425 L5.53906,1.07751 C5.53906,0.482422 5.05664,0 4.46191,0 Z M5.53906,8.46063 L5.53906,5.53931 L8.46045,5.53931 L8.46045,8.46063 L5.53906,8.46063 Z"></path></svg></span>ä¸€å­£åº¦</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesNumber"><path d="M4.46191,0 C3.8667,0 3.38428,0.482422 3.38428,1.07751 L3.38428,3.38425 L1.07764,3.38425 C0.482422,3.38425 0,3.86667 0,4.46179 C0,5.05688 0.482422,5.53931 1.07764,5.53931 L3.38428,5.53931 L3.38428,8.46063 L1.07764,8.46063 C0.482422,8.46063 0,8.94308 0,9.53818 C0,10.1333 0.482422,10.6157 1.07764,10.6157 L3.38428,10.6157 L3.38428,12.9224 C3.38428,13.5175 3.8667,13.9999 4.46191,13.9999 C5.05664,13.9999 5.53906,13.5175 5.53906,12.9224 L5.53906,10.6157 L8.46045,10.6157 L8.46045,12.9224 C8.46045,13.5175 8.94287,13.9999 9.53809,13.9999 C10.1333,13.9999 10.6157,13.5175 10.6157,12.9224 L10.6157,10.6157 L12.9224,10.6157 C13.5176,10.6157 14,10.1333 14,9.53818 C14,8.94308 13.5176,8.46063 12.9224,8.46063 L10.6157,8.46063 L10.6157,5.53931 L12.9224,5.53931 C13.5176,5.53931 14,5.05688 14,4.46179 C14,3.86667 13.5176,3.38425 12.9224,3.38425 L10.6157,3.38425 L10.6157,1.07751 C10.6157,0.482422 10.1333,0 9.53809,0 C8.94287,0 8.46045,0.482422 8.46045,1.07751 L8.46045,3.38425 L5.53906,3.38425 L5.53906,1.07751 C5.53906,0.482422 5.05664,0 4.46191,0 Z M5.53906,8.46063 L5.53906,5.53931 L8.46045,5.53931 L8.46045,8.46063 L5.53906,8.46063 Z"></path></svg></span>äºŒå­£åº¦</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesNumber"><path d="M4.46191,0 C3.8667,0 3.38428,0.482422 3.38428,1.07751 L3.38428,3.38425 L1.07764,3.38425 C0.482422,3.38425 0,3.86667 0,4.46179 C0,5.05688 0.482422,5.53931 1.07764,5.53931 L3.38428,5.53931 L3.38428,8.46063 L1.07764,8.46063 C0.482422,8.46063 0,8.94308 0,9.53818 C0,10.1333 0.482422,10.6157 1.07764,10.6157 L3.38428,10.6157 L3.38428,12.9224 C3.38428,13.5175 3.8667,13.9999 4.46191,13.9999 C5.05664,13.9999 5.53906,13.5175 5.53906,12.9224 L5.53906,10.6157 L8.46045,10.6157 L8.46045,12.9224 C8.46045,13.5175 8.94287,13.9999 9.53809,13.9999 C10.1333,13.9999 10.6157,13.5175 10.6157,12.9224 L10.6157,10.6157 L12.9224,10.6157 C13.5176,10.6157 14,10.1333 14,9.53818 C14,8.94308 13.5176,8.46063 12.9224,8.46063 L10.6157,8.46063 L10.6157,5.53931 L12.9224,5.53931 C13.5176,5.53931 14,5.05688 14,4.46179 C14,3.86667 13.5176,3.38425 12.9224,3.38425 L10.6157,3.38425 L10.6157,1.07751 C10.6157,0.482422 10.1333,0 9.53809,0 C8.94287,0 8.46045,0.482422 8.46045,1.07751 L8.46045,3.38425 L5.53906,3.38425 L5.53906,1.07751 C5.53906,0.482422 5.05664,0 4.46191,0 Z M5.53906,8.46063 L5.53906,5.53931 L8.46045,5.53931 L8.46045,8.46063 L5.53906,8.46063 Z"></path></svg></span>ä¸‰å­£åº¦</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesNumber"><path d="M4.46191,0 C3.8667,0 3.38428,0.482422 3.38428,1.07751 L3.38428,3.38425 L1.07764,3.38425 C0.482422,3.38425 0,3.86667 0,4.46179 C0,5.05688 0.482422,5.53931 1.07764,5.53931 L3.38428,5.53931 L3.38428,8.46063 L1.07764,8.46063 C0.482422,8.46063 0,8.94308 0,9.53818 C0,10.1333 0.482422,10.6157 1.07764,10.6157 L3.38428,10.6157 L3.38428,12.9224 C3.38428,13.5175 3.8667,13.9999 4.46191,13.9999 C5.05664,13.9999 5.53906,13.5175 5.53906,12.9224 L5.53906,10.6157 L8.46045,10.6157 L8.46045,12.9224 C8.46045,13.5175 8.94287,13.9999 9.53809,13.9999 C10.1333,13.9999 10.6157,13.5175 10.6157,12.9224 L10.6157,10.6157 L12.9224,10.6157 C13.5176,10.6157 14,10.1333 14,9.53818 C14,8.94308 13.5176,8.46063 12.9224,8.46063 L10.6157,8.46063 L10.6157,5.53931 L12.9224,5.53931 C13.5176,5.53931 14,5.05688 14,4.46179 C14,3.86667 13.5176,3.38425 12.9224,3.38425 L10.6157,3.38425 L10.6157,1.07751 C10.6157,0.482422 10.1333,0 9.53809,0 C8.94287,0 8.46045,0.482422 8.46045,1.07751 L8.46045,3.38425 L5.53906,3.38425 L5.53906,1.07751 C5.53906,0.482422 5.05664,0 4.46191,0 Z M5.53906,8.46063 L5.53906,5.53931 L8.46045,5.53931 L8.46045,8.46063 L5.53906,8.46063 Z"></path></svg></span>å››å­£åº¦</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>Title</th></tr></thead><tbody><tr id="ddc14fd5-fbf9-405a-8468-26408f96960d"><td class="cell-;FGc">1991</td><td class="cell-:,uG">11</td><td class="cell-[HnY">12</td><td class="cell-e.Q&gt;">13</td><td class="cell-0%7e">14</td><td class="cell-title"><a href="https://www.notion.so/ddc14fd5fbf9405a846826408f96960d">Untitled</a></td></tr><tr id="b96c1ac7-e46c-44ec-a46f-c17eac43ca71"><td class="cell-;FGc">1992</td><td class="cell-:,uG">21</td><td class="cell-[HnY">22</td><td class="cell-e.Q&gt;">23</td><td class="cell-0%7e">24</td><td class="cell-title"><a href="https://www.notion.so/b96c1ac7e46c44eca46fc17eac43ca71">Untitled</a></td></tr></tbody></table></div><pre id="9bec8d58-53a5-4e5d-bc36-6998d6484fc7" class="code"><code>select 
	å¹´,
sum( case when  å­£åº¦ = 1 then é”€å”®é‡  else null end ) ä¸€å­£åº¦,
sum( case when å­£åº¦ = 2 then é”€å”®é‡ else null end ) as äºŒå­£åº¦,
sum( case when å­£åº¦ = 3 then é”€å”®é‡ else null end ) as  ä¸‰å­£åº¦,
sum( case when å­£åº¦ = 4 then é”€å”®é‡ else null end ) as å››å­£åº¦
from 
page 
group by 
å¹´
order by 
å¹´</code></pre><ul id="305dafc5-6a12-4b4d-8226-86e6e459bb48" class="bulleted-list"><li>å¤šè¡Œè½¬å•åˆ—</li></ul><div id="31f0fa25-00fa-437b-b9ac-50fe00486aec" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>çœ-åŸå¸‚</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesNumber"><path d="M4.46191,0 C3.8667,0 3.38428,0.482422 3.38428,1.07751 L3.38428,3.38425 L1.07764,3.38425 C0.482422,3.38425 0,3.86667 0,4.46179 C0,5.05688 0.482422,5.53931 1.07764,5.53931 L3.38428,5.53931 L3.38428,8.46063 L1.07764,8.46063 C0.482422,8.46063 0,8.94308 0,9.53818 C0,10.1333 0.482422,10.6157 1.07764,10.6157 L3.38428,10.6157 L3.38428,12.9224 C3.38428,13.5175 3.8667,13.9999 4.46191,13.9999 C5.05664,13.9999 5.53906,13.5175 5.53906,12.9224 L5.53906,10.6157 L8.46045,10.6157 L8.46045,12.9224 C8.46045,13.5175 8.94287,13.9999 9.53809,13.9999 C10.1333,13.9999 10.6157,13.5175 10.6157,12.9224 L10.6157,10.6157 L12.9224,10.6157 C13.5176,10.6157 14,10.1333 14,9.53818 C14,8.94308 13.5176,8.46063 12.9224,8.46063 L10.6157,8.46063 L10.6157,5.53931 L12.9224,5.53931 C13.5176,5.53931 14,5.05688 14,4.46179 C14,3.86667 13.5176,3.38425 12.9224,3.38425 L10.6157,3.38425 L10.6157,1.07751 C10.6157,0.482422 10.1333,0 9.53809,0 C8.94287,0 8.46045,0.482422 8.46045,1.07751 L8.46045,3.38425 L5.53906,3.38425 L5.53906,1.07751 C5.53906,0.482422 5.05664,0 4.46191,0 Z M5.53906,8.46063 L5.53906,5.53931 L8.46045,5.53931 L8.46045,8.46063 L5.53906,8.46063 Z"></path></svg></span>uv</th></tr></thead><tbody><tr id="76cd5875-bee1-408f-8077-4bd05832df03"><td class="cell-title"><a href="https://www.notion.so/76cd5875bee1408f80774bd05832df03">æ²³åŒ—çœ-ä¿å®š</a></td><td class="cell-.V8}">11189</td></tr><tr id="14626586-5d14-48a6-b042-4e56fdf96e53"><td class="cell-title"><a href="https://www.notion.so/146265865d1448a6b0424e56fdf96e53">å±±è¥¿çœ-é˜³æ³‰å¸‚</a></td><td class="cell-.V8}">13</td></tr><tr id="940b3859-5717-459f-8197-273ddcc30cdc"><td class="cell-title"><a href="https://www.notion.so/940b38595717459f8197273ddcc30cdc">æ²³å—çœ-ä¿¡é˜³</a></td><td class="cell-.V8}">7462</td></tr></tbody></table></div><pre id="768d119c-6f92-4f5e-9ab9-805ef241688c" class="code"><code>select 
	concat_ws( &#x27;-&#x27;, province, city) ,
	count( distinct user_account) as uv 
from 
	(select 
		province,
		city,
user_account
	from 
		table
where 
hit_date = &#x27;2020-05-06&#x27;
	)
group by 
	concat_ws( &#x27;-&#x27;, province, city) 
order by 
		uv DESC </code></pre><ul id="eb4a2b2b-6e7d-4cca-8c91-25b76bc444e6" class="bulleted-list"><li>å¤šè¡Œè½¬å•åˆ—-å¤æ‚</li></ul><div id="85784ade-5eb7-4ae4-bf48-9346487a3d06" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>name</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesSelect"><path d="M7,13 C10.31348,13 13,10.31371 13,7 C13,3.68629 10.31348,1 7,1 C3.68652,1 1,3.68629 1,7 C1,10.31371 3.68652,13 7,13 Z M3.75098,5.32278 C3.64893,5.19142 3.74268,5 3.90869,5 L10.09131,5 C10.25732,5 10.35107,5.19142 10.24902,5.32278 L7.15771,9.29703 C7.07764,9.39998 6.92236,9.39998 6.84229,9.29703 L3.75098,5.32278 Z"></path></svg></span>contellation</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>blood_type</th></tr></thead><tbody><tr id="c43bd773-4ea7-4efb-a3ba-1350486dabd7"><td class="cell-title"><a href="https://www.notion.so/c43bd7734ea74efba3ba1350486dabd7">å­™æ‚Ÿç©º</a></td><td class="cell-nUP&amp;"><span class="selected-value select-value-color-default">ç™½ç¾Šåº§</span></td><td class="cell-{.KI">A</td></tr><tr id="8a94bfc7-8388-4ff1-937e-1ee5dd95af4d"><td class="cell-title"><a href="https://www.notion.so/8a94bfc783884ff1937e1ee5dd95af4d">çŒªå…«æˆ’</a></td><td class="cell-nUP&amp;"><span class="selected-value select-value-color-red">å°„æ‰‹åº§</span></td><td class="cell-{.KI">A</td></tr><tr id="db8bac14-db36-4276-bd03-d6d2b4d630a9"><td class="cell-title"><a href="https://www.notion.so/db8bac14db364276bd03d6d2b4d630a9">å®‹å®‹</a></td><td class="cell-nUP&amp;"><span class="selected-value select-value-color-default">ç™½ç¾Šåº§</span></td><td class="cell-{.KI">B</td></tr><tr id="3ef04632-6d87-4c2f-a9ee-ba64521f108c"><td class="cell-title"><a href="https://www.notion.so/3ef046326d874c2fa9eeba64521f108c">å”åƒ§</a></td><td class="cell-nUP&amp;"><span class="selected-value select-value-color-default">ç™½ç¾Šåº§</span></td><td class="cell-{.KI">A</td></tr><tr id="e938aa65-f96a-432b-a38d-34db0d5b337e"><td class="cell-title"><a href="https://www.notion.so/e938aa65f96a432ba38d34db0d5b337e">å¼ å¸…</a></td><td class="cell-nUP&amp;"><span class="selected-value select-value-color-red">å°„æ‰‹åº§</span></td><td class="cell-{.KI">A</td></tr></tbody></table></div><p id="745f227c-fe3f-4fb0-aeed-7ff120fea8ef" class="">æŠŠæ˜Ÿåº§å’Œè¡€å‹ä¸€æ ·çš„äººå½’ç±»åˆ°ä¸€èµ·ï¼š</p><div id="c5a39428-e3a8-44b7-a8e3-c51a6ad89e28" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>ã€‚ã€‚ã€‚</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>ã€‚ã€‚ã€‚ 1</th></tr></thead><tbody><tr id="d7a7d229-0bcd-4452-8d03-6275e056e62d"><td class="cell-title"><a href="https://www.notion.so/A-d7a7d2290bcd44528d036275e056e62d">å°„æ‰‹åº§,A</a></td><td class="cell-+3E4">çŒªå…«æˆ’\å¼ å¸…</td></tr><tr id="ba7b1f99-3a10-4b7b-b8bb-9331b0370687"><td class="cell-title"><a href="https://www.notion.so/A-ba7b1f993a104b7bb8bb9331b0370687">ç™½ç¾Šåº§,A</a></td><td class="cell-+3E4">å­™æ‚Ÿç©º\å”åƒ§</td></tr><tr id="70fb5125-bd10-4726-945b-612fb6ba0a8b"><td class="cell-title"><a href="https://www.notion.so/B-70fb5125bd104726945b612fb6ba0a8b">ç™½ç¾Šåº§,B</a></td><td class="cell-+3E4">å®‹</td></tr></tbody></table></div><pre id="eda8dbd4-0e3f-4f27-a76d-c53d1b0b90b6" class="code"><code>select 
con_blood,
concat_ws (&quot;\&quot;, collect_set(name))
from 
(SELECT 
concat_ws( &#x27;,&#x27;, contellation, blood_type) as con_blood,
name
from 
table1) 
group by 
con_blood</code></pre><ul id="de6557c5-e5e1-4fb4-9be2-f77928d00ea9" class="bulleted-list"><li>æ±‚å°†æ¯ä¸ªçœçš„åŸå¸‚åˆ—å‡ºæ¥</li></ul><pre id="84b2770a-290d-4ce5-bceb-d651339ee86d" class="code"><code>---è¾½å®çœ  [&quot;è¥å£å¸‚&quot;,&quot;å¤§è¿&quot;,&quot;å¤§è¿å¸‚&quot;,&quot;æŠšé¡ºå¸‚&quot;,&quot;é“å²­&quot;,&quot;ç›˜é”¦&quot;,&quot;é”¦å·&quot;,&quot;æ²ˆé˜³å¸‚&quot;,&quot;è¾½é˜³&quot;,&quot;éå±±&quot;,&quot;é“å²­å¸‚&quot;,&quot;æœ¬æºªå¸‚&quot;,&quot;ä¸¹ä¸œå¸‚&quot;,&quot;ä¸¹ä¸œ&quot;,&quot;æ²ˆé˜³&quot;,&quot;æœé˜³å¸‚&quot;,&quot;é”¦å·å¸‚&quot;,&quot;è¾½é˜³å¸‚&quot;,&quot;é˜œæ–°å¸‚&quot;,&quot;éå±±å¸‚&quot;,&quot;ç›˜é”¦å¸‚&quot;,&quot;è‘«èŠ¦å²›&quot;,&quot;è¥å£&quot;,&quot;æŠšé¡º&quot;,&quot;è‘«èŠ¦å²›å¸‚&quot;,&quot;é˜œæ–°&quot;,&quot;æœ¬æºª&quot;,&quot;æœé˜³&quot;]</code></pre><pre id="71ecb68a-ce1f-4a36-b59a-537cd12bc460" class="code"><code>select 
province, 
collect_set(city) 
from 
android 
where  dt = &#x27;2020-05-01&#x27; and city is not null 
group by 
province 

---è¾½å®çœ  [&quot;è¥å£å¸‚&quot;,&quot;å¤§è¿&quot;,&quot;å¤§è¿å¸‚&quot;,.....,&quot;æœé˜³&quot;]</code></pre><ul id="fb9e489c-737a-428e-b052-7cfe59172d07" class="bulleted-list"><li>æ±‚å‡ºä¸€ä¸ªæœˆå†…æ´»è·ƒå¤©æ•°å¤§äº20å¤©çš„ç”¨æˆ·æ•°</li></ul><pre id="9ce25e2b-2dcd-454c-bb3b-afb90fc538f6" class="code"><code>select 
count(distinct user_account) as uv 
from 
(select 
user_account,
collect_set(hit_date)  as dt
from 
an
where 
hit_date between &#x27;2020-05-01&#x27; and &#x27;2020-05-31&#x27;
group by 
user_account
having
size(dt) &gt; 20)</code></pre><hr id="bbb9c2a5-560b-4642-9de6-b28e58733d07"/><ul id="1d389ecd-ce5b-4293-9c97-f21f349731a3" class="bulleted-list"><li>ä¸¤è¡¨ç»“åˆ</li></ul><div id="030e6cc4-1007-46f7-8cd1-4d8c97988c3c" class="collection-content"><h4 class="collection-title">user_basic_info</h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>id</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesMultipleSelect"><path d="M4,3 C4,2.447715 4.447715,2 5,2 L12,2 C12.5523,2 13,2.447716 13,3 C13,3.55228 12.5523,4 12,4 L5,4 C4.447715,4 4,3.55228 4,3 Z M4,7 C4,6.447715 4.447715,6 5,6 L12,6 C12.5523,6 13,6.447716 13,7 C13,7.55228 12.5523,8 12,8 L5,8 C4.447715,8 4,7.55228 4,7 Z M4,11 C4,10.447715 4.447715,10 5,10 L12,10 C12.5523,10 13,10.447716 13,11 C13,11.55228 12.5523,12 12,12 L5,12 C4.447715,12 4,11.55228 4,11 Z M2,4 C1.44771525,4 1,3.55228475 1,3 C1,2.44771525 1.44771525,2 2,2 C2.55228475,2 3,2.44771525 3,3 C3,3.55228475 2.55228475,4 2,4 Z M2,8 C1.44771525,8 1,7.55228475 1,7 C1,6.44771525 1.44771525,6 2,6 C2.55228475,6 3,6.44771525 3,7 C3,7.55228475 2.55228475,8 2,8 Z M2,12 C1.44771525,12 1,11.5522847 1,11 C1,10.4477153 1.44771525,10 2,10 C2.55228475,10 3,10.4477153 3,11 C3,11.5522847 2.55228475,12 2,12 Z"></path></svg></span>name</th></tr></thead><tbody><tr id="a525ac7c-d5d9-4cc6-ad8a-c3d659e2571e"><td class="cell-title"><a href="https://www.notion.so/1-a525ac7cd5d94cc6ad8ac3d659e2571e">1</a></td><td class="cell-D9L7"><span class="selected-value select-value-color-pink">a</span></td></tr><tr id="591e0800-95c7-4a22-98c9-2623355aee40"><td class="cell-title"><a href="https://www.notion.so/2-591e080095c74a2298c92623355aee40">2</a></td><td class="cell-D9L7"><span class="selected-value select-value-color-purple">b</span></td></tr><tr id="72937eaa-e33a-40c9-bc05-628d6c982e22"><td class="cell-title"><a href="https://www.notion.so/3-72937eaae33a40c9bc05628d6c982e22">3</a></td><td class="cell-D9L7"><span class="selected-value select-value-color-orange">c</span></td></tr><tr id="72f9f371-cdc8-4eea-8b4a-073424a89fd4"><td class="cell-title"><a href="https://www.notion.so/4-72f9f371cdc84eea8b4a073424a89fd4">4</a></td><td class="cell-D9L7"><span class="selected-value select-value-color-blue">d</span></td></tr><tr id="04bccc64-b717-43c9-8755-23a6cb0b7e35"><td class="cell-title"><a href="https://www.notion.so/04bccc64b71743c9875523a6cb0b7e35">Untitled</a></td><td class="cell-D9L7"></td></tr><tr id="82bc6e60-7f80-481a-ad27-fcadd3044332"><td class="cell-title"><a href="https://www.notion.so/82bc6e607f80481aad27fcadd3044332">Untitled</a></td><td class="cell-D9L7"></td></tr></tbody></table></div><div id="10c03ebf-a154-47d0-b910-c5c797835bbd" class="collection-content"><h4 class="collection-title">user_address</h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>Name</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>address</th></tr></thead><tbody><tr id="4c3c3ec1-9802-4130-8ab4-db31befcdf89"><td class="cell-title"><a href="https://www.notion.so/a-4c3c3ec1980241308ab4db31befcdf89">a</a></td><td class="cell-XWa\">add1</td></tr><tr id="5629a220-e0ed-41a0-b6fd-eec66472b199"><td class="cell-title"><a href="https://www.notion.so/a-5629a220e0ed41a0b6fdeec66472b199">a</a></td><td class="cell-XWa\">add2</td></tr><tr id="ba7ec812-dde6-4731-a864-6e9a288985f9"><td class="cell-title"><a href="https://www.notion.so/b-ba7ec812dde64731a8646e9a288985f9">b</a></td><td class="cell-XWa\">add3</td></tr><tr id="a5db73f1-ca46-4e20-93d5-761c47e0515a"><td class="cell-title"><a href="https://www.notion.so/c-a5db73f1ca464e2093d5761c47e0515a">c</a></td><td class="cell-XWa\">add4</td></tr><tr id="df15e01d-0663-4baa-863a-b0fda272fe8e"><td class="cell-title"><a href="https://www.notion.so/d-df15e01d06634baa863ab0fda272fe8e">d</a></td><td class="cell-XWa\">add5</td></tr></tbody></table></div><p id="b4932766-d163-4e7b-a70d-4cce2a726582" class="">æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åŒä¸€ä¸ªç”¨æˆ·ä¸æ­¢ä¸€ä¸ªåœ°å€ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæ•°æ®å˜ä¸ºå¦‚ä¸‹æ ¼å¼</p><div id="d59de578-9548-44cd-81b9-579a26ae3e07" class="collection-content"><h4 class="collection-title">user_info</h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>id</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>name</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>address</th></tr></thead><tbody><tr id="0d5fe198-d22b-435e-b9af-231eadc75136"><td class="cell-title"><a href="https://www.notion.so/1-0d5fe198d22b435eb9af231eadc75136">1</a></td><td class="cell-M`E&amp;">a</td><td class="cell-},4d">add1,add2</td></tr><tr id="b4dbf135-3a1b-43d7-97c0-789ac33e2e1b"><td class="cell-title"><a href="https://www.notion.so/2-b4dbf1353a1b43d797c0789ac33e2e1b">2</a></td><td class="cell-M`E&amp;">b</td><td class="cell-},4d">add3</td></tr><tr id="c5e258c8-76a6-4388-9d25-46abbcf1fcb4"><td class="cell-title"><a href="https://www.notion.so/3-c5e258c876a643889d2546abbcf1fcb4">3</a></td><td class="cell-M`E&amp;">c</td><td class="cell-},4d">add4</td></tr><tr id="2ed52bee-74a4-48e3-80e4-ef4ae39bf64f"><td class="cell-title"><a href="https://www.notion.so/4-2ed52bee74a448e380e4ef4ae39bf64f">4</a></td><td class="cell-M`E&amp;">d</td><td class="cell-},4d">add5</td></tr></tbody></table></div><pre id="2df6ad06-4e5d-42cf-ba37-da6e3db273d0" class="code"><code>  with a1as (select 
name,
concat_ws (&#x27;,&#x27;, collect_set(address)) as addres
from 
user_address
group by 
name),
a2 as (
select 
id, name 
from 
user_basic_info ) 
select 
a2.id, a2.name ,a1.addres
from 
a2 left join a1 on a2.name = a1.name 





select

 a1.id, a1.name, concat_ws(&#x27;,&#x27;, collect_set(a2.address)) as address

from

user_basic_info a1 join user_address a2  on a1.name=a2.name

group by a1.id, a1.name
</code></pre><p id="13e52d9c-3539-4ed3-9c70-b48a728706af" class="">å°†ç»„åˆçš„è¡¨æ‹†åˆ†æˆå¦‚ä¸‹å½¢å¼ï¼š</p><div id="0651c21f-5091-49a5-9e33-ffef2733053c" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>id</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>name</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>address</th></tr></thead><tbody><tr id="d584ce2d-8407-43b3-a04e-79cce1a56a6b"><td class="cell-title"><a href="https://www.notion.so/1-d584ce2d840743b3a04e79cce1a56a6b">1</a></td><td class="cell-uG2I">a</td><td class="cell-&gt;J?/">add1</td></tr><tr id="c36a2406-467e-4cfb-8987-a7cbf3fe15f2"><td class="cell-title"><a href="https://www.notion.so/1-c36a2406467e4cfb8987a7cbf3fe15f2">1</a></td><td class="cell-uG2I">a</td><td class="cell-&gt;J?/">add2</td></tr><tr id="a5cef236-01c1-451c-ad13-ac8e863232fa"><td class="cell-title"><a href="https://www.notion.so/2-a5cef23601c1451cad13ac8e863232fa">2</a></td><td class="cell-uG2I">b</td><td class="cell-&gt;J?/">add3</td></tr><tr id="40456029-fdfe-4fab-8103-1ef6ee06c36b"><td class="cell-title"><a href="https://www.notion.so/3-40456029fdfe4fab81031ef6ee06c36b">3</a></td><td class="cell-uG2I">c</td><td class="cell-&gt;J?/">add4</td></tr><tr id="1390debb-ed8a-40f9-93ed-189520fb4dc7"><td class="cell-title"><a href="https://www.notion.so/4-1390debbed8a40f993ed189520fb4dc7">4</a></td><td class="cell-uG2I">d</td><td class="cell-&gt;J?/">add5</td></tr></tbody></table></div><pre id="6d720843-545f-4c61-9758-69828131096f" class="code"><code>--è¿™æ ·å†™ä¼šä¼šç”Ÿæˆç¬›å¡å°”ç§¯ï¼Œæ‰§è¡ŒæŠ¥é”™
select idï¼Œ name, explode(address)  as address from user_info;

---éœ€è¿™æ ·å†™

select 
id, name,  add 
from 
user_info a1
lateral view explode(a1.address) adtable as add ;</code></pre><h2 id="e52758ec-8c02-407b-8800-43837eb05950" class="">åˆ—è½¬è¡Œ</h2><ol id="60246188-a97e-46c8-8f1f-129d67f61e89" class="numbered-list" start="1"><li>å‡½æ•°</li></ol><ul id="079e330a-bb79-4626-8cfa-1249b3f5a9e7" class="bulleted-list"><li>explode(col): å°†hiveåˆ—ä¸­å¤æ‚çš„arrayæˆ–è€…mapç»“æ„æ‹†åˆ†æˆå¤šè¡Œ</li></ul><ul id="d491507f-3b36-4608-a421-bef7f531e63a" class="bulleted-list"><li><strong>lateral view</strong> ç”¨æ³•ï¼š lateral view UDTF(expression) adtable  as a1  è¯´æ˜ï¼š ç”¨æˆ·å’Œsplit,explode ç­‰UDTFä¸€èµ·ä½¿ç”¨ï¼Œèƒ½å¤Ÿå°†ä¸€åˆ—æ•°æ®æ‹†åˆ†æˆå¤šè¡Œæ•°æ®ï¼Œ åœ¨æ­¤åŸºç¡€ä¸Šå¯ä»¥å¯¹æ‹†åˆ†çš„æ•°æ®è¿›è¡Œèšåˆè®¡ç®—. å½¢æˆä¸€ä¸ªæ–°çš„è¡¨ï¼Œå¹¶å¯¹åŸæ¥çš„è¡¨è¿›è¡Œä¾§å†™</li></ul><ol id="d86a48a3-6502-479c-a238-b8ace9965c96" class="numbered-list" start="1"><li>æ¡ˆä¾‹</li></ol><ul id="b770bb02-1632-4197-9fee-ebf53f5f1975" class="bulleted-list"><li>éœ€æ±‚1</li></ul><div id="0fb30bcb-f41d-4f0d-8497-61ad44b8e5d2" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>movie</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>category</th></tr></thead><tbody><tr id="014b22ca-f13a-4954-b5fe-0ec532a8269b"><td class="cell-title"><a href="https://www.notion.so/014b22caf13a4954b5fe0ec532a8269b">ã€Šç–‘çŠ¯è¿½è¸ªã€‹</a></td><td class="cell-YFF[">æ‚¬ç–‘,åŠ¨ä½œ,ç§‘å¹»,å‰§æƒ…</td></tr><tr id="541865ce-1511-410e-b17e-41df8165f7a3"><td class="cell-title"><a href="https://www.notion.so/lie-to-me-541865ce1511410eb17e41df8165f7a3">ã€Šlie to meã€‹</a></td><td class="cell-YFF[">è­¦åŒª,åŠ¨ä½œ,å¿ƒç†</td></tr></tbody></table></div><p id="e2733935-152f-4462-a113-d8e7178286ce" class="">è¦æ±‚ï¼š</p><div id="482c74f2-e497-4c17-a778-347724389337" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesSelect"><path d="M7,13 C10.31348,13 13,10.31371 13,7 C13,3.68629 10.31348,1 7,1 C3.68652,1 1,3.68629 1,7 C1,10.31371 3.68652,13 7,13 Z M3.75098,5.32278 C3.64893,5.19142 3.74268,5 3.90869,5 L10.09131,5 C10.25732,5 10.35107,5.19142 10.24902,5.32278 L7.15771,9.29703 C7.07764,9.39998 6.92236,9.39998 6.84229,9.29703 L3.75098,5.32278 Z"></path></svg></span>movie</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>category</th></tr></thead><tbody><tr id="50a126c2-ca5f-4d4c-835f-277f31770a36"><td class="cell-@m]z"><span class="selected-value select-value-color-purple">ã€Šç–‘çŠ¯è¿½è¸ªã€‹</span></td><td class="cell-title"><a href="https://www.notion.so/50a126c2ca5f4d4c835f277f31770a36">æ‚¬ç–‘</a></td></tr><tr id="509a1c37-8241-4261-94ec-f472f63d48ba"><td class="cell-@m]z"><span class="selected-value select-value-color-purple">ã€Šç–‘çŠ¯è¿½è¸ªã€‹</span></td><td class="cell-title"><a href="https://www.notion.so/509a1c378241426194ecf472f63d48ba">åŠ¨ä½œ</a></td></tr><tr id="de002acb-5ef2-4ef1-8e01-f38650591078"><td class="cell-@m]z"><span class="selected-value select-value-color-purple">ã€Šç–‘çŠ¯è¿½è¸ªã€‹</span></td><td class="cell-title"><a href="https://www.notion.so/de002acb5ef24ef18e01f38650591078">ç§‘å¹»</a></td></tr><tr id="65d27edd-8c89-4e60-b141-a449dc08bcc0"><td class="cell-@m]z"><span class="selected-value select-value-color-purple">ã€Šç–‘çŠ¯è¿½è¸ªã€‹</span></td><td class="cell-title"><a href="https://www.notion.so/65d27edd8c894e60b141a449dc08bcc0">å‰§æƒ…</a></td></tr><tr id="3c2e05b1-a71d-4985-9e22-356c910dfb17"><td class="cell-@m]z"><span class="selected-value select-value-color-blue">ã€Šlie to meã€‹</span></td><td class="cell-title"><a href="https://www.notion.so/3c2e05b1a71d49859e22356c910dfb17">è­¦åŒª</a></td></tr><tr id="38bd69dd-fd96-4daf-8fea-37aed572e478"><td class="cell-@m]z"><span class="selected-value select-value-color-blue">ã€Šlie to meã€‹</span></td><td class="cell-title"><a href="https://www.notion.so/38bd69ddfd964daf8fea37aed572e478">åŠ¨ä½œ</a></td></tr><tr id="56e6d16b-72c7-4f12-9097-54d6d833bcfb"><td class="cell-@m]z"><span class="selected-value select-value-color-blue">ã€Šlie to meã€‹</span></td><td class="cell-title"><a href="https://www.notion.so/56e6d16b72c74f12909754d6d833bcfb">å¿ƒç†</a></td></tr></tbody></table></div><pre id="dd6d6e2a-5a95-43b5-816d-6c986ea38021" class="code"><code>select 
	movie. categrory_name
from 
movie_info
lateral  view explode ( categrory)  adtable as categrory_name</code></pre><ul id="187e2db3-3e1a-4d5d-b9c7-aff4bc9decf1" class="bulleted-list"><li>éœ€æ±‚2ï¼š å°† è¡¨ table ä¸­çš„ <code>adid_list</code> è½¬æ¢ä¸ºå•ç‹¬çš„è¡Œã€‚</li></ul><p id="89034b10-ac1f-4e5f-b922-b9e58fdfd82f" class="">è¡¨-tableï¼š</p><div id="0c398ee5-64d1-4e8b-9246-00b5edc6c2cd" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>pageid</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>adid_list</th></tr></thead><tbody><tr id="7eed5bb6-84a3-438e-a219-e63ce0aeff00"><td class="cell-title"><a href="https://www.notion.so/front_page-7eed5bb684a3438ea219e63ce0aeff00">front_page</a></td><td class="cell-FpHt">[1,2,3]</td></tr><tr id="b8fa2caf-b6f1-425a-ae95-a50c3dac565c"><td class="cell-title"><a href="https://www.notion.so/contact_page-b8fa2cafb6f1425aae95a50c3dac565c">contact_page</a></td><td class="cell-FpHt">[3,4]</td></tr></tbody></table></div><p id="0a910f96-c185-466e-9cbf-8804dd77c58c" class="">è¾“å‡ºç»“æœä¸ºï¼š</p><div id="9b012931-a294-4f14-bd31-f810a67ee57e" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesSelect"><path d="M7,13 C10.31348,13 13,10.31371 13,7 C13,3.68629 10.31348,1 7,1 C3.68652,1 1,3.68629 1,7 C1,10.31371 3.68652,13 7,13 Z M3.75098,5.32278 C3.64893,5.19142 3.74268,5 3.90869,5 L10.09131,5 C10.25732,5 10.35107,5.19142 10.24902,5.32278 L7.15771,9.29703 C7.07764,9.39998 6.92236,9.39998 6.84229,9.29703 L3.75098,5.32278 Z"></path></svg></span>pageid</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesNumber"><path d="M4.46191,0 C3.8667,0 3.38428,0.482422 3.38428,1.07751 L3.38428,3.38425 L1.07764,3.38425 C0.482422,3.38425 0,3.86667 0,4.46179 C0,5.05688 0.482422,5.53931 1.07764,5.53931 L3.38428,5.53931 L3.38428,8.46063 L1.07764,8.46063 C0.482422,8.46063 0,8.94308 0,9.53818 C0,10.1333 0.482422,10.6157 1.07764,10.6157 L3.38428,10.6157 L3.38428,12.9224 C3.38428,13.5175 3.8667,13.9999 4.46191,13.9999 C5.05664,13.9999 5.53906,13.5175 5.53906,12.9224 L5.53906,10.6157 L8.46045,10.6157 L8.46045,12.9224 C8.46045,13.5175 8.94287,13.9999 9.53809,13.9999 C10.1333,13.9999 10.6157,13.5175 10.6157,12.9224 L10.6157,10.6157 L12.9224,10.6157 C13.5176,10.6157 14,10.1333 14,9.53818 C14,8.94308 13.5176,8.46063 12.9224,8.46063 L10.6157,8.46063 L10.6157,5.53931 L12.9224,5.53931 C13.5176,5.53931 14,5.05688 14,4.46179 C14,3.86667 13.5176,3.38425 12.9224,3.38425 L10.6157,3.38425 L10.6157,1.07751 C10.6157,0.482422 10.1333,0 9.53809,0 C8.94287,0 8.46045,0.482422 8.46045,1.07751 L8.46045,3.38425 L5.53906,3.38425 L5.53906,1.07751 C5.53906,0.482422 5.05664,0 4.46191,0 Z M5.53906,8.46063 L5.53906,5.53931 L8.46045,5.53931 L8.46045,8.46063 L5.53906,8.46063 Z"></path></svg></span>adid_list</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>Title</th></tr></thead><tbody><tr id="815ba1bf-c016-48a7-a6a9-d9748cd96ea1"><td class="cell-uu&lt;&lt;"><span class="selected-value select-value-color-yellow">front_page</span></td><td class="cell-S[Ie">1</td><td class="cell-title"><a href="https://www.notion.so/815ba1bfc01648a7a6a9d9748cd96ea1">Untitled</a></td></tr><tr id="724f9883-7e5b-43c3-85d8-b4e2b3ca2e57"><td class="cell-uu&lt;&lt;"><span class="selected-value select-value-color-yellow">front_page</span></td><td class="cell-S[Ie">2</td><td class="cell-title"><a href="https://www.notion.so/724f98837e5b43c385d8b4e2b3ca2e57">Untitled</a></td></tr><tr id="836794f0-1379-4c26-ac19-170d8a3973e0"><td class="cell-uu&lt;&lt;"><span class="selected-value select-value-color-yellow">front_page</span></td><td class="cell-S[Ie">3</td><td class="cell-title"><a href="https://www.notion.so/836794f013794c26ac19170d8a3973e0">Untitled</a></td></tr><tr id="1944cba6-a2cf-446b-81f1-6899f4a2b97a"><td class="cell-uu&lt;&lt;"><span class="selected-value select-value-color-brown">contact_page</span></td><td class="cell-S[Ie">3</td><td class="cell-title"><a href="https://www.notion.so/1944cba6a2cf446b81f16899f4a2b97a">Untitled</a></td></tr><tr id="f144815b-9e27-4e0e-bc62-e8670c05154f"><td class="cell-uu&lt;&lt;"><span class="selected-value select-value-color-brown">contact_page</span></td><td class="cell-S[Ie">4</td><td class="cell-title"><a href="https://www.notion.so/f144815b9e274e0ebc62e8670c05154f">Untitled</a></td></tr></tbody></table></div><pre id="b4a1d7da-a9c3-4b90-b467-f35b683d187e" class="code"><code>select 
	pageid, adid
from 
	talbe1
lateral view explode(adid_list) adtable as adid</code></pre><ul id="3f5c7363-2f75-4c5f-958b-7d2230c74dbd" class="bulleted-list"><li>éœ€æ±‚3ï¼š è®¡ç®—ç‰¹å®šå¹¿å‘Šçš„å±•ç°æ¬¡æ•°</li></ul><pre id="ff94bbfd-0135-44da-b5d0-b4442e58eda8" class="code"><code>select 
	adid, 
	count(1) 
from 
 table
later view explode(adid_list) adtable as  adid
group by 
adid</code></pre><p id="972b3249-90a3-4fef-8cc7-ed7541ec9942" class="">è¾“å‡ºç»“æœä¸ºï¼š</p><div id="d99abba5-c5c9-462e-930a-080d6201e3ac" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesNumber"><path d="M4.46191,0 C3.8667,0 3.38428,0.482422 3.38428,1.07751 L3.38428,3.38425 L1.07764,3.38425 C0.482422,3.38425 0,3.86667 0,4.46179 C0,5.05688 0.482422,5.53931 1.07764,5.53931 L3.38428,5.53931 L3.38428,8.46063 L1.07764,8.46063 C0.482422,8.46063 0,8.94308 0,9.53818 C0,10.1333 0.482422,10.6157 1.07764,10.6157 L3.38428,10.6157 L3.38428,12.9224 C3.38428,13.5175 3.8667,13.9999 4.46191,13.9999 C5.05664,13.9999 5.53906,13.5175 5.53906,12.9224 L5.53906,10.6157 L8.46045,10.6157 L8.46045,12.9224 C8.46045,13.5175 8.94287,13.9999 9.53809,13.9999 C10.1333,13.9999 10.6157,13.5175 10.6157,12.9224 L10.6157,10.6157 L12.9224,10.6157 C13.5176,10.6157 14,10.1333 14,9.53818 C14,8.94308 13.5176,8.46063 12.9224,8.46063 L10.6157,8.46063 L10.6157,5.53931 L12.9224,5.53931 C13.5176,5.53931 14,5.05688 14,4.46179 C14,3.86667 13.5176,3.38425 12.9224,3.38425 L10.6157,3.38425 L10.6157,1.07751 C10.6157,0.482422 10.1333,0 9.53809,0 C8.94287,0 8.46045,0.482422 8.46045,1.07751 L8.46045,3.38425 L5.53906,3.38425 L5.53906,1.07751 C5.53906,0.482422 5.05664,0 4.46191,0 Z M5.53906,8.46063 L5.53906,5.53931 L8.46045,5.53931 L8.46045,8.46063 L5.53906,8.46063 Z"></path></svg></span>adid</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesNumber"><path d="M4.46191,0 C3.8667,0 3.38428,0.482422 3.38428,1.07751 L3.38428,3.38425 L1.07764,3.38425 C0.482422,3.38425 0,3.86667 0,4.46179 C0,5.05688 0.482422,5.53931 1.07764,5.53931 L3.38428,5.53931 L3.38428,8.46063 L1.07764,8.46063 C0.482422,8.46063 0,8.94308 0,9.53818 C0,10.1333 0.482422,10.6157 1.07764,10.6157 L3.38428,10.6157 L3.38428,12.9224 C3.38428,13.5175 3.8667,13.9999 4.46191,13.9999 C5.05664,13.9999 5.53906,13.5175 5.53906,12.9224 L5.53906,10.6157 L8.46045,10.6157 L8.46045,12.9224 C8.46045,13.5175 8.94287,13.9999 9.53809,13.9999 C10.1333,13.9999 10.6157,13.5175 10.6157,12.9224 L10.6157,10.6157 L12.9224,10.6157 C13.5176,10.6157 14,10.1333 14,9.53818 C14,8.94308 13.5176,8.46063 12.9224,8.46063 L10.6157,8.46063 L10.6157,5.53931 L12.9224,5.53931 C13.5176,5.53931 14,5.05688 14,4.46179 C14,3.86667 13.5176,3.38425 12.9224,3.38425 L10.6157,3.38425 L10.6157,1.07751 C10.6157,0.482422 10.1333,0 9.53809,0 C8.94287,0 8.46045,0.482422 8.46045,1.07751 L8.46045,3.38425 L5.53906,3.38425 L5.53906,1.07751 C5.53906,0.482422 5.05664,0 4.46191,0 Z M5.53906,8.46063 L5.53906,5.53931 L8.46045,5.53931 L8.46045,8.46063 L5.53906,8.46063 Z"></path></svg></span>count(1)</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>Title</th></tr></thead><tbody><tr id="ec717ada-ff77-4411-a900-e0c71d68b6bb"><td class="cell-ke^G">1</td><td class="cell-&amp;5iT">1</td><td class="cell-title"><a href="https://www.notion.so/ec717adaff774411a900e0c71d68b6bb">Untitled</a></td></tr><tr id="1f78a70d-9299-4409-a812-22cd18d3c189"><td class="cell-ke^G">2</td><td class="cell-&amp;5iT">1</td><td class="cell-title"><a href="https://www.notion.so/1f78a70d92994409a81222cd18d3c189">Untitled</a></td></tr><tr id="dbc6bfaa-fa83-4c25-95e9-f7fc0a04336c"><td class="cell-ke^G">3</td><td class="cell-&amp;5iT">2</td><td class="cell-title"><a href="https://www.notion.so/dbc6bfaafa834c2595e9f7fc0a04336c">Untitled</a></td></tr><tr id="0f8fbad8-f2fc-411d-b646-69d8c626e159"><td class="cell-ke^G">4</td><td class="cell-&amp;5iT">1</td><td class="cell-title"><a href="https://www.notion.so/0f8fbad8f2fc411db64669d8c626e159">Untitled</a></td></tr></tbody></table></div><ul id="6522d9b0-2388-4d04-936e-0d9dd59031c7" class="bulleted-list"><li>éœ€æ±‚4ï¼š å¤šä¸ª lateral view æŸ¥è¯¢</li></ul><p id="f60f3da9-b073-4840-8eb6-96f1fcb5ff28" class="">è¡¨ï¼š table2</p><div id="10fcc80c-3f16-4561-bb10-c9661e298713" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>array</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>col2</th></tr></thead><tbody><tr id="0fb9fec9-23e7-4dd3-8ace-c16a5931dc98"><td class="cell-title"><a href="https://www.notion.so/1-2-0fb9fec923e74dd38acec16a5931dc98">[1,2]</a></td><td class="cell-0+-U">[â€œaâ€ï¼Œâ€œbâ€]</td></tr><tr id="5886cd1b-5710-4ae0-a95d-5353c6f6b37d"><td class="cell-title"><a href="https://www.notion.so/3-4-5886cd1b57104ae0a95d5353c6f6b37d">[3,4]</a></td><td class="cell-0+-U">[â€œcâ€, â€œdâ€]</td></tr></tbody></table></div><p id="f3c8bd0b-12e0-409f-9894-669d841a0aec" class="">è¾“å‡ºç»“æœä¸ºï¼š</p><div id="cd2500e0-8bce-45ce-8596-7c0724d6cb8a" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesNumber"><path d="M4.46191,0 C3.8667,0 3.38428,0.482422 3.38428,1.07751 L3.38428,3.38425 L1.07764,3.38425 C0.482422,3.38425 0,3.86667 0,4.46179 C0,5.05688 0.482422,5.53931 1.07764,5.53931 L3.38428,5.53931 L3.38428,8.46063 L1.07764,8.46063 C0.482422,8.46063 0,8.94308 0,9.53818 C0,10.1333 0.482422,10.6157 1.07764,10.6157 L3.38428,10.6157 L3.38428,12.9224 C3.38428,13.5175 3.8667,13.9999 4.46191,13.9999 C5.05664,13.9999 5.53906,13.5175 5.53906,12.9224 L5.53906,10.6157 L8.46045,10.6157 L8.46045,12.9224 C8.46045,13.5175 8.94287,13.9999 9.53809,13.9999 C10.1333,13.9999 10.6157,13.5175 10.6157,12.9224 L10.6157,10.6157 L12.9224,10.6157 C13.5176,10.6157 14,10.1333 14,9.53818 C14,8.94308 13.5176,8.46063 12.9224,8.46063 L10.6157,8.46063 L10.6157,5.53931 L12.9224,5.53931 C13.5176,5.53931 14,5.05688 14,4.46179 C14,3.86667 13.5176,3.38425 12.9224,3.38425 L10.6157,3.38425 L10.6157,1.07751 C10.6157,0.482422 10.1333,0 9.53809,0 C8.94287,0 8.46045,0.482422 8.46045,1.07751 L8.46045,3.38425 L5.53906,3.38425 L5.53906,1.07751 C5.53906,0.482422 5.05664,0 4.46191,0 Z M5.53906,8.46063 L5.53906,5.53931 L8.46045,5.53931 L8.46045,8.46063 L5.53906,8.46063 Z"></path></svg></span>myCol1</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>myCol2</th></tr></thead><tbody><tr id="decffc82-e12d-477f-81c4-25d4c12d7bd2"><td class="cell-)drg">1</td><td class="cell-title"><a href="https://www.notion.so/a-decffc82e12d477f81c425d4c12d7bd2">â€œaâ€</a></td></tr><tr id="3cc9a17b-1315-4f80-8552-8e14b9ff56ac"><td class="cell-)drg">1</td><td class="cell-title"><a href="https://www.notion.so/b-3cc9a17b13154f8085528e14b9ff56ac">â€œbâ€</a></td></tr><tr id="315315bf-85d0-4eaa-a88e-be87e7a84c54"><td class="cell-)drg">2</td><td class="cell-title"><a href="https://www.notion.so/a-315315bf85d04eaaa88ebe87e7a84c54">â€œaâ€</a></td></tr><tr id="06309488-d11c-4e9a-8c59-487c25788df6"><td class="cell-)drg">2</td><td class="cell-title"><a href="https://www.notion.so/b-06309488d11c4e9a8c59487c25788df6">â€œbâ€</a></td></tr><tr id="8e68898a-aa9e-46e6-a855-158a2872878b"><td class="cell-)drg">3</td><td class="cell-title"><a href="https://www.notion.so/c-8e68898aaa9e46e6a855158a2872878b">â€œcâ€</a></td></tr><tr id="ed854780-23c8-4082-96c3-7aaa09d37b2e"><td class="cell-)drg">3</td><td class="cell-title"><a href="https://www.notion.so/d-ed85478023c8408296c37aaa09d37b2e">â€œdâ€</a></td></tr><tr id="bdd13284-6cc0-4b1f-be62-7d30852fe6d8"><td class="cell-)drg">4</td><td class="cell-title"><a href="https://www.notion.so/c-bdd132846cc04b1fbe627d30852fe6d8">â€œcâ€</a></td></tr><tr id="259cb691-6d18-4666-be4a-87bc26b9da5b"><td class="cell-)drg">4</td><td class="cell-title"><a href="https://www.notion.so/d-259cb6916d184666be4a87bc26b9da5b">â€œdâ€</a></td></tr></tbody></table></div><pre id="3b0138a9-134f-48ce-a09e-93561829685e" class="code"><code>select 
	mycol1,
	mycol2
from 
	table1
alteral  view explode(array) adtable as mycol1 
alteral  view explode(col2)  adtable as mycol2</code></pre><hr id="d91ad233-305d-45b4-8785-a79e772b2d6e"/><h2 id="57c4be99-d24a-4a0e-907b-b8968b2130a6" class="">çª—å£å‡½æ•°</h2><ol id="450be831-1d16-4178-a6a7-366bde448a1d" class="numbered-list" start="1"><li>å‡½æ•°</li></ol><div id="1d4b120e-5300-4ce5-98cb-867350a8391a" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>å‡½æ•°å</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>å®šä¹‰</th></tr></thead><tbody><tr id="2510d06f-75b6-4dd3-8cde-44f4630ce24b"><td class="cell-title"><a href="https://www.notion.so/over-2510d06f75b64dd38cde44f4630ce24b">over()</a></td><td class="cell-zDUJ">æŒ‡å®šåˆ†æå‡½æ•°å·¥ä½œçš„æ•°æ®çª—å£å¤§å°ï¼Œè¿™ä¸ªæ•°æ®çª—å£å¤§å°å¯èƒ½ä¼šéšç€è¡Œçš„å˜åŒ–è€Œå˜åŒ–</td></tr><tr id="c637e12f-1a20-4961-b8ef-b8f2bdceeeb3"><td class="cell-title"><a href="https://www.notion.so/c637e12f1a204961b8efb8f2bdceeeb3">å¸¸è·Ÿçš„å‡½æ•°</a></td><td class="cell-zDUJ">è¯´æ˜</td></tr><tr id="cabd2a25-298a-43a3-b73a-85a7239f8d9e"><td class="cell-title"><a href="https://www.notion.so/cabd2a25298a43a3b73a85a7239f8d9e">â€”</a></td><td class="cell-zDUJ">â€”</td></tr><tr id="94d37b22-a87e-41ab-ac5d-81b4a9e93713"><td class="cell-title"><a href="https://www.notion.so/current-row-94d37b22a87e41abac5d81b4a9e93713">current row</a></td><td class="cell-zDUJ">å½“å‰è¡Œ</td></tr><tr id="0b9012d5-7a21-4691-981e-d5380e3b9489"><td class="cell-title"><a href="https://www.notion.so/n-preceding-0b9012d57a214691981ed5380e3b9489">n preceding</a></td><td class="cell-zDUJ">å¾€å‰nè¡Œæ•°æ®</td></tr><tr id="1913549c-8fd0-4836-ad7e-a19fd3119eb0"><td class="cell-title"><a href="https://www.notion.so/n-following-1913549c8fd04836ad7ea19fd3119eb0">n following</a></td><td class="cell-zDUJ">å¾€ånè¡Œæ•°æ®</td></tr><tr id="86ddfea6-fecb-4929-ad75-685ba3322a07"><td class="cell-title"><a href="https://www.notion.so/unbounded-86ddfea6fecb4929ad75685ba3322a07">unbounded</a></td><td class="cell-zDUJ">èµ·ç‚¹</td></tr><tr id="b405d8c8-abf9-4251-9a8f-91441fc80ec6"><td class="cell-title"><a href="https://www.notion.so/unbounded-preceding-b405d8c8abf942519a8f91441fc80ec6">unbounded preceding</a></td><td class="cell-zDUJ">ä»ä¸€å¼€å§‹çš„èµ·ç‚¹å¼€å§‹</td></tr><tr id="b8dfdc11-6da8-459a-be9c-eb020912be2f"><td class="cell-title"><a href="https://www.notion.so/unbounded-following-b8dfdc116da8459abe9ceb020912be2f">unbounded following</a></td><td class="cell-zDUJ">åˆ°æœ€åçš„ç»ˆç‚¹</td></tr><tr id="8d22da1d-a69c-46da-85fa-4b211c669715"><td class="cell-title"><a href="https://www.notion.so/lag-col-n-8d22da1da69c46da85fa4b211c669715">lag(col, n)</a></td><td class="cell-zDUJ">å¾€å‰ç¬¬nè¡Œæ•°æ®</td></tr><tr id="c56a57f6-27bf-450d-ac04-434b6693736c"><td class="cell-title"><a href="https://www.notion.so/lead-col-n-c56a57f627bf450dac04434b6693736c">lead(col, n)</a></td><td class="cell-zDUJ">å¾€åç¬¬nè¡Œæ•°æ®</td></tr><tr id="90d41b4d-a3e8-4438-8eac-6c1c27350166"><td class="cell-title"><a href="https://www.notion.so/ntile-n-90d41b4da3e844388eac6c1c27350166">ntile(n)</a></td><td class="cell-zDUJ">æŠŠæœ‰åºåˆ†åŒºä¸­çš„è¡Œåˆ†å‘åˆ°æŒ‡å®šæ•°æ®çš„ç»„ä¸­ï¼Œ å„ä¸ªç»„æœ‰ç¼–å·ï¼Œç¼–å·ä»1å¼€å§‹ï¼Œntileè¿”å›æ­¤è¡Œæ‰€å±ç»„çš„ç¼–å·</td></tr><tr id="9ee9f1c9-8bc9-4958-a393-9620683da120"><td class="cell-title"><a href="https://www.notion.so/first_value-9ee9f1c98bc94958a3939620683da120">first_value()</a></td><td class="cell-zDUJ">è¿”å›ç»„ä¸­æ•°æ®çª—å£çš„ç¬¬ä¸€ä¸ªå€¼</td></tr><tr id="31251695-757a-4fe4-a2dc-723dcfb86e4b"><td class="cell-title"><a href="https://www.notion.so/last_value-31251695757a4fe4a2dc723dcfb86e4b">last_value()</a></td><td class="cell-zDUJ">è¿”å›ç»„ä¸­æ•°æ®çª—å£çš„æœ€åä¸€ä¸ªå€¼</td></tr></tbody></table></div><ol id="c0d36fde-42fb-4f26-9106-f3aa918073b7" class="numbered-list" start="1"><li>æ¡ˆä¾‹</li></ol><div id="b1f51811-19e4-48ec-bb10-91f200d1df47" class="collection-content"><h4 class="collection-title">business</h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>name</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesDate"><path d="M10.8889,5.5 L3.11111,5.5 L3.11111,7.05556 L10.8889,7.05556 L10.8889,5.5 Z M12.4444,1.05556 L11.6667,1.05556 L11.6667,0 L10.1111,0 L10.1111,1.05556 L3.88889,1.05556 L3.88889,0 L2.33333,0 L2.33333,1.05556 L1.55556,1.05556 C0.692222,1.05556 0.00777777,1.75556 0.00777777,2.61111 L0,12.5 C0,13.3556 0.692222,14 1.55556,14 L12.4444,14 C13.3,14 14,13.3556 14,12.5 L14,2.61111 C14,1.75556 13.3,1.05556 12.4444,1.05556 Z M12.4444,12.5 L1.55556,12.5 L1.55556,3.94444 L12.4444,3.94444 L12.4444,12.5 Z M8.55556,8.61111 L3.11111,8.61111 L3.11111,10.1667 L8.55556,10.1667 L8.55556,8.61111 Z"></path></svg></span>orderdate</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesNumber"><path d="M4.46191,0 C3.8667,0 3.38428,0.482422 3.38428,1.07751 L3.38428,3.38425 L1.07764,3.38425 C0.482422,3.38425 0,3.86667 0,4.46179 C0,5.05688 0.482422,5.53931 1.07764,5.53931 L3.38428,5.53931 L3.38428,8.46063 L1.07764,8.46063 C0.482422,8.46063 0,8.94308 0,9.53818 C0,10.1333 0.482422,10.6157 1.07764,10.6157 L3.38428,10.6157 L3.38428,12.9224 C3.38428,13.5175 3.8667,13.9999 4.46191,13.9999 C5.05664,13.9999 5.53906,13.5175 5.53906,12.9224 L5.53906,10.6157 L8.46045,10.6157 L8.46045,12.9224 C8.46045,13.5175 8.94287,13.9999 9.53809,13.9999 C10.1333,13.9999 10.6157,13.5175 10.6157,12.9224 L10.6157,10.6157 L12.9224,10.6157 C13.5176,10.6157 14,10.1333 14,9.53818 C14,8.94308 13.5176,8.46063 12.9224,8.46063 L10.6157,8.46063 L10.6157,5.53931 L12.9224,5.53931 C13.5176,5.53931 14,5.05688 14,4.46179 C14,3.86667 13.5176,3.38425 12.9224,3.38425 L10.6157,3.38425 L10.6157,1.07751 C10.6157,0.482422 10.1333,0 9.53809,0 C8.94287,0 8.46045,0.482422 8.46045,1.07751 L8.46045,3.38425 L5.53906,3.38425 L5.53906,1.07751 C5.53906,0.482422 5.05664,0 4.46191,0 Z M5.53906,8.46063 L5.53906,5.53931 L8.46045,5.53931 L8.46045,8.46063 L5.53906,8.46063 Z"></path></svg></span>cost</th></tr></thead><tbody><tr id="77fd708d-2894-4864-aa14-c2b0841a488e"><td class="cell-title"><a href="https://www.notion.so/jack-77fd708d28944864aa14c2b0841a488e">jack</a></td><td class="cell-~Icz"><time>@2017/01/01</time></td><td class="cell-H&amp;37">10</td></tr><tr id="9cd28569-47eb-4ef1-9a19-a45a37155fc8"><td class="cell-title"><a href="https://www.notion.so/tony-9cd2856947eb4ef19a19a45a37155fc8">tony</a></td><td class="cell-~Icz"><time>@2017/01/02</time></td><td class="cell-H&amp;37">15</td></tr><tr id="10f99a8b-7a3f-41f2-b930-116ba27826fc"><td class="cell-title"><a href="https://www.notion.so/jack-10f99a8b7a3f41f2b930116ba27826fc">jack</a></td><td class="cell-~Icz"><time>@2017/01/03</time></td><td class="cell-H&amp;37">23</td></tr><tr id="a484106c-775c-4991-9973-80c272f6ac02"><td class="cell-title"><a href="https://www.notion.so/tony-a484106c775c4991997380c272f6ac02">tony</a></td><td class="cell-~Icz"><time>@2017/01/04</time></td><td class="cell-H&amp;37">29</td></tr><tr id="b5d192b0-6e44-4d74-b667-7cd46628309e"><td class="cell-title"><a href="https://www.notion.so/jack-b5d192b06e444d74b6677cd46628309e">jack</a></td><td class="cell-~Icz"><time>@2017/01/05</time></td><td class="cell-H&amp;37">46</td></tr><tr id="8f132765-d9d7-4692-aab6-b1d1dce02631"><td class="cell-title"><a href="https://www.notion.so/jack-8f132765d9d74692aab6b1d1dce02631">jack</a></td><td class="cell-~Icz"><time>@2017/04/06</time></td><td class="cell-H&amp;37">42</td></tr><tr id="a2cc85eb-64f2-439a-8b79-e960306989d5"><td class="cell-title"><a href="https://www.notion.so/tony-a2cc85eb64f2439a8b79e960306989d5">tony</a></td><td class="cell-~Icz"><time>@2017/01/07</time></td><td class="cell-H&amp;37">50</td></tr><tr id="ac887faf-e641-4d2f-ab69-1a9c48b3773f"><td class="cell-title"><a href="https://www.notion.so/jack-ac887fafe6414d2fab691a9c48b3773f">jack</a></td><td class="cell-~Icz"><time>@2017/01/08</time></td><td class="cell-H&amp;37">55</td></tr><tr id="add5ccdd-d98e-4f41-9c85-6d4df53f7a26"><td class="cell-title"><a href="https://www.notion.so/mart-add5ccddd98e4f419c856d4df53f7a26">mart</a></td><td class="cell-~Icz"><time>@2017/04/08</time></td><td class="cell-H&amp;37">62</td></tr><tr id="eacbe2aa-5ab6-44d4-b84b-a5e54835694b"><td class="cell-title"><a href="https://www.notion.so/mart-eacbe2aa5ab644d4b84ba5e54835694b">mart</a></td><td class="cell-~Icz"><time>@2017/04/09</time></td><td class="cell-H&amp;37">68</td></tr><tr id="d8c2bee6-d66a-4656-a31d-5c73d97128a5"><td class="cell-title"><a href="https://www.notion.so/neil-d8c2bee6d66a4656a31d5c73d97128a5">neil</a></td><td class="cell-~Icz"><time>@2017/05/10</time></td><td class="cell-H&amp;37">12</td></tr><tr id="0de9b0de-1d02-4f09-911c-68411e2dc665"><td class="cell-title"><a href="https://www.notion.so/mart-0de9b0de1d024f09911c68411e2dc665">mart</a></td><td class="cell-~Icz"><time>@2017/04/11</time></td><td class="cell-H&amp;37">75</td></tr><tr id="a5828844-5452-4347-a979-29a5efc46097"><td class="cell-title"><a href="https://www.notion.so/neil-a582884454524347a97929a5efc46097">neil</a></td><td class="cell-~Icz"><time>@2017/06/12</time></td><td class="cell-H&amp;37">80</td></tr><tr id="bef4784e-ea82-4881-b952-53ca381aeb26"><td class="cell-title"><a href="https://www.notion.so/mart-bef4784eea824881b95253ca381aeb26">mart</a></td><td class="cell-~Icz"><time>@2017/04/13</time></td><td class="cell-H&amp;37">94</td></tr></tbody></table></div><ul id="323dbb5e-80d5-4129-a47c-df4c759de47c" class="bulleted-list"><li>æŸ¥è¯¢åœ¨2017å¹´4æœˆè´­ä¹°çš„é¡¾å®¢åŠæ€»äººæ•°</li></ul><pre id="4d6863a9-86a4-4b33-bcce-27f17e560559" class="code"><code>select 
	name,
count( *)over()
from 
business
where 
substring(hit_date, 1,7) = &#x27;2017-04&#x27;
group by 
name </code></pre><div id="f01b633d-e769-44dc-aef4-092b1ec908f7" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>name</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesNumber"><path d="M4.46191,0 C3.8667,0 3.38428,0.482422 3.38428,1.07751 L3.38428,3.38425 L1.07764,3.38425 C0.482422,3.38425 0,3.86667 0,4.46179 C0,5.05688 0.482422,5.53931 1.07764,5.53931 L3.38428,5.53931 L3.38428,8.46063 L1.07764,8.46063 C0.482422,8.46063 0,8.94308 0,9.53818 C0,10.1333 0.482422,10.6157 1.07764,10.6157 L3.38428,10.6157 L3.38428,12.9224 C3.38428,13.5175 3.8667,13.9999 4.46191,13.9999 C5.05664,13.9999 5.53906,13.5175 5.53906,12.9224 L5.53906,10.6157 L8.46045,10.6157 L8.46045,12.9224 C8.46045,13.5175 8.94287,13.9999 9.53809,13.9999 C10.1333,13.9999 10.6157,13.5175 10.6157,12.9224 L10.6157,10.6157 L12.9224,10.6157 C13.5176,10.6157 14,10.1333 14,9.53818 C14,8.94308 13.5176,8.46063 12.9224,8.46063 L10.6157,8.46063 L10.6157,5.53931 L12.9224,5.53931 C13.5176,5.53931 14,5.05688 14,4.46179 C14,3.86667 13.5176,3.38425 12.9224,3.38425 L10.6157,3.38425 L10.6157,1.07751 C10.6157,0.482422 10.1333,0 9.53809,0 C8.94287,0 8.46045,0.482422 8.46045,1.07751 L8.46045,3.38425 L5.53906,3.38425 L5.53906,1.07751 C5.53906,0.482422 5.05664,0 4.46191,0 Z M5.53906,8.46063 L5.53906,5.53931 L8.46045,5.53931 L8.46045,8.46063 L5.53906,8.46063 Z"></path></svg></span>c1</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesNumber"><path d="M4.46191,0 C3.8667,0 3.38428,0.482422 3.38428,1.07751 L3.38428,3.38425 L1.07764,3.38425 C0.482422,3.38425 0,3.86667 0,4.46179 C0,5.05688 0.482422,5.53931 1.07764,5.53931 L3.38428,5.53931 L3.38428,8.46063 L1.07764,8.46063 C0.482422,8.46063 0,8.94308 0,9.53818 C0,10.1333 0.482422,10.6157 1.07764,10.6157 L3.38428,10.6157 L3.38428,12.9224 C3.38428,13.5175 3.8667,13.9999 4.46191,13.9999 C5.05664,13.9999 5.53906,13.5175 5.53906,12.9224 L5.53906,10.6157 L8.46045,10.6157 L8.46045,12.9224 C8.46045,13.5175 8.94287,13.9999 9.53809,13.9999 C10.1333,13.9999 10.6157,13.5175 10.6157,12.9224 L10.6157,10.6157 L12.9224,10.6157 C13.5176,10.6157 14,10.1333 14,9.53818 C14,8.94308 13.5176,8.46063 12.9224,8.46063 L10.6157,8.46063 L10.6157,5.53931 L12.9224,5.53931 C13.5176,5.53931 14,5.05688 14,4.46179 C14,3.86667 13.5176,3.38425 12.9224,3.38425 L10.6157,3.38425 L10.6157,1.07751 C10.6157,0.482422 10.1333,0 9.53809,0 C8.94287,0 8.46045,0.482422 8.46045,1.07751 L8.46045,3.38425 L5.53906,3.38425 L5.53906,1.07751 C5.53906,0.482422 5.05664,0 4.46191,0 Z M5.53906,8.46063 L5.53906,5.53931 L8.46045,5.53931 L8.46045,8.46063 L5.53906,8.46063 Z"></path></svg></span>ä¸åŠ over</th></tr></thead><tbody><tr id="b1b1246d-2b44-4675-955f-32ab1ab325cf"><td class="cell-title"><a href="https://www.notion.so/jack-b1b1246d2b444675955f32ab1ab325cf">jack</a></td><td class="cell-M}Bn">2</td><td class="cell-8NI5">1</td></tr><tr id="833b1979-b50e-45bc-8448-a9d6d6e6bb1c"><td class="cell-title"><a href="https://www.notion.so/mart-833b1979b50e45bc8448a9d6d6e6bb1c">mart</a></td><td class="cell-M}Bn">2</td><td class="cell-8NI5">4</td></tr></tbody></table></div><ul id="30437bb1-6e04-47ea-89e3-20197510df71" class="bulleted-list"><li>æŸ¥è¯¢é¡¾å®¢çš„è´­ä¹°æ˜ç»†åŠæœˆè´­ä¹°æ€»é¢</li></ul><pre id="5034b91e-2fee-4af0-9e69-e29de16d4f6a" class="code"><code>select 
*,
sum(cost)over(distribute by month(orderdate))
--sum(cost)over(partition by month(orderdate))
from 
business</code></pre><ul id="6fb3bc42-cbb1-4c5a-a6ca-c695f766717d" class="bulleted-list"><li>è¦å°†costæŒ‰ç…§æ—¥æœŸè¿›è¡Œç´¯åŠ </li></ul><pre id="b1b33223-c762-4c36-abb3-70f9db3ef6d8" class="code"><code>select 
	*,
	sum(cost)over( order by orderdate   rows between unbounded preceding and  current row)
--å…ˆæ’åºï¼Œä¹‹åæŒ‰ç…§é¡ºåºï¼Œä»èµ·åˆ°åˆ°å½“å‰è¡Œè¿›è¡Œæ±‚å’Œ
--sumæ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯count(distinct user_account) å°±ä¸èƒ½ç”¨è¿™ç§æ–¹æ³•
from 
	business</code></pre><ul id="9ed7af51-1eb4-4396-bdee-b890cbe19ad1" class="bulleted-list"><li>æŒ‰ç…§æ—¥æœŸè¿›è¡Œæ’åºï¼Œå¹¶å°†å½“å‰æ—¥æœŸå’Œå‰ä¸€å¤©ã€åä¸€å¤©æ•°æ®æ±‚å’Œ</li></ul><pre id="f5111c4b-b2ad-4aeb-8f90-72940e4b24f1" class="code"><code>select 
*,
sum(cost) over(order by  orderdate  rows between 1   preceding  between  1 following ) 
from business  </code></pre><ul id="a6ce5144-fa3f-4d3e-917b-ddd40d964530" class="bulleted-list"><li>æ±‚æ¯ä¸ªäººå°†æŒ‰ç…§æ—¥æœŸè¿›è¡Œç´¯åŠ çš„æ¶ˆè´¹é‡‘é¢</li></ul><pre id="80b1e5d7-9291-4a7b-a4f7-41e723f72a10" class="code"><code>select 
name, 
sum(cost) over ( partition by name order by  orderdate  row between unbounded preceding and current row) 
from  business 
group by 
name </code></pre><ul id="50c11415-bedc-484e-b93b-69d35dcfcb19" class="bulleted-list"><li>è¦å°†costæŒ‰ç…§æ—¥æœŸè¿›è¡Œå€’åºç´¯åŠ </li></ul><pre id="ed61f934-98b2-4f11-bdf8-47b912bd9507" class="code"><code> select 
*,
sum(cost) over ( order by orderdate desc row between unbounded preceding and current row)
from 
business </code></pre><ul id="874f33e5-4322-4809-a3c1-392dab2c911d" class="bulleted-list"><li>æŸ¥è¯¢é¡¾å®¢çš„ä¸Šæ¬¡è´­ä¹°æ—¶é—´</li></ul><pre id="a0f0cd46-952f-46f4-a4a7-a5376542b0b4" class="code"><code>select 
*ï¼Œ
lag(orderdate,1)over( partation by name order by  orderdate)
from 
business</code></pre><ul id="81dee30a-4827-41ae-a2cb-2da78c4d151a" class="bulleted-list"><li>æŸ¥è¯¢é¡¾å®¢ä¸Šæ¬¡è´­ä¹°çš„æ—¶é—´, ä¸ä¸‹æ¬¡è´­ä¹°æ—¶é—´ã€‚ç›¸é‚»ä¸¤ä¸ªæ—¶é—´æˆ³å¦‚ä½•ç›¸å‡ï¼Œæ±‚æ—¶é—´</li></ul><pre id="dbe905d1-9c98-4a2f-8d9e-0e531345ec16" class="code"><code>select 
*,
lag(orderdate, 1) over (partition by name order by orderdate) as up_date,
lead(orderdate, 1) over (partition by name order by orderdate) as downdate
from 
business </code></pre><ul id="f771fb51-9d72-4143-8bd6-d34a5a7e0a57" class="bulleted-list"><li>æŸ¥è¯¢å‰20%æ—¶é—´çš„è®¢å•ä¿¡æ¯</li></ul><pre id="e154033a-1e62-497d-a952-2545319a701a" class="code"><code>select 
* 
from 
	(select 
		name,
		orderdate,
		cost,
		ntile(5)over(order by orderdate) as git
		from 
		business)
where 
git = 1</code></pre><ul id="4c4f40a7-15ab-45e9-becf-01da88d451ba" class="bulleted-list"><li><a href="https://www.cnblogs.com/52xf/p/4209211.html"><strong>ntileå‡½æ•°è¯¦è§£</strong></a> ntileå‡½æ•°å¯ä»¥å°†æœ‰åºæ•°æ®ï¼Œæ ¹æ®æŒ‡å®šçš„ç»„æ•°è¿›è¡Œåˆ†ç»„å¤„ç†ã€‚ ç¼–å·ä»1å¼€å§‹ï¼Œå¯¹äºæ¯ä¸€è¡Œï¼Œntileå°†è¿”å›æ­¤è¡Œæ‰€å±çš„ç»„ç¼–å·ã€‚ ntileå‡½æ•°çš„åˆ†ç»„ä¾æ®ï¼š</li></ul><ul id="d5282e8c-25e2-40d7-9fdf-3444f582e2c6" class="bulleted-list"><li>æ¯ç»„åŒ…å«çš„æ•°æ®ä¸ªæ•°ä¸èƒ½å¤§äºå®ƒä¸Šä¸€ç»„ åŒ…å«çš„æ•°æ®ä¸ªæ•°</li></ul><ul id="8b4db160-bff2-4fb6-9a5c-26ff586c7f09" class="bulleted-list"><li>è®¡ç®—è§„åˆ™ï¼š1. æ£€æŸ¥èƒ½ä¸èƒ½å¯¹æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„è®°å½•è¿›è¡Œå¹³å‡åˆ†ç»„ï¼Œè‹¥èƒ½åˆ™ç›´æ¥å¹³å‡åˆ†é…å®Œæˆåˆ†ç»„ã€‚2. è‹¥ä¸èƒ½ï¼Œåˆ™ä¼šå…ˆåˆ†å‡ºä¸€ä¸ªç»„ï¼Œæ­¤ç»„ä¸ªæ•°ä¸ºï¼ˆæ€»ä¸ªæ•°/æ€»ç»„æ•°ï¼‰+1ã€‚3. åˆ†é…ä¹‹åç³»ç»Ÿä¼šç»§ç»­æ¯”è¾ƒä½™ä¸‹çš„è®°å½•æ•°ä¸æœªåˆ†é…çš„ç»„æ•°èƒ½ä¸èƒ½è¿›è¡Œå¹³å‡åˆ†é…ï¼Œè‹¥ä¸èƒ½ï¼Œåˆ™æ ¹æ®ä¸Šé¢æ¡ä»¶å†åˆ†é…ã€‚</li></ul><ul id="72fc479a-a3fe-4b43-bb38-f2c3fe9b61d5" class="bulleted-list"><li>ä¾‹å¦‚ï¼šå°†6ä¸ªè®°å½•åˆ†ä¸º4ç»„ï¼Œ ä¸èƒ½å¹³å‡åˆ†é…åˆ™ï¼Œç¬¬ä¸€ç»„è®°å½•æ•°ä¸º ï¼ˆ6/4)+1 = 2æ¡è®°å½•ã€‚å‰©ä½™4æ¡è®°å½•åˆ†ä¸º3ç»„ï¼Œä¸èƒ½å¹³å‡åˆ†é…ï¼Œåˆ™ç¬¬äºŒç»„è®°å½•æ•°ä¸ºï¼ˆ4/3)+1=2æ¡è®°å½•ã€‚å‰©ä½™2æ¡è®°å½•åˆ†ä¸º2ç»„ï¼Œåˆ™å‰©ä½™2ç»„å„1æ¡è®°å½•ã€‚</li></ul><h2 id="375a2cb2-2343-43f0-ade3-529e35b5dd98" class="">æ’åºå‡½æ•°</h2><ol id="d1ededfb-f75e-415b-9b7d-6521df63bd5e" class="numbered-list" start="1"><li>å‡½æ•°</li></ol><p id="7f7d0c94-6217-494f-903d-c53e2950ebb7" class="">SQl ä¸­ç”¨äºæ’åºçš„å‡½æ•°æœ‰ï¼šrankã€dense_rankã€row_numberã€ntileå‡½æ•°,å…¶è¯­æ³•ä¸ºï¼š</p><pre id="e6c82981-63bf-45fe-9575-36583cebc5ca" class="code"><code>rank() over ( partition by A ORDER BY B  desc )   ---1ã€1ã€3
dense_rank() over (partition by A order by B desc)  --- 1ã€1ã€2
row_number() over (partition by A ORDER BY b desc)    --1ã€2ã€3
ntile() over (partition by A ORDER BY b desc)      --åˆ†ç»„</code></pre><ul id="8bf06e0f-bdcc-4e6e-980e-e18c4688264e" class="bulleted-list"><li>å¦‚ä½•æ‰¾å‡ºå„çœç‚¹å‡»äººæ•°Top10çš„æŒ‰é’®ï¼Ÿ</li></ul><p id="ca0406be-7f55-4a02-929d-151ab30eaead" class="">å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œé¦–å…ˆè¦ç†æ¸…è‡ªå·±çš„æ€è·¯ï¼š1. å–å‡º çœä»½ã€æŒ‰é’®å’Œ uv;2. å„çœåˆ†ç»„å†…ï¼ŒæŒ‰ç…§uvè¿›è¡Œä»å¤§åˆ°å°æ’åºï¼Œå¹¶è¾“å‡ºä¸€åˆ—æ’åºåºå·;3. æ ¹æ®æ’åºåºå·ï¼Œå–å‡ºæ’åºå‰10çš„æŒ‰é’®å’Œçœä»½ã€‚ </p><pre id="ddf88073-264b-4476-b2f3-15f0cf855fc8" class="code"><code>select 
province,
nbtn_name
from 
(
select 
    province,  --çœä»½
    nbtn_name, --æŒ‰é’® 
    uv,        --uv
    dense_rank()over(partition by province order by uv  DESC) as ran --æ’åº
from 
(select
    province,
    nbtn_name,
    count(distinct user_account) as uv
from 
table 
where 
    nbtn_name is not null  
    and 
    hit_date = &#x27;2020-06-01&#x27;
group by 
    province,
    nbtn_name))
where 
ran between &#x27;1&#x27; and &#x27;10&#x27;</code></pre><ul id="53a1cce2-1730-4df0-8a74-cac9425b7040" class="bulleted-list"><li>æ±‚è¿ç»­3ä¸ªæœˆæ´»è·ƒçš„ç”¨æˆ·æ•°</li></ul><pre id="f1f38f5f-163f-484d-8a9c-24fab4d7851a" class="code"><code>select 
count(distinct user_account) as uv 
from 
(
select 
dt,
user_account,
dense_rank()over(partition by user_account order by dt) as raws
from 
(

(select 
user_account,
month(hit_date)  as dt 
from 
table1
where 
hit_date between &#x27;2020-04-01&#x27; and &#x27;2020-06-31&#x27;
group by 
user_account, dt) a1
) a2
)
where 
a2.raws = 3</code></pre><ul id="59f6b849-a23f-4c76-8b9b-8fe92324f636" class="bulleted-list"><li>æ±‚4æœˆè¿ç»­7å¤©è¿›è¡Œç­¾åˆ°çš„ç”¨æˆ·æ•°</li></ul><pre id="3e15ecae-46ad-4ad4-ad6f-3b43da6d10b4" class="code"><code>----1. æ±‚å‡ºæ‰‹æœºå·å’Œæ—¥æœŸï¼Œå¹¶å»é‡
----2. æ ¹æ®æ‰‹æœºå·ï¼Œå¯¹æ—¥æœŸè¿›è¡Œæ’åºï¼Œå¹¶ä¸”æ—¥æœŸå’Œæ’åºè¿›è¡Œç›¸å‡
----3. å¯¹ç›¸å‡åå¾—åˆ°çš„æ—¥æœŸè¿›è¡Œç»Ÿè®¡ï¼Œå¹¶è®¡ç®—æ•°é‡å¤§äº7çš„ç”¨æˆ·
----4. å¯¹æ•°é‡å¤§äº7çš„ç”¨æˆ·è¿›è¡Œå»é‡å¤„ç†

select 
count(distinct user_account) as uv 
from 
(
select 
	user_account,
	raw,
	count(raw) as raw_1
from 
(
		select 
			user_account,
				hit_date,
			date_sub(hit_date, row_number()over(partition by user_account order by hit_date) )as raw
	from 
		(
		select
			user_account,
			hit_date
		from 
			apache_computer_view.client_android_log
		where 
			hit_date between &#x27;2020-04-01&#x27; and &#x27;2020-04-31&#x27;
		group by 
			user_account,
			hit_date))
group by 
	user_account,
	raw)
where 
raw_1 &gt;= 7</code></pre><hr id="01eb6e95-ac87-4521-a910-7d44521f09c2"/><h2 id="c046dcfb-82c8-40f5-b593-d68f0e64bead" class="">å­—ç¬¦ä¸²å‡½æ•°</h2><ol id="fdb5ad8e-af9a-4972-bc5a-7729ed71d531" class="numbered-list" start="1"><li>å‡½æ•°</li></ol><div id="5ddc2ea0-afb1-42c8-8167-28fe78c521a7" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>å‡½æ•°å</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>å®šä¹‰</th></tr></thead><tbody><tr id="de2f80ad-07fe-485c-8ba3-d4d665bea3c1"><td class="cell-title"><a href="https://www.notion.so/concat-de2f80ad07fe485c8ba3d4d665bea3c1">concat()</a></td><td class="cell-Brx^">æ‹¼æ¥å­—ç¬¦ä¸²</td></tr><tr id="4563b5eb-a31d-4250-8e83-652502b2c77e"><td class="cell-title"><a href="https://www.notion.so/length-4563b5eba31d42508e83652502b2c77e">length()</a></td><td class="cell-Brx^">è®¡ç®—å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œä¸€ä¸ªæ±‰å­—ç®—ä¸‰ä¸ªå­—ç¬¦</td></tr><tr id="7d47dd7b-b263-4f20-8e7c-66029b278fa5"><td class="cell-title"><a href="https://www.notion.so/instr-A-B-7d47dd7bb2634f208e7c66029b278fa5">instr (A ,B )</a></td><td class="cell-Brx^">è¿”å›å­—ç¬¦Bé¦–æ¬¡åœ¨Aä¸­å‡ºç°çš„ä½ç½®,ä¸å­˜åœ¨è¿”å›0</td></tr><tr id="abd899f7-00a7-4503-8986-7b1d9f2b95b2"><td class="cell-title"><a href="https://www.notion.so/lcase-abd899f700a7450389867b1d9f2b95b2">lcase()</a></td><td class="cell-Brx^">è½¬æ¢æˆå°å†™</td></tr><tr id="ca82d236-58a2-48fa-bc1a-159aea633fb9"><td class="cell-title"><a href="https://www.notion.so/left-string2-length-ca82d23658a248fabc1a159aea633fb9">left(string2 ,length )</a></td><td class="cell-Brx^">ä»string2ä¸­çš„å·¦è¾¹èµ·å–lengthä¸ªå­—ç¬¦</td></tr><tr id="42efe635-85da-4d7f-90dd-e1d0e629cfdf"><td class="cell-title"><a href="https://www.notion.so/lower-42efe63585da4d7f90dde1d0e629cfdf">lower()</a></td><td class="cell-Brx^">å°†å­—ä¸²è½¬åŒ–ä¸ºå°å†™</td></tr><tr id="b1c5a338-a2a3-4b0a-9a2a-83e0d63c3ed5"><td class="cell-title"><a href="https://www.notion.so/upper-b1c5a338a2a34b0a9a2a83e0d63c3ed5">upper()</a></td><td class="cell-Brx^">å°†å­—ç¬¦è½¬åŒ–ä¸ºå¤§å†™</td></tr><tr id="48cb750e-89ab-485a-9c03-315691cafcaa"><td class="cell-title"><a href="https://www.notion.so/replace-48cb750e89ab485a9c03315691cafcaa">replace()</a></td><td class="cell-Brx^">æ›¿æ¢å­—ç¬¦</td></tr><tr id="24ce6387-d79a-4e9e-a1bc-8a1fdf1a6569"><td class="cell-title"><a href="https://www.notion.so/split-24ce6387d79a4e9ea1bc8a1fdf1a6569">split()</a></td><td class="cell-Brx^">hiveå­—ç¬¦ä¸²åˆ†å‰²å‡½æ•°</td></tr><tr id="96a590f6-7083-4aac-9b4a-88e6c72be215"><td class="cell-title"><a href="https://www.notion.so/substr-96a590f670834aac9b4a88e6c72be215">substr()</a></td><td class="cell-Brx^">è¿”å›å­—ç¬¦ä¸²Aä»startä½ç½®å¼€å§‹ï¼Œé•¿åº¦ä¸ºlençš„å­—ç¬¦ä¸²</td></tr><tr id="07724a1f-d9fd-440b-8e2f-720bc190c469"><td class="cell-title"><a href="https://www.notion.so/substring-07724a1fd9fd440b8e2f720bc190c469">substring()</a></td><td class="cell-Brx^">æˆªå–å­—ç¬¦ä¸²</td></tr><tr id="725742c6-41b4-40ac-83b9-cf70493c0a83"><td class="cell-title"><a href="https://www.notion.so/substring_index-725742c641b440ac83b9cf70493c0a83">substring_index()</a></td><td class="cell-Brx^">é€šè¿‡æˆªå–è·å–ä¸åŒç´¢å¼•ä½çš„å­—ç¬¦</td></tr><tr id="d64e4685-0f5b-4393-a958-51b09fafd7ba"><td class="cell-title"><a href="https://www.notion.so/LTRIM-string2-d64e46850f5b4393a95851b09fafd7ba">LTRIM (string2 )</a></td><td class="cell-Brx^">å»é™¤å‰ç«¯ç©ºæ ¼</td></tr><tr id="74d0f54d-fb20-4b61-ba15-7d4480db1d4c"><td class="cell-title"><a href="https://www.notion.so/RTRIM-string2-74d0f54dfb204b61ba157d4480db1d4c">RTRIM (string2 )</a></td><td class="cell-Brx^">å»é™¤åç«¯ç©ºæ ¼</td></tr><tr id="d260043c-bb96-486f-9914-c87c155c72f5"><td class="cell-title"><a href="https://www.notion.so/lpad-d260043cbb96486f9914c87c155c72f5">lpad</a></td><td class="cell-Brx^">å·¦å¡«å……</td></tr><tr id="ac10ff7a-6c3c-4cca-9dde-80d38679e05f"><td class="cell-title"><a href="https://www.notion.so/rpad-ac10ff7a6c3c4cca9dde80d38679e05f">rpad</a></td><td class="cell-Brx^">åˆå¡«å……</td></tr><tr id="3110fa41-5ab7-4f81-b13d-a086cdb019f5"><td class="cell-title"><a href="https://www.notion.so/TRUNC-n1-n2-3110fa415ab74f81b13da086cdb019f5">TRUNCï¼ˆn1,n2ï¼‰</a></td><td class="cell-Brx^">æˆªæ–­å‡½æ•°ï¼Œn1è¡¨ç¤ºè¢«æˆªæ–­çš„æ•°å­—ï¼Œn2è¡¨ç¤ºè¦æˆªæ–­åˆ°é‚£ä¸€ä½ã€‚n2å¯ä»¥æ˜¯è´Ÿæ•°ï¼Œè¡¨ç¤ºæˆªæ–­å°æ•°ç‚¹å‰ã€‚ TRUNC(15.79,1) è¿”å›15.7</td></tr></tbody></table></div><ol id="2af3aaae-fadd-4b57-949f-ca24d499d312" class="numbered-list" start="1"><li>å‡½æ•°è¯¦è§£</li></ol><p id="100bbd94-0e4b-48ac-82b4-bfc5073932ea" class=""><strong>substrå‡½æ•°ä¸ substringå‡½æ•°ç”¨æ³•ç›¸åŒ:</strong></p><pre id="f4e44498-3c5e-474b-8ee0-a7c5ed8c573b" class="code"><code>substr/substring( A, kå¼€å§‹æˆªå–çš„ä½ç½®ï¼Œæˆªå–é•¿åº¦)</code></pre><p id="cdeb200a-3d36-408d-bb87-c627f554f959" class="">ä¸¾ä¾‹ï¼š</p><pre id="3ae87b4f-447a-4dcc-9352-8784be8ed562" class="code"><code>substr(string,4): ä»å³ç¬¬4ä½ç½®æˆªå–åˆ°æœ€åï¼Œç»“æœä¸ºï¼šing
substr(string,1,3):å–å·¦è¾¹ç¬¬1ä½ç½®èµ·ï¼Œ3å­—é•¿çš„å­—ç¬¦ä¸²ï¼Œç»“æœä¸ºï¼šstr
substr(string,-3,3):å–å³è¾¹ç¬¬1ä½ç½®èµ·ï¼Œ3å­—é•¿çš„å­—ç¬¦ä¸²,å³è¾¹ç¬¬ä¸€ä½ç½®å¾€å³ä¸å¤Ÿ3å­—é•¿ï¼Œç»“æœä¸ºï¼šg
substr(string,-3,3):å–å³è¾¹ç¬¬1ä½ç½®èµ·ï¼Œ3å­—é•¿çš„å­—ç¬¦ä¸²ï¼Œç»“æœä¸ºï¼šing</code></pre><p id="9fb60ea4-7788-4f3f-b765-2b1d2d476740" class=""><strong>substring_indexå‡½æ•°</strong></p><pre id="072aaff8-8bf9-4024-a600-232e7974a92e" class="code"><code>substring_index(A, åˆ†å‰²çš„å­—ç¬¦,æˆªå–å­—ç¬¦çš„ä½ç½®)</code></pre><p id="4938fbb3-2cfa-4afd-8ce3-15f9a15d18ff" class="">ä¸¾ä¾‹ï¼š</p><pre id="4f82f715-9852-4a5d-8e3c-13a26d3b0dd9" class="code"><code>substring_index(&#x27;15,151,152,16&#x27;,&#x27;,&#x27;,1)ï¼šå–ç¬¬ä¸€ä¸ªé€—å·å‰é¢çš„å­—ç¬¦ä¸²ï¼Œç»“æœä¸ºï¼š15

substring_index(&#x27;15,151,152,16&#x27;,&#x27;,&#x27;,2)ï¼šå–ç¬¬äºŒä¸ªé€—å·å‰é¢éƒ¨åˆ†ï¼Œç»“æœä¸ºï¼š15,151

substring_index(&#x27;15,151,152,16&#x27;,&#x27;,&#x27;,-1)ï¼šå–ç›®æ ‡å­—ç¬¦ä¸²ä¸­æœ€åä¸€ä¸ªå« â€œ,â€ ä½å­çš„åçš„éƒ¨åˆ†ï¼Œç»“æœä¸ºï¼š16

substring_index(substring_index(&#x27;15,151,152,16&#x27;,&#x27;,&#x27;,2),&#x27;,&#x27;,-1):å–ç¬¬äºŒä¸ªé€—å·å‰é¢éƒ¨åˆ†,ç„¶åæœ€åé€—å·çš„å‰é¢éƒ¨åˆ†ï¼Œç»“æœä¸ºï¼š151

substring_index(substring_index(&#x27;15,151,152,16&#x27;,&#x27;,&#x27;,-2),&#x27;,&#x27;,1)ï¼šå–å€’æ•°ç¬¬äºŒä¸ªé€—å·åé¢éƒ¨åˆ†å­—ç¬¦ä¸²ï¼Œå†å»è¿™éƒ¨åˆ†é‡Œç¬¬ä¸€ä¸ªéƒ½å·å‰çš„éƒ¨åˆ†ï¼Œç»“æœä¸ºï¼š152
</code></pre><p id="b62cb020-1820-4ef4-941b-9a223355c06f" class=""><strong>splitå‡½æ•°</strong></p><pre id="44c73b08-aa92-4200-a9e3-70c82a805d7c" class="code"><code>split(A, åˆ†å‰²çš„å­—ç¬¦) </code></pre><p id="b4654d86-dfcf-4c7f-a571-ce6077bd02a3" class="">ä¸¾ä¾‹ï¼š</p><pre id="dfe8b551-dcf8-40da-8ec1-2a12e151783f" class="code"><code>split(&#x27;a,b,c,d&#x27;,&#x27;,&#x27;):æ ¹æ®é€—å·è¿›è¡Œåˆ†å‰²ï¼Œç»“æœä¸ºï¼š [&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;]

split(&#x27;a,b,c,d&#x27;,&#x27;,&#x27;)[0]ï¼š å–ç»“æœæ•°ç»„ä¸­çš„æŸä¸€é¡¹ï¼Œç»“æœä¸ºï¼š a

split(&#x27;192.168.0.1&#x27;,&#x27;\\.&#x27;)ï¼š ç‚¹å·è¿™ç§ç‰¹æ®Šå­—ç¬¦çš„æ—¶å€™éœ€è¦åšç‰¹æ®Šçš„å¤„ç†ï¼Œç»“æœä¸ºï¼š[&quot;192&quot;,&quot;168&quot;,&quot;0&quot;,&quot;1&quot;]

&quot;....  split(&#x27;192.168.0.1&#x27;,&#x27;\\\\.&#x27;) ... &quot;: splitåŒ…å«åœ¨ &quot;&quot; ä¹‹ä¸­æ—¶ éœ€è¦åŠ 4ä¸ª\,ä¸ç„¶å¾—åˆ°çš„å€¼æ˜¯null


åŒæ ·çš„ | ç­‰ç‰¹æ®Šç¬¦å·ä¹Ÿéœ€è¦åšç±»ä¼¼ å¤„ç†ã€‚
</code></pre><p id="64982df8-e7ce-49fe-b744-546b3d47f5a6" class="">3.åŒºåˆ†å‡½æ•°ä¹‹å‰çš„åŒºåˆ« * substrå‡½æ•°ä¸ substringå‡½æ•°æ˜¯æ ¹æ®æˆªå–çš„ä½ç½®æ¥è¿›è¡Œåˆ†å‰²ã€‚ * substring_indexå’Œsplitæ˜¯æ ¹æ®ç‰¹å®šçš„å­—ç¬¦æ¥è¿›è¡Œåˆ†å‰²ã€‚</p><ol id="e208925d-61ab-4060-91bd-53768a1f3ec3" class="numbered-list" start="1"><li>éœ€æ±‚</li></ol><ul id="1ead0610-a1cc-4ffc-a633-dfb45a508206" class="bulleted-list"><li>å°†ä¸€äº›å­—æ®µæ‹†è§£å‡ºæ¥è¿›è¡Œä½¿ç”¨ï¼Œæ¯”å¦‚ï¼šSyjh-sjsy-zygn-3_1å­—æ®µï¼Œæˆ‘ä»¬åªéœ€è¦Syjh-sjsy-zygnä½ç½®çš„æ‰€æœ‰æŒ‰é’®ã€‚</li></ul><pre id="05e00f95-2ddb-4876-a840-fd65b2a8a468" class="code"><code>select 
    substring_index(nbtn_position, &#x27;-&#x27;,3) as position,
    count(distinct user_account) as uv 
from 
    apache_computer_view
where 
    hit_date = &#x27;2020-03-01&#x27;
    and 
    nbtn_position like &#x27;%Syjh%&#x27;
group by 
    substring_index(nbtn_position, &#x27;-&#x27;,3)
</code></pre><hr id="9de0a2e8-2ca1-4749-b649-cf48a13fc5cf"/><ul id="f7ebe2c7-18e3-4861-9ca5-208985b24ece" class="bulleted-list"><li>å·¦å¡«å……ä¸å³å¡«å……</li></ul><p id="c998c7d5-5cd3-4e65-bba5-b0d3699cb68c" class=""><strong>LPAD(str,len,padstr)</strong></p><p id="4a26e98f-6f41-4e98-8f59-c1ca147a0d46" class="">å‚æ•°æ„ä¹‰ï¼šLPAD(è¦æŸ¥è¯¢çš„å­—æ®µï¼Œé•¿åº¦ï¼Œç”¨æ¥å¡«å……çš„å­—æ®µ)ï¼Œ<strong>lpadæ˜¯åœ¨å·¦è¾¹å¡«å……ï¼Œrpadæ˜¯åœ¨å³è¾¹å¡«å……</strong></p><p id="1002c573-479e-4b08-9b84-f38264ad840a" class="">æ¡ˆÂ ä¾‹ï¼šå¦‚ä¸‹å›¾ï¼Œåœ¨æŸ¥è¯¢çš„frnameç»“æœä¸Šç”¨æˆ‘è‡ªå®šä¹‰çš„å­—ç¬¦ä¸²è¡¥å……åˆ°å›ºå®šé•¿åº¦ã€‚</p><pre id="2e3844ad-a8cd-4015-84a4-94f6d35e5e70" class="code"><code>select 
	lpad(nbtn_name, 7, &#x27;xo&#x27;) as &#x27;å·¦å¡«å……&#x27;,
	rpad(nbtn_name, 7, &#x27;xo&#x27;) as &#x27;å³å¡«å……&#x27;,
	nbtn_name as &#x27;ä¸å¡«å……&#x27;
from 
	table1</code></pre><div id="da66b81b-ec7f-4641-b168-4963d33912bd" class="collection-content"><h4 class="collection-title"></h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>å·¦å¡«å……</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>å³å¡«å……</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>ä¸å¡«å……</th></tr></thead><tbody><tr id="69a54543-d2b6-4fc8-a156-4efd8772b545"><td class="cell-title"><a href="https://www.notion.so/xoxo-69a54543d2b64fc8a1564efd8772b545">xoxoå¼ æ™“ä¸œ</a></td><td class="cell-672W">å¼ æ™“ä¸œxoxo</td><td class="cell-%aso">å¼ æ™“ä¸œ</td></tr></tbody></table></div><h2 id="2b39356e-249a-44f4-86b0-b7e1f859a9f9" class="">group by ä¸­rollupã€cubeã€groupingã€grouping setsç”¨æ³•</h2><p id="0a5fa0ed-07cf-4ffb-a31e-4f0322c5d9f1" class="">
</p><ol id="5485b2a1-951a-497e-88f5-af3acc2d2a5c" class="numbered-list" start="1"><li>éœ€æ±‚èƒŒæ™¯ï¼š é€šè¿‡ a1 æ˜ç»†è¡¨ï¼Œè·å¾—æ¯ä¸ªåº—é“ºï¼Œæ¯ä¸ªåŸå¸‚ï¼Œæ¯ä¸ªçœä»½ï¼Œæ¯ä¸ªå¤§åŒºä»¥åŠå…¨å›½5æœˆçš„ä»½çš„æˆäº¤é‡æƒ…å†µã€‚</li></ol><div id="3a902118-b636-4a51-8c00-af03d0876c6f" class="collection-content"><h4 class="collection-title">table1</h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>order_id</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>shop</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>city</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>province</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>area</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesDate"><path d="M10.8889,5.5 L3.11111,5.5 L3.11111,7.05556 L10.8889,7.05556 L10.8889,5.5 Z M12.4444,1.05556 L11.6667,1.05556 L11.6667,0 L10.1111,0 L10.1111,1.05556 L3.88889,1.05556 L3.88889,0 L2.33333,0 L2.33333,1.05556 L1.55556,1.05556 C0.692222,1.05556 0.00777777,1.75556 0.00777777,2.61111 L0,12.5 C0,13.3556 0.692222,14 1.55556,14 L12.4444,14 C13.3,14 14,13.3556 14,12.5 L14,2.61111 C14,1.75556 13.3,1.05556 12.4444,1.05556 Z M12.4444,12.5 L1.55556,12.5 L1.55556,3.94444 L12.4444,3.94444 L12.4444,12.5 Z M8.55556,8.61111 L3.11111,8.61111 L3.11111,10.1667 L8.55556,10.1667 L8.55556,8.61111 Z"></path></svg></span>hit_date</th></tr></thead><tbody><tr id="0deca338-7caf-4a54-98ed-5b801c4ffd1b"><td class="cell-title"><a href="https://www.notion.so/1-0deca3387caf4a5498ed5b801c4ffd1b">1</a></td><td class="cell-1-tj">A</td><td class="cell-zXl.">è¥¿å®‰</td><td class="cell-Ge7q">é™•è¥¿</td><td class="cell-_XO#">è¥¿åŒ—å¤§åŒº</td><td class="cell-?\p`"><time>@May 04, 2019</time></td></tr><tr id="06b6c523-99a1-459e-84e5-4a3a70ba384d"><td class="cell-title"><a href="https://www.notion.so/2-06b6c52399a1459e84e54a3a70ba384d">2</a></td><td class="cell-1-tj">B</td><td class="cell-zXl.">ä¸Šæµ·</td><td class="cell-Ge7q">ä¸Šæµ·</td><td class="cell-_XO#">åä¸œå¤§åŒº</td><td class="cell-?\p`"><time>@May 01, 2019</time></td></tr><tr id="822f5d56-611b-4d7e-aa7e-648af790dfa7"><td class="cell-title"><a href="https://www.notion.so/3-822f5d56611b4d7eaa7e648af790dfa7">3</a></td><td class="cell-1-tj">C</td><td class="cell-zXl.">å®‰åº·</td><td class="cell-Ge7q">é™•è¥¿</td><td class="cell-_XO#">è¥¿åŒ—å¤§åŒº</td><td class="cell-?\p`"><time>@May 02, 2019</time></td></tr><tr id="464c12e6-0791-4168-a411-8041510218d0"><td class="cell-title"><a href="https://www.notion.so/4-464c12e607914168a4118041510218d0">4</a></td><td class="cell-1-tj">D</td><td class="cell-zXl.">åŒ—äº¬</td><td class="cell-Ge7q">åŒ—äº¬</td><td class="cell-_XO#">åä¸­å¤§åŒº</td><td class="cell-?\p`"><time>@May 21, 2019</time></td></tr><tr id="377ed498-9400-405f-8684-ef3a602f10b2"><td class="cell-title"><a href="https://www.notion.so/5-377ed4989400405f8684ef3a602f10b2">5</a></td><td class="cell-1-tj">E</td><td class="cell-zXl.">å»¶å®‰</td><td class="cell-Ge7q">é™•è¥¿</td><td class="cell-_XO#">è¥¿åŒ—å¤§åŒº</td><td class="cell-?\p`"><time>@May 03, 2019</time></td></tr><tr id="2ec5f15a-7d1e-45ae-8f1c-ec469e56c9fb"><td class="cell-title"><a href="https://www.notion.so/6-2ec5f15a7d1e45ae8f1cec469e56c9fb">6</a></td><td class="cell-1-tj">F</td><td class="cell-zXl.">æˆéƒ½</td><td class="cell-Ge7q">å››å·</td><td class="cell-_XO#">è¥¿å—å¤§åŒº</td><td class="cell-?\p`"><time>@May 19, 2019</time></td></tr><tr id="88edae99-4e9e-430a-bde0-303984eeebbf"><td class="cell-title"><a href="https://www.notion.so/7-88edae994e9e430abde0303984eeebbf">7</a></td><td class="cell-1-tj">G</td><td class="cell-zXl.">æ±‰ä¸­</td><td class="cell-Ge7q">é™•è¥¿</td><td class="cell-_XO#">è¥¿åŒ—å¤§åŒº</td><td class="cell-?\p`"><time>@Jun 04, 2019</time></td></tr><tr id="36ec298a-f334-44cd-b93c-9978c74043fc"><td class="cell-title"><a href="https://www.notion.so/36ec298af33444cdb93c9978c74043fc">â€¦</a></td><td class="cell-1-tj">â€¦</td><td class="cell-zXl.">â€¦</td><td class="cell-Ge7q">â€¦</td><td class="cell-_XO#">â€¦</td><td class="cell-?\p`"></td></tr><tr id="545c4ba3-2254-47f2-9d6b-53b6d36dddd6"><td class="cell-title"><a href="https://www.notion.so/10000-545c4ba3225447f29d6b53b6d36dddd6">10000</a></td><td class="cell-1-tj">H</td><td class="cell-zXl.">éƒ‘å·</td><td class="cell-Ge7q">æ²³å—</td><td class="cell-_XO#">è¥¿åŒ—å¤§åŒº</td><td class="cell-?\p`"><time>@May 29, 2019</time></td></tr></tbody></table></div><p id="5f058eef-6e00-44e6-8335-ba9807fe7f54" class="">2. è§£æ³•</p><p id="46071351-675b-4d67-9377-e6d289828001" class="">è§£æ³•1ï¼šåˆ†åˆ«å†™5ä¸ªsqlï¼Œè¿™ç§æ–¹æ³•å¤ªä½æ•ˆäº†ï¼Œ è¿˜éœ€è¦åœ¨excelä¸­è¿›è¡Œåˆå¹¶ã€‚</p><pre id="47a797fd-b77a-44a4-ad5e-802e48f2d9f0" class="code"><code>---å…¨å›½æˆäº¤é‡
select count(order_id)  as sales from table1 
--å¤§åŒºæˆäº¤é‡
select area, count(order_id) as sales from table1 group by area
--çœæˆäº¤é‡
select area, province, count(order_id) as sales from table1 group by area, province
---åŸå¸‚æˆäº¤é‡
select area, province, city, count(order_id) as sales from table1 group by  area, province, city
--åº—é“ºæˆäº¤é‡
select area, province, city, shop, count(order_id) as sales from table1 group by area, province, city, shop 
</code></pre><p id="5c131fd2-bc8a-4ae0-a797-35e88322abb9" class="">
</p><p id="c9c96890-5356-442b-b3bf-a0efc9a77e94" class="">è§£æ³•2ï¼šé€šè¿‡ union å’Œ union all å¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œçºµå‘åˆå¹¶</p><pre id="1da26707-df8d-4cb2-9396-a0c173d2781f" class="code"><code>---å…¨å›½æˆäº¤é‡
select null, null, null, null, null, count(order_id)  as sales from table1 
union all 

--å¤§åŒºæˆäº¤é‡
select null, null, null,null,  area, count(order_id) as sales from table1 group by area
union all 

--çœæˆäº¤é‡
select null, null,null,  area, province, count(order_id) as sales from table1 group by area, province

union all 
---åŸå¸‚æˆäº¤é‡
select null, null, area, province, city, count(order_id) as sales from table1 group by  area, province, city

union all
--åº—é“ºæˆäº¤é‡
select null,  area, province, city, shop, count(order_id) as sales from table1 group by area, province, city, shop 

---ä¸Šè¿°å¼ä¸­æœ‰å¾ˆå¤š null, è¿™æ˜¯å› ä¸º union all æ‹¼æ¥çš„ä¸¤ä¸ªè¡¨çš„åˆ—æ•°éœ€è¦ç›¸ç­‰ã€‚</code></pre><p id="f1b40ea9-f410-4d28-becd-872c767d8380" class="">ç»“æœå¦‚ä¸‹ï¼š</p><figure id="db8d8dae-d6e5-4cb7-97b8-e600c7701d24" class="image"><a href="https://i.loli.net/2019/06/10/5cfe6c219ca3f57084.png"><img src="https://i.loli.net/2019/06/10/5cfe6c219ca3f57084.png"/></a></figure><p id="657fe685-a8ee-4c92-8af5-259d9750df2c" class="">
</p><p id="adb0647a-f941-4f9b-86ae-3330ca4d94e5" class="">è§£æ³•3ï¼šç”¨<code>grouping sets</code>æ¥æ ¹æ®ä¸åŒç»´åº¦ç»„åˆè¿›è¡Œèšåˆ</p><pre id="328f210e-f468-41b2-8ab4-d38de611a167" class="code"><code>select 
	null, area, province, city, shop
from 
	table1
group by 
	null, area, province, city, shop
grouping set
	( null, (null, area), (null, area,province), (null, area, province, city), (null,area, province, city,shop) )</code></pre><p id="dc047411-9dcb-4563-b5c8-8dfc5789dec4" class="">å¾—åˆ°ç»“æœä¸åˆ©ç”¨ <code>union all</code>æ‹¼æ¥ç»“æœç›¸åŒã€‚<code>group by</code>åé¢çš„å­—æ®µè¡¨ç¤ºè¦åˆ†ç»„èšåˆçš„å…¨éƒ¨å­—æ®µï¼Œ <code>grouping sets</code>åé¢ä¸º <code>group by</code> åé¢å„ç§å­—æ®µçš„ç»„åˆã€‚</p><p id="59abf61d-2a56-4793-b234-9d8dc353563f" class="">
</p><p id="fa31503d-4779-4772-893a-dc2b7307f6f9" class="">è§£æ³•4ï¼š<code>cube</code>å‡½æ•°ï¼Œ å¯¹<code>group by</code>çš„ç»´åº¦çš„æ‰€æœ‰ç»„åˆè¿›è¡Œèšåˆã€‚</p><pre id="8410b217-93cf-41fd-b69b-7d544bb9870a" class="code"><code>select 
	 area, province, city, shop
from 
	table1
group by 
	 area, province, city, shop
with cube</code></pre><p id="28c7aa14-7557-4054-ad4b-b43976ec067b" class=""><code>cube</code> ä¼šå…ˆå¯¹å…¨éƒ¨æ•°æ®è¿›è¡Œèšåˆï¼Œå³ <code>null,null,null,null</code> è¿›è¡Œèšåˆï¼Œ(åªæ˜¯ä¸åƒè§£æ³•3ä¸€æ ·ï¼Œæ˜¾ç¤ºnullåˆ—ï¼Œ å¦‚éœ€æ˜¾ç¤ºåªè¦åŠ å…¥nullå³å¯ï¼‰ ç„¶åå¯¹ <code>area, null, null, null</code> è¿›è¡Œèšåˆï¼Œ.......</p><p id="b62ab2d9-3370-4312-9868-ca234a1ab4f8" class="">
</p><p id="99f0f6d5-50f2-4775-84ce-c1e9d8fa1e9a" class="">è§£æ³•5ï¼š<code>rollup</code>å‡½æ•°</p><pre id="3ab6b4fe-2f1a-41ac-98b3-ed26f02ca7ec" class="code"><code>select 
	 area, province, city, shop
from 
	table1
group by 
	 area, province, city, shop
with rollup</code></pre><p id="b0220340-67af-49ba-91ae-ff84e3470146" class=""><code>rollup</code> å‡½æ•°è¾“å‡ºç»“æœï¼Œä¸ä¼šæœ‰ <code>null, null, null, city</code> å€¼ï¼Œ å’Œ <code>cube</code> çš„åŒºåˆ«åœ¨äºï¼š <code>cube</code> æ˜¯ç»´åº¦æ›´ç»†çš„ç»Ÿè®¡ï¼Œå‡è®¾æ•°æ®æœ‰ <code>n</code> ä¸ªç»´åº¦ï¼Œ é‚£ä¹ˆ <code>rollup</code> ä¼šæœ‰ <code>n</code> ä¸ªèšåˆï¼Œ<code>cube</code> ä¼šæœ‰ <code>2n</code> ä¸ªèšåˆã€‚</p><p id="8bdef704-4e2f-4b7f-a1da-b55b489ee566" class="">
</p><p id="9b9e436f-9aa3-423d-a0db-3712c609aaff" class="">
</p><h2 id="553e769d-1dc4-45fa-bc27-ff3523ea45b1" class="">ç©ºå­—æ®µèµ‹å€¼</h2><p id="c62116e6-f24b-4373-a5b3-bfe9ab681d51" class="">NVLï¼šç»™å€¼ä¸ºNULLçš„æ•°æ®èµ‹å€¼ï¼Œæ ¼å¼ä¸ºNVLï¼ˆstring1, replace_with),åŠŸèƒ½ä¸ºï¼šå¦‚æœstring1ä¸ºnullï¼Œåˆ™NVLå‡½æ•°è¿”å›replace_withçš„å€¼ï¼Œå¦åˆ™è¿”å›string1çš„å€¼ï¼Œå¦‚æœä¸¤ä¸ªå‚æ•°éƒ½ä¸ºNULLï¼Œåˆ™è¿”å›NULLã€‚</p><pre id="fbec1d3b-e529-47fb-9106-d2e1a55a3964" class="code"><code>select nvl(comm, -1) from student;</code></pre><h2 id="8e9ed89b-da9e-4e2e-be9d-2b5d699eac1f" class="">æŸ¥çœ‹ç³»ç»Ÿå†…ç½®å‡½æ•°</h2><ol id="949cdf57-e45b-40c7-878a-77fccf393080" class="numbered-list" start="1"><li>æŸ¥çœ‹ç³»ç»Ÿè‡ªå¸¦çš„å‡½æ•°</li></ol><pre id="5ea054fe-5964-431f-8976-158bcc8322b7" class="code"><code>show functions</code></pre><ol id="948420e7-74d1-4dc9-a669-1a5dce00687e" class="numbered-list" start="1"><li>æ˜¾ç¤ºè‡ªå¸¦çš„å‡½æ•°çš„ç”¨æˆ·</li></ol><pre id="1fcbf617-ccf1-479e-a134-b7ac25e9dbd4" class="code"><code>desc function å‡½æ•°å;</code></pre><ol id="cd50a138-674d-4387-b5c6-60ea0e148b92" class="numbered-list" start="1"><li>è¯¦ç»†æ˜¾ç¤ºè‡ªå¸¦çš„å‡½æ•°ç”¨æ³•</li></ol><pre id="7703a36a-0438-46dd-94f4-50545570652c" class="code"><code>desc function extended å‡½æ•°å</code></pre><h1 id="e276543e-1062-41da-8791-4f4bc72086e1" class="">Hiveé¿å…æ•°æ®å€¾æ–œ</h1><ul id="47df4ab5-ef9e-4ec3-9d81-e20ce6e4a786" class="bulleted-list"><li>æ•°æ®å€¾æ–œï¼šå½“æˆ‘ä»¬åœ¨Hiveä¸Šè¿›è¡ŒæŸ¥è¯¢æ—¶ï¼Œå› ä¸ºæ•°æ®çš„åˆ†æ•£åº¦ä¸å¤Ÿï¼Œ å¯¼è‡´å¤§é‡æ•°æ®é›†ä¸­åœ¨ä¸€å°æˆ–è€…å‡ å°æœåŠ¡å™¨ä¸Šï¼Œ å¯¼è‡´æ•°æ®çš„è®¡ç®—é€Ÿåº¦è¿œè¿œä½äºå¹³å‡è®¡ç®—é€Ÿåº¦ï¼Œ è®¡ç®—è¿‡ç¨‹ç‰¹åˆ«è€—æ—¶ã€‚</li></ul><ul id="b45ec6bc-d928-45b3-9481-4a9577e9f2fa" class="bulleted-list"><li>æ•°æ®å€¾æ–œçš„è¡¨ç°ï¼šä»»åŠ¡è¿›åº¦é•¿æ—¶é—´ç»´æŒåœ¨99%ï¼ŒæŸ¥çœ‹ä»»åŠ¡ç›‘æ§é¡µé¢ï¼Œå‘ç°åªæœ‰å°‘é‡å­ä»»åŠ¡æœªå®Œæˆã€‚</li></ul><h2 id="621b9f37-312f-4ac2-b5c6-779278515d32" class="">å°è¡¨Joinå¤§è¡¨</h2><ul id="07fd917b-17f3-437a-a799-fd0373df4c0a" class="bulleted-list"><li>Hive ä¼šå‡å®šæŸ¥è¯¢ä¸­æœ€åä¸€ä¸ªè¡¨æ˜¯æœ€å¤§çš„è¡¨ï¼Œ åœ¨å¯¹æ¯è¡Œè®°å½•è¿›è¡Œè¿ç»­æ“ä½œæ—¶ï¼Œ å®ƒä¼šå°è¯•å°†å…¶ä»–è¡¨ç¼“å­˜èµ·æ¥ï¼Œç„¶åæ‰«ææœ€åé‚£ä¸ªè¡¨è¿›è¡Œè®¡ç®—ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨æŸ¥è¯¢æ—¶ï¼Œè¦ä¿è¯è¿ç»­æŸ¥è¯¢ä¸­çš„è¡¨çš„å¤§å°ä»å·¦åˆ°å³ä¾æ¬¡æ˜¯å¢åŠ çš„ã€‚</li></ul><ul id="ced58d1e-e89f-4a8e-8a82-4fcaadc6cc94" class="bulleted-list"><li>å‡å¦‚ï¼Œåœ¨ a, b ä¸¤ä¸ªè¡¨ä¸­ï¼Œbè¡¨æœ€å°ï¼Œ åˆ™ å†™sqlæ—¶éœ€è®©bè¡¨åœ¨å·¦ï¼Œaè¡¨åœ¨å³ï¼š</li></ul><pre id="bf269dbf-e1c4-48fb-a39a-36064fb36fcb" class="code"><code>SELECT    a.price_close, b.price_closeFROM    b JOIN a ON b.ymd = a.ymd AND b.symbol = a.symbolWHERE    a.symbol = &#x27;APPLE&#x27;---Hiveæ”¯æŒä½¿ç”¨/*+STREAMTALBE*/è¯­æ³•æŒ‡å®šå“ªå¼ è¡¨æ˜¯å¤§è¡¨ï¼Œ ä¸éœ€è¦æ’åºSELECT    /*+3`&#x27;LKLLGFG Streamtable(a)*/ a.price_close, b.price_closeFROM    a JOIN B on a.ymd = b.ymd AND a.symbol = b.symbolWHERE    a.symbol = &#x27;Apple&#x27;</code></pre><h2 id="68a1a493-050e-4f39-bfaf-8d98795cb18c" class="">å¤§è¡¨JOINå¤§è¡¨</h2><ol id="1ed8cca8-182e-45bf-80ea-273b5b505ae8" class="numbered-list" start="1"><li>ç©ºkeyè¿‡æ»¤ æœ‰æ—¶joinè¶…æ—¶æ˜¯å› ä¸ºæŸäº›keyå¯¹åº”çš„æ•°æ®å¤ªå¤šï¼Œè€Œç›¸åŒkeyå¯¹åº”çš„æ•°æ®éƒ½ä¼šå‘é€åˆ°ç›¸åŒçš„reducerä¸Šï¼Œä»è€Œå¯¼è‡´å†…å­˜ä¸å¤Ÿã€‚æ­¤æ—¶æˆ‘ä»¬åº”è¯¥ä»”ç»†åˆ†æè¿™äº›å¼‚å¸¸çš„keyï¼Œå¾ˆå¤šæƒ…å†µä¸‹ï¼Œè¿™äº›keyå¯¹åº”çš„æ•°æ®æ˜¯å¼‚å¸¸æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦åœ¨sqlè¯­å¥ä¸­è¿›è¡Œè¿‡æ»¤ã€‚</li></ol><pre id="dbb4d1ac-9fcf-432f-9ccd-8bc3b46a3bdd" class="code"><code>Select  *From   a Join  bOn   a.user_id is not nullAnd   a.user_id = b.user_idUnion allSelect  * from  awhere  a.user_id is null</code></pre><ol id="9062e348-d056-4c7e-b0af-b36e9b818e6a" class="numbered-list" start="1"><li>ç©ºkeyè½¬æ¢ æœ‰æ—¶è™½ç„¶æŸä¸ªkeyä¸ºç©ºå¯¹åº”çš„æ•°æ®å¾ˆå¤šï¼Œä½†æ˜¯ç›¸åº”çš„æ•°æ®ä¸æ˜¯å¼‚å¸¸æ•°æ®ï¼Œå¿…é¡»è¦åŒ…å«åœ¨joinçš„ç»“æœä¸­ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥è¡¨aä¸­keyä¸ºç©ºçš„å­—æ®µèµ‹ä¸€ä¸ªéšæœºå€¼ï¼Œæ˜¯çš„æ•°æ®éšæœºå‡åŒ€åœ°åˆ†å¸ƒåˆ°ä¸åŒçš„reducerä¸Šã€‚</li></ol><ul id="3d852f6e-a9a7-47fd-a575-700da1959269" class="bulleted-list"><li>æŠŠç©ºå€¼çš„ key å˜æˆä¸€ä¸ªå­—ç¬¦ä¸²åŠ ä¸Šéšæœºæ•°ï¼Œå°±èƒ½æŠŠå€¾æ–œçš„æ•°æ®åˆ†åˆ°ä¸åŒçš„ reduce ä¸Š ,è§£å†³æ•°æ®å€¾æ–œé—®é¢˜ã€‚</li></ul><ul id="dc03b3b2-2386-405f-abc1-f3edde947db1" class="bulleted-list"><li>éœ€è¦ç”¨åˆ°Case When â€¦ Elseâ€¦Endè¯­æ³•</li></ul><pre id="59be914f-a39c-4d97-9b60-db1569909512" class="code"><code>select n.*from  nullidtable n full join bigtable o oncase when n.id is null then concat(&#x27;hive&#x27;, rand()) else n.id end  = o.id;</code></pre><h2 id="f7ae9a9d-27b8-4119-9249-f3cbcf9ea95d" class="">count(distinct) å»é‡ç»Ÿè®¡</h2><ul id="5a74cd88-fb55-40ef-82b7-b7534fb2bbd6" class="bulleted-list"><li>æ•°æ®é‡å¤§æ—¶ï¼Œç”±äºcount distinct æ“ä½œéœ€è¦ç”¨ä¸€ä¸ª reduce task æ¥å®Œæˆï¼Œ è¿™ä¸€ä¸ªreduce éœ€è¦å¤„ç†çš„æ•°æ®é‡å¤ªå¤§ï¼Œä¼šå¯¼è‡´æ•´ä¸ªjobå¾ˆéš¾å®Œæˆï¼Œä¸€èˆ¬ count distinct ä½¿ç”¨å…ˆgroup by å† countçš„æ–¹å¼æ›¿æ¢ã€‚</li></ul><pre id="7cf261a9-93e4-4f52-bb6a-f423a678f647" class="code"><code>select count(distinct id) from bigtableselect count(id) from (select id from bigtable group by id) a</code></pre><h2 id="428d1e0d-0931-4b52-831f-19807a46ce84" class="">é¿å…ç¬›å¡å°”ç§¯</h2><p id="d9cf1032-9c1f-4a17-a7a5-12d160e17a49" class="">å°½é‡é¿å…äº§ç”Ÿç¬›å¡å°”ç§¯ï¼Œå¦‚joinæ—¶ä¸åŠ onæ¡ä»¶ï¼Œæˆ–æ— æ•ˆçš„onæ¡ä»¶ã€‚hiveåªèƒ½ä½¿ç”¨1ä¸ªreduceræ¥å®Œæˆç¬›å¡å°”ç§¯</p><h2 id="c6e0d374-cd18-4028-a565-83011b85cc0f" class="">è¡Œåˆ—è¿‡æ»¤</h2><ol id="2abfd6dc-bf5c-4849-b42e-ef1e9574bc8f" class="numbered-list" start="1"><li>åˆ—å¤„ç†ï¼š åœ¨æŸ¥è¯¢ä¸­ï¼Œ é¿å…ä½¿ç”¨ select *, ä½¿ç”¨æ¡ä»¶é™åˆ¶å–éœ€è¦çš„åˆ—ã€‚</li></ol><ol id="78d093bd-ba51-45f6-87b7-ff3faafb29c9" class="numbered-list" start="2"><li>è¡Œå¤„ç†ï¼š åœ¨åˆ†åŒºå‰ªè£ä¸­ï¼Œå½“ä½¿ç”¨joinå¤–å…³è”æ—¶ï¼Œå¦‚æœå°†å‰¯è¡¨çš„è¿‡æ»¤æ¡ä»¶å†™åœ¨whereåé¢ï¼Œé‚£ä¹ˆå°±ä¼šå…ˆå…¨è¡¨å…³è”ï¼Œä¹‹åå†è¿‡æ»¤, è¿™æ ·ä¼šè€—è´¹èµ„æºã€‚</li></ol><pre id="f81b3286-cc48-4fc5-aad6-56055a631796" class="code"><code>select o.id from bigtable b join ori o on.id = b.id where o.id &lt;=10;select b.id from bigtable bjoin (select id from ori where id &lt;=10) o on b.id = o.id)</code></pre><pre id="5e402d92-c28a-4cbf-a6ca-1871653b997d" class="code"><code>SELECT    a.price_close, b.price_closeFROM    b JOIN a ON b.ymd = a.ymd AND b.symbol = a.symbolWHERE    s.symbol = &#x27;APPLE&#x27;--æ­£ç¡®çš„å†™æ³•æ˜¯å°† where æ¡ä»¶å†™åœ¨ on åé¢SELECT    a.price_close, b.price_closeFROM    b JOIN a ON ( b.ymd = a.ymd AND b.symbol = a.symbol and s.symbol = &#x27;APPLE&#x27;</code></pre><h2 id="8c565b4b-37c1-41a3-af8b-1f09b6aa384a" class="">union all å­æŸ¥è¯¢é¿å…ä¸­ä½¿ç”¨ group byç­‰</h2><ul id="99b894ec-59dd-424a-857f-98b8a2941d3c" class="bulleted-list"><li>union all å­æŸ¥è¯¢é¿å…ä¸­ä½¿ç”¨ group byã€æ›¿æ¢ count(distinct) é™¤å¤–ã€‘ã€count(distinct)ã€maxã€minç­‰ã€‚</li></ul><pre id="1459691c-46b7-4db1-8875-58b25543e22f" class="code"><code>with a1 as (        select            user_account,            hit_date        from            data        where            hit_date between &#x27;2018-12-01&#x27; and &#x27;2018-12-13&#x27;            and            nbtn_name like &quot;%æ”¯ä»˜å®%&quot;        union all         select            user_account,            hit_date        from            data        where            hit_date between &#x27;2018-12-01&#x27; and &#x27;2018-12-13&#x27;        and        nbtn_name like &quot;%æ”¯ä»˜å®%&quot;)select    hit_date,    count(user_account) as pvfrom    a1group by    hit_date</code></pre><h2 id="fb8fc68d-530f-404b-a2d8-7bb477037945" class="">é¿å…ä¸åŒæ•°æ®ç±»å‹è¿›è¡Œå…³è”</h2><ul id="5f24b599-49cf-45eb-9fe8-7cc6b562aff9" class="bulleted-list"><li>ä½¿ç”¨CASTå‡½æ•°å¯¹æ•°æ®ç±»å‹è¿›è¡Œè½¬æ¢ï¼Œè¯­æ³•ä¸ºcast(value AS TYPE)</li></ul><pre id="018df6d6-131e-4b2f-a5a4-72d7076b2d82" class="code"><code>select 
    a.price_close,
    b.price_close
from
    a join b  on a.user_id = cast(b.user_id as string)
where
    hit_date between &#x27;2018-11-01&#x27; and &#x27;2018-11-02&#x27;
    and 
    a.symbol = &#x27;apple&#x27;</code></pre><p id="ef1b5fec-dbb1-48d0-88bc-7b5d423695ec" class="">Hiveçš„æŸ¥è¯¢æ³¨æ„äº‹é¡¹ä»¥åŠä¼˜åŒ–æ€»ç»“ï¼š 1. å°½é‡å°½æ—©è¿‡æ»¤æ•°æ®ï¼Œå‡å°‘æ¯ä¸ªé˜¶æ®µçš„æ•°æ®é‡ã€‚å¯¹äºåˆ†åŒºè¡¨è¦åŠ åˆ†åŒºï¼ŒåŒæ—¶åªé€‰æ‹©éœ€è¦ä½¿ç”¨åˆ°çš„å­—æ®µ</p><ol id="d3a9e3a6-8229-4977-9b37-0de5d1e85542" class="numbered-list" start="1"><li>å¯¹å†å²åº“çš„è®¡ç®—ç»éªŒ</li></ol><ol id="3a7e79a0-93c7-41c6-a31f-7b21b46df4cc" class="numbered-list" start="2"><li>å°½é‡åŸå­åŒ–æ“ä½œï¼Œå°½é‡é¿å…ä¸€ä¸ªSQLåŒ…å«å¤æ‚é€»è¾‘ï¼Œå¯ä»¥ä½¿ç”¨ä¸­é—´è¡¨æ¥å®Œæˆå¤æ‚çš„é€»è¾‘</li></ol><ol id="91aa0ff3-768b-4bcc-8a58-de7c4aebbb8a" class="numbered-list" start="3"><li>joinæ“ä½œ å°è¡¨è¦æ³¨æ„æ”¾åœ¨joinçš„å·¦è¾¹ï¼Œå¦åˆ™ä¼šå¼•èµ·ç£ç›˜å’Œå†…å­˜çš„å¤§é‡æ¶ˆè€—</li></ol><ol id="fcf2d60c-ba37-4701-9749-ca02c8571948" class="numbered-list" start="4"><li>å¦‚æœunion allçš„éƒ¨åˆ†ä¸ªæ•°å¤§äº2ï¼Œæˆ–è€…æ¯ä¸ªunionéƒ¨åˆ†æ•°æ®é‡å¤§ï¼Œåº”è¯¥æ‹†æˆå¤šä¸ªinsert intoè¯­å¥ï¼Œå®é™…æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæ‰§è¡Œæ—¶é—´èƒ½æå‡50%</li></ol><h1 id="c22a35cb-e324-4d9a-92c8-ba249472d666" class="">ç”¨pythonè„šæœ¬è¿æ¥æ•°æ®åº“</h1><p id="e5819a79-22fa-4b25-b903-35781b49d191" class="">ä½œä¸ºä¸€åæ•°æ®åˆ†æå¸ˆï¼Œæ—¥æŠ¥ã€å‘¨æŠ¥ã€æœˆæŠ¥æ•°æ®ä¸€ä¸ªä¹Ÿä¸èƒ½å°‘ã€‚ ç›¸åº”çš„ï¼Œ å°±è¦åœ¨æ•°æ®åº“ä¸­æå–å¤§é‡çš„æ•°æ®ï¼Œ å¹¶å¤„ç†å¤§é‡çš„Excelè¡¨æ ¼ã€‚</p><p id="74bfa0dc-306f-4c5c-a24d-74ce23d60095" class="">åœ¨æå–å’Œå¤„ç†æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œ å¯¹äºä¸€äº›é‡å¤æ€§çš„åŠ³åŠ¨ï¼Œ å†™ä¸ªPythonè„šæœ¬æ¥å®ç°åŠè‡ªåŠ¨åŒ–ï¼Œ èƒ½å¤Ÿå¤§å¹…æé«˜è‡ªå·±çš„å·¥ä½œæ•ˆç‡ã€‚ ä»¥ä¸‹æ˜¯è‡ªå·±å·¥ä½œä¸­çš„ä¸€ç‚¹æ€»ç»“ç»éªŒã€‚</p><ol id="4b066169-e6c8-4bb9-bb74-11d43599c1d6" class="numbered-list" start="1"><li>é¦–å…ˆï¼Œ ç”¨Pythonè¿æ¥æ•°æ®åº“</li></ol><p id="4dda5d14-cba0-4452-b21c-c1bec0de25b1" class="">å¯¹äºæ•°æ®åº“çš„ipåœ°å€ï¼Œç”¨æˆ·åï¼Œå¯†ç ç­‰ï¼Œ å¦‚æœä¸æ¸…æ¥šï¼Œæˆ–æ•°æ®åº“è¿æ¥ä¸ä¸Šï¼Œ éœ€è¦å’Œå¼€å‘äººå‘˜å¯¹æ¥</p><pre id="ae6bc184-e3e9-44fc-9144-8fb7726d7028" class="code"><code>from pyhive import hive import timeconn = hive.Connection(host=&#x27;ipåœ°å€&#x27;, port=10000, username=&#x27;ç”¨æˆ·å&#x27;, database = &#x27;default&#x27;, auth=&#x27;NOSASL&#x27;)cursor = conn.cursor()# è·å¾—è¿æ¥çš„æ¸¸æ ‡</code></pre><ol id="5cd66aa5-c484-4ced-aa27-3e5bbdb28ecf" class="numbered-list" start="1"><li>è®¾ç½®å¼€å§‹å’Œç»“æŸæ—¶é—´ å¯ä»¥ç”¨pythonä¸­çš„timeå‡½æ•°è®¾ç½®æ—¶é—´</li></ol><pre id="f76375d9-9093-4d1c-87ad-2e3bbcff7b80" class="code"><code>startdate = &#x27;2018-09-01&#x27;enddate   = &#x27;2018-09-19&#x27;</code></pre><ol id="3e89a162-ea78-4f00-b6a1-0fc112183012" class="numbered-list" start="1"><li>ç”¨Pythonä¸­çš„formatå‡½æ•°å°†æ—¥æœŸä¼ å…¥{}ä¸­</li></ol><ul id="537fb4c8-63a1-4a46-a397-9c80cd14d4f5" class="bulleted-list"><li>pythonä¸­å†™sqlè„šæœ¬æ—¶ï¼Œ éœ€è¦ç”¨, ã€‚</li></ul><ul id="d68c86ba-6938-4f4c-8edf-098ee82156d5" class="bulleted-list"><li>æ—¥æœŸç”¨ä¸¤ä¸ª{}æ¥ä»£æ›¿ï¼Œ ç”¨formatå‡½æ•°å°†å¼€å§‹æ—¥æœŸä¸ç»“æŸæ—¥æœŸä¼ å…¥</li></ul><pre id="1ca05efb-b9fa-44e0-8f59-cf6e467be583" class="code"><code># æå–ç§¯åˆ†ç±»uv,pvæ•°æ®sql_jifenxinxi_an = &quot;&quot;&quot;select    count(distinct user_account) as uv,    count(1) as pv from    computer_view.data where    hit_date between &quot;{}&quot; and &quot;{}&quot;    and    (btn_position like &quot;æœåŠ¡-æŸ¥è¯¢-ç§¯åˆ†ä¿¡æ¯%&quot;    or    btn_home = &quot;ç§¯åˆ†-æ‰‡å½¢å·¦&quot;    ) limit 1000&quot;&quot;&quot;.format(startdate,enddate)# format æ’å…¥æ—¶é—´cursor.execute(sql_jifenxinxi_an)# è¿è¡Œæ­¤è¯­å¥cursor.fetchall()#fetchall():æ¥æ”¶å…¨éƒ¨çš„è¿”å›ç»“æœè¡Œ.</code></pre><p id="193ffe66-863c-490f-ade3-1eef32b8cda6" class="">æˆ‘ä»¬å¯ä»¥æŒ‰ç…§è¿™ä¸ªæ ¼å¼å†™å·¥ä½œä¸­éœ€è¦è¿è¡Œçš„å¤šä¸ªSQLè¯­å¥ã€‚ è¿™æ ·ï¼Œ å½“è„šæœ¬è¿è¡Œçš„æ—¶å€™ï¼Œ æˆ‘ä»¬å¯ä»¥è…¾å‡ºæ—¶é—´æ¥å»å¹²å…¶ä»–å·¥ä½œï¼Œ ç­‰è¿‡ä¸€æ®µæ—¶é—´ï¼Œæ‰€æœ‰çš„SQLè¯­å¥éƒ½è·‘å®Œäº†ï¼Œ æˆ‘ä»¬å†è¿›è¡Œç»Ÿä¸€çš„æ•´ç†ã€‚</p><hr id="2a0b1ab0-0811-4d47-9e1d-0764fcfa544f"/><p id="9221c766-242f-425d-9240-ef7406fadfd9" class="">
</p><h1 id="0a7454f4-0cec-40fc-bcf1-52b863276095" class="">å‚è€ƒèµ„æ–™ï¼š</h1><p id="2d19fd9d-1b8a-4cf1-bfda-ac6f8bb572f6" class=""><a href="https://mp.weixin.qq.com/s/Xw5DOHHGh838w8YXT9lO5g">è®²è®² group çš„plusç‰ˆ-å¼ ä¿Šçº¢</a></p><hr id="688981c2-c44b-4715-bac4-929d7545d0b6"/><hr id="ea4a60b5-b940-45b1-ae6d-7d1f38329feb"/><figure id="8e899c09-d3a0-4b96-a44b-559a0bd45f62"><div class="source"><a href="https://www.youtube.com/embed/f3uqAVsOxsM">https://www.youtube.com/embed/f3uqAVsOxsM</a></div></figure></div></article></body></html>